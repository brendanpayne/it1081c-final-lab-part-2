(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["polyfills"],{

/***/ 1:
/*!********************************!*\
  !*** multi ./src/polyfills.ts ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /angular-app/src/polyfills.ts */"hN/g");


/***/ }),

/***/ "hN/g":
/*!**************************!*\
  !*** ./src/polyfills.ts ***!
  \**************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var zone_js_dist_zone__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zone.js/dist/zone */ "pDpN");
/* harmony import */ var zone_js_dist_zone__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(zone_js_dist_zone__WEBPACK_IMPORTED_MODULE_0__);
/**
 * This file includes polyfills needed by Angular and is loaded before the app.
 * You can add your own extra polyfills to this file.
 *
 * This file is divided into 2 sections:
 *   1. Browser polyfills. These are applied before loading ZoneJS and are sorted by browsers.
 *   2. Application imports. Files imported after ZoneJS that should be loaded before your main
 *      file.
 *
 * The current setup is for so-called "evergreen" browsers; the last versions of browsers that
 * automatically update themselves. This includes Safari >= 10, Chrome >= 55 (including Opera),
 * Edge >= 13 on the desktop, and iOS 10 and Chrome on mobile.
 *
 * Learn more in https://angular.io/guide/browser-support
 */
/***************************************************************************************************
 * BROWSER POLYFILLS
 */
/** IE11 requires the following for NgClass support on SVG elements */
// import 'classlist.js';  // Run `npm install --save classlist.js`.
/**
 * Web Animations `@angular/platform-browser/animations`
 * Only required if AnimationBuilder is used within the application and using IE/Edge or Safari.
 * Standard animation support in Angular DOES NOT require any polyfills (as of Angular 6.0).
 */
// import 'web-animations-js';  // Run `npm install --save web-animations-js`.
/**
 * By default, zone.js will patch all possible macroTask and DomEvents
 * user can disable parts of macroTask/DomEvents patch by setting following flags
 * because those flags need to be set before `zone.js` being loaded, and webpack
 * will put import in the top of bundle, so user need to create a separate file
 * in this directory (for example: zone-flags.ts), and put the following flags
 * into that file, and then add the following code before importing zone.js.
 * import './zone-flags';
 *
 * The flags allowed in zone-flags.ts are listed here.
 *
 * The following flags will work for all browsers.
 *
 * (window as any).__Zone_disable_requestAnimationFrame = true; // disable patch requestAnimationFrame
 * (window as any).__Zone_disable_on_property = true; // disable patch onProperty such as onclick
 * (window as any).__zone_symbol__UNPATCHED_EVENTS = ['scroll', 'mousemove']; // disable patch specified eventNames
 *
 *  in IE/Edge developer tools, the addEventListener will also be wrapped by zone.js
 *  with the following flag, it will bypass `zone.js` patch for IE/Edge
 *
 *  (window as any).__Zone_enable_cross_context_check = true;
 *
 */
/***************************************************************************************************
 * Zone JS is required by default for Angular itself.
 */
 // Included with Angular CLI.
/***************************************************************************************************
 * APPLICATION IMPORTS
 */


/***/ }),

/***/ "pDpN":
/*!*****************************************************!*\
  !*** ./node_modules/zone.js/dist/zone-evergreen.js ***!
  \*****************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;/**
* @license Angular v9.1.0-next.4+61.sha-e552591.with-local-changes
* (c) 2010-2020 Google LLC. https://angular.io/
* License: MIT
*/
(function (factory) {
     true ? !(__WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module)) :
				__WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) :
    undefined;
}((function () { 'use strict';

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    const Zone$1 = (function (global) {
        const performance = global['performance'];
        function mark(name) { performance && performance['mark'] && performance['mark'](name); }
        function performanceMeasure(name, label) {
            performance && performance['measure'] && performance['measure'](name, label);
        }
        mark('Zone');
        // Initialize before it's accessed below.
        // __Zone_symbol_prefix global can be used to override the default zone
        // symbol prefix with a custom one if needed.
        const symbolPrefix = global['__Zone_symbol_prefix'] || '__zone_symbol__';
        function __symbol__(name) { return symbolPrefix + name; }
        const checkDuplicate = global[__symbol__('forceDuplicateZoneCheck')] === true;
        if (global['Zone']) {
            // if global['Zone'] already exists (maybe zone.js was already loaded or
            // some other lib also registered a global object named Zone), we may need
            // to throw an error, but sometimes user may not want this error.
            // For example,
            // we have two web pages, page1 includes zone.js, page2 doesn't.
            // and the 1st time user load page1 and page2, everything work fine,
            // but when user load page2 again, error occurs because global['Zone'] already exists.
            // so we add a flag to let user choose whether to throw this error or not.
            // By default, if existing Zone is from zone.js, we will not throw the error.
            if (checkDuplicate || typeof global['Zone'].__symbol__ !== 'function') {
                throw new Error('Zone already loaded.');
            }
            else {
                return global['Zone'];
            }
        }
        class Zone {
            constructor(parent, zoneSpec) {
                this._parent = parent;
                this._name = zoneSpec ? zoneSpec.name || 'unnamed' : '<root>';
                this._properties = zoneSpec && zoneSpec.properties || {};
                this._zoneDelegate =
                    new ZoneDelegate(this, this._parent && this._parent._zoneDelegate, zoneSpec);
            }
            static assertZonePatched() {
                if (global['Promise'] !== patches['ZoneAwarePromise']) {
                    throw new Error('Zone.js has detected that ZoneAwarePromise `(window|global).Promise` ' +
                        'has been overwritten.\n' +
                        'Most likely cause is that a Promise polyfill has been loaded ' +
                        'after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. ' +
                        'If you must load one, do so before loading zone.js.)');
                }
            }
            static get root() {
                let zone = Zone.current;
                while (zone.parent) {
                    zone = zone.parent;
                }
                return zone;
            }
            static get current() { return _currentZoneFrame.zone; }
            static get currentTask() { return _currentTask; }
            // tslint:disable-next-line:require-internal-with-underscore
            static __load_patch(name, fn) {
                if (patches.hasOwnProperty(name)) {
                    if (checkDuplicate) {
                        throw Error('Already loaded patch: ' + name);
                    }
                }
                else if (!global['__Zone_disable_' + name]) {
                    const perfName = 'Zone:' + name;
                    mark(perfName);
                    patches[name] = fn(global, Zone, _api);
                    performanceMeasure(perfName, perfName);
                }
            }
            get parent() { return this._parent; }
            get name() { return this._name; }
            get(key) {
                const zone = this.getZoneWith(key);
                if (zone)
                    return zone._properties[key];
            }
            getZoneWith(key) {
                let current = this;
                while (current) {
                    if (current._properties.hasOwnProperty(key)) {
                        return current;
                    }
                    current = current._parent;
                }
                return null;
            }
            fork(zoneSpec) {
                if (!zoneSpec)
                    throw new Error('ZoneSpec required!');
                return this._zoneDelegate.fork(this, zoneSpec);
            }
            wrap(callback, source) {
                if (typeof callback !== 'function') {
                    throw new Error('Expecting function got: ' + callback);
                }
                const _callback = this._zoneDelegate.intercept(this, callback, source);
                const zone = this;
                return function () {
                    return zone.runGuarded(_callback, this, arguments, source);
                };
            }
            run(callback, applyThis, applyArgs, source) {
                _currentZoneFrame = { parent: _currentZoneFrame, zone: this };
                try {
                    return this._zoneDelegate.invoke(this, callback, applyThis, applyArgs, source);
                }
                finally {
                    _currentZoneFrame = _currentZoneFrame.parent;
                }
            }
            runGuarded(callback, applyThis = null, applyArgs, source) {
                _currentZoneFrame = { parent: _currentZoneFrame, zone: this };
                try {
                    try {
                        return this._zoneDelegate.invoke(this, callback, applyThis, applyArgs, source);
                    }
                    catch (error) {
                        if (this._zoneDelegate.handleError(this, error)) {
                            throw error;
                        }
                    }
                }
                finally {
                    _currentZoneFrame = _currentZoneFrame.parent;
                }
            }
            runTask(task, applyThis, applyArgs) {
                if (task.zone != this) {
                    throw new Error('A task can only be run in the zone of creation! (Creation: ' +
                        (task.zone || NO_ZONE).name + '; Execution: ' + this.name + ')');
                }
                // https://github.com/angular/zone.js/issues/778, sometimes eventTask
                // will run in notScheduled(canceled) state, we should not try to
                // run such kind of task but just return
                if (task.state === notScheduled && (task.type === eventTask || task.type === macroTask)) {
                    return;
                }
                const reEntryGuard = task.state != running;
                reEntryGuard && task._transitionTo(running, scheduled);
                task.runCount++;
                const previousTask = _currentTask;
                _currentTask = task;
                _currentZoneFrame = { parent: _currentZoneFrame, zone: this };
                try {
                    if (task.type == macroTask && task.data && !task.data.isPeriodic) {
                        task.cancelFn = undefined;
                    }
                    try {
                        return this._zoneDelegate.invokeTask(this, task, applyThis, applyArgs);
                    }
                    catch (error) {
                        if (this._zoneDelegate.handleError(this, error)) {
                            throw error;
                        }
                    }
                }
                finally {
                    // if the task's state is notScheduled or unknown, then it has already been cancelled
                    // we should not reset the state to scheduled
                    if (task.state !== notScheduled && task.state !== unknown) {
                        if (task.type == eventTask || (task.data && task.data.isPeriodic)) {
                            reEntryGuard && task._transitionTo(scheduled, running);
                        }
                        else {
                            task.runCount = 0;
                            this._updateTaskCount(task, -1);
                            reEntryGuard &&
                                task._transitionTo(notScheduled, running, notScheduled);
                        }
                    }
                    _currentZoneFrame = _currentZoneFrame.parent;
                    _currentTask = previousTask;
                }
            }
            scheduleTask(task) {
                if (task.zone && task.zone !== this) {
                    // check if the task was rescheduled, the newZone
                    // should not be the children of the original zone
                    let newZone = this;
                    while (newZone) {
                        if (newZone === task.zone) {
                            throw Error(`can not reschedule task to ${this.name} which is descendants of the original zone ${task.zone.name}`);
                        }
                        newZone = newZone.parent;
                    }
                }
                task._transitionTo(scheduling, notScheduled);
                const zoneDelegates = [];
                task._zoneDelegates = zoneDelegates;
                task._zone = this;
                try {
                    task = this._zoneDelegate.scheduleTask(this, task);
                }
                catch (err) {
                    // should set task's state to unknown when scheduleTask throw error
                    // because the err may from reschedule, so the fromState maybe notScheduled
                    task._transitionTo(unknown, scheduling, notScheduled);
                    // TODO: @JiaLiPassion, should we check the result from handleError?
                    this._zoneDelegate.handleError(this, err);
                    throw err;
                }
                if (task._zoneDelegates === zoneDelegates) {
                    // we have to check because internally the delegate can reschedule the task.
                    this._updateTaskCount(task, 1);
                }
                if (task.state == scheduling) {
                    task._transitionTo(scheduled, scheduling);
                }
                return task;
            }
            scheduleMicroTask(source, callback, data, customSchedule) {
                return this.scheduleTask(new ZoneTask(microTask, source, callback, data, customSchedule, undefined));
            }
            scheduleMacroTask(source, callback, data, customSchedule, customCancel) {
                return this.scheduleTask(new ZoneTask(macroTask, source, callback, data, customSchedule, customCancel));
            }
            scheduleEventTask(source, callback, data, customSchedule, customCancel) {
                return this.scheduleTask(new ZoneTask(eventTask, source, callback, data, customSchedule, customCancel));
            }
            cancelTask(task) {
                if (task.zone != this)
                    throw new Error('A task can only be cancelled in the zone of creation! (Creation: ' +
                        (task.zone || NO_ZONE).name + '; Execution: ' + this.name + ')');
                task._transitionTo(canceling, scheduled, running);
                try {
                    this._zoneDelegate.cancelTask(this, task);
                }
                catch (err) {
                    // if error occurs when cancelTask, transit the state to unknown
                    task._transitionTo(unknown, canceling);
                    this._zoneDelegate.handleError(this, err);
                    throw err;
                }
                this._updateTaskCount(task, -1);
                task._transitionTo(notScheduled, canceling);
                task.runCount = 0;
                return task;
            }
            _updateTaskCount(task, count) {
                const zoneDelegates = task._zoneDelegates;
                if (count == -1) {
                    task._zoneDelegates = null;
                }
                for (let i = 0; i < zoneDelegates.length; i++) {
                    zoneDelegates[i]._updateTaskCount(task.type, count);
                }
            }
        }
        // tslint:disable-next-line:require-internal-with-underscore
        Zone.__symbol__ = __symbol__;
        const DELEGATE_ZS = {
            name: '',
            onHasTask: (delegate, _, target, hasTaskState) => delegate.hasTask(target, hasTaskState),
            onScheduleTask: (delegate, _, target, task) => delegate.scheduleTask(target, task),
            onInvokeTask: (delegate, _, target, task, applyThis, applyArgs) => delegate.invokeTask(target, task, applyThis, applyArgs),
            onCancelTask: (delegate, _, target, task) => delegate.cancelTask(target, task)
        };
        class ZoneDelegate {
            constructor(zone, parentDelegate, zoneSpec) {
                this._taskCounts = { 'microTask': 0, 'macroTask': 0, 'eventTask': 0 };
                this.zone = zone;
                this._parentDelegate = parentDelegate;
                this._forkZS =
                    zoneSpec && (zoneSpec && zoneSpec.onFork ? zoneSpec : parentDelegate._forkZS);
                this._forkDlgt = zoneSpec && (zoneSpec.onFork ? parentDelegate : parentDelegate._forkDlgt);
                this._forkCurrZone =
                    zoneSpec && (zoneSpec.onFork ? this.zone : parentDelegate._forkCurrZone);
                this._interceptZS =
                    zoneSpec && (zoneSpec.onIntercept ? zoneSpec : parentDelegate._interceptZS);
                this._interceptDlgt =
                    zoneSpec && (zoneSpec.onIntercept ? parentDelegate : parentDelegate._interceptDlgt);
                this._interceptCurrZone =
                    zoneSpec && (zoneSpec.onIntercept ? this.zone : parentDelegate._interceptCurrZone);
                this._invokeZS = zoneSpec && (zoneSpec.onInvoke ? zoneSpec : parentDelegate._invokeZS);
                this._invokeDlgt =
                    zoneSpec && (zoneSpec.onInvoke ? parentDelegate : parentDelegate._invokeDlgt);
                this._invokeCurrZone =
                    zoneSpec && (zoneSpec.onInvoke ? this.zone : parentDelegate._invokeCurrZone);
                this._handleErrorZS =
                    zoneSpec && (zoneSpec.onHandleError ? zoneSpec : parentDelegate._handleErrorZS);
                this._handleErrorDlgt = zoneSpec &&
                    (zoneSpec.onHandleError ? parentDelegate : parentDelegate._handleErrorDlgt);
                this._handleErrorCurrZone =
                    zoneSpec && (zoneSpec.onHandleError ? this.zone : parentDelegate._handleErrorCurrZone);
                this._scheduleTaskZS =
                    zoneSpec && (zoneSpec.onScheduleTask ? zoneSpec : parentDelegate._scheduleTaskZS);
                this._scheduleTaskDlgt = zoneSpec &&
                    (zoneSpec.onScheduleTask ? parentDelegate : parentDelegate._scheduleTaskDlgt);
                this._scheduleTaskCurrZone = zoneSpec &&
                    (zoneSpec.onScheduleTask ? this.zone : parentDelegate._scheduleTaskCurrZone);
                this._invokeTaskZS =
                    zoneSpec && (zoneSpec.onInvokeTask ? zoneSpec : parentDelegate._invokeTaskZS);
                this._invokeTaskDlgt =
                    zoneSpec && (zoneSpec.onInvokeTask ? parentDelegate : parentDelegate._invokeTaskDlgt);
                this._invokeTaskCurrZone =
                    zoneSpec && (zoneSpec.onInvokeTask ? this.zone : parentDelegate._invokeTaskCurrZone);
                this._cancelTaskZS =
                    zoneSpec && (zoneSpec.onCancelTask ? zoneSpec : parentDelegate._cancelTaskZS);
                this._cancelTaskDlgt =
                    zoneSpec && (zoneSpec.onCancelTask ? parentDelegate : parentDelegate._cancelTaskDlgt);
                this._cancelTaskCurrZone =
                    zoneSpec && (zoneSpec.onCancelTask ? this.zone : parentDelegate._cancelTaskCurrZone);
                this._hasTaskZS = null;
                this._hasTaskDlgt = null;
                this._hasTaskDlgtOwner = null;
                this._hasTaskCurrZone = null;
                const zoneSpecHasTask = zoneSpec && zoneSpec.onHasTask;
                const parentHasTask = parentDelegate && parentDelegate._hasTaskZS;
                if (zoneSpecHasTask || parentHasTask) {
                    // If we need to report hasTask, than this ZS needs to do ref counting on tasks. In such
                    // a case all task related interceptors must go through this ZD. We can't short circuit it.
                    this._hasTaskZS = zoneSpecHasTask ? zoneSpec : DELEGATE_ZS;
                    this._hasTaskDlgt = parentDelegate;
                    this._hasTaskDlgtOwner = this;
                    this._hasTaskCurrZone = zone;
                    if (!zoneSpec.onScheduleTask) {
                        this._scheduleTaskZS = DELEGATE_ZS;
                        this._scheduleTaskDlgt = parentDelegate;
                        this._scheduleTaskCurrZone = this.zone;
                    }
                    if (!zoneSpec.onInvokeTask) {
                        this._invokeTaskZS = DELEGATE_ZS;
                        this._invokeTaskDlgt = parentDelegate;
                        this._invokeTaskCurrZone = this.zone;
                    }
                    if (!zoneSpec.onCancelTask) {
                        this._cancelTaskZS = DELEGATE_ZS;
                        this._cancelTaskDlgt = parentDelegate;
                        this._cancelTaskCurrZone = this.zone;
                    }
                }
            }
            fork(targetZone, zoneSpec) {
                return this._forkZS ?
                    this._forkZS.onFork(this._forkDlgt, this.zone, targetZone, zoneSpec) :
                    new Zone(targetZone, zoneSpec);
            }
            intercept(targetZone, callback, source) {
                return this._interceptZS ?
                    this._interceptZS.onIntercept(this._interceptDlgt, this._interceptCurrZone, targetZone, callback, source) :
                    callback;
            }
            invoke(targetZone, callback, applyThis, applyArgs, source) {
                return this._invokeZS ?
                    this._invokeZS.onInvoke(this._invokeDlgt, this._invokeCurrZone, targetZone, callback, applyThis, applyArgs, source) :
                    callback.apply(applyThis, applyArgs);
            }
            handleError(targetZone, error) {
                return this._handleErrorZS ?
                    this._handleErrorZS.onHandleError(this._handleErrorDlgt, this._handleErrorCurrZone, targetZone, error) :
                    true;
            }
            scheduleTask(targetZone, task) {
                let returnTask = task;
                if (this._scheduleTaskZS) {
                    if (this._hasTaskZS) {
                        returnTask._zoneDelegates.push(this._hasTaskDlgtOwner);
                    }
                    // clang-format off
                    returnTask = this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt, this._scheduleTaskCurrZone, targetZone, task);
                    // clang-format on
                    if (!returnTask)
                        returnTask = task;
                }
                else {
                    if (task.scheduleFn) {
                        task.scheduleFn(task);
                    }
                    else if (task.type == microTask) {
                        scheduleMicroTask(task);
                    }
                    else {
                        throw new Error('Task is missing scheduleFn.');
                    }
                }
                return returnTask;
            }
            invokeTask(targetZone, task, applyThis, applyArgs) {
                return this._invokeTaskZS ?
                    this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt, this._invokeTaskCurrZone, targetZone, task, applyThis, applyArgs) :
                    task.callback.apply(applyThis, applyArgs);
            }
            cancelTask(targetZone, task) {
                let value;
                if (this._cancelTaskZS) {
                    value = this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt, this._cancelTaskCurrZone, targetZone, task);
                }
                else {
                    if (!task.cancelFn) {
                        throw Error('Task is not cancelable');
                    }
                    value = task.cancelFn(task);
                }
                return value;
            }
            hasTask(targetZone, isEmpty) {
                // hasTask should not throw error so other ZoneDelegate
                // can still trigger hasTask callback
                try {
                    this._hasTaskZS &&
                        this._hasTaskZS.onHasTask(this._hasTaskDlgt, this._hasTaskCurrZone, targetZone, isEmpty);
                }
                catch (err) {
                    this.handleError(targetZone, err);
                }
            }
            // tslint:disable-next-line:require-internal-with-underscore
            _updateTaskCount(type, count) {
                const counts = this._taskCounts;
                const prev = counts[type];
                const next = counts[type] = prev + count;
                if (next < 0) {
                    throw new Error('More tasks executed then were scheduled.');
                }
                if (prev == 0 || next == 0) {
                    const isEmpty = {
                        microTask: counts['microTask'] > 0,
                        macroTask: counts['macroTask'] > 0,
                        eventTask: counts['eventTask'] > 0,
                        change: type
                    };
                    this.hasTask(this.zone, isEmpty);
                }
            }
        }
        class ZoneTask {
            constructor(type, source, callback, options, scheduleFn, cancelFn) {
                // tslint:disable-next-line:require-internal-with-underscore
                this._zone = null;
                this.runCount = 0;
                // tslint:disable-next-line:require-internal-with-underscore
                this._zoneDelegates = null;
                // tslint:disable-next-line:require-internal-with-underscore
                this._state = 'notScheduled';
                this.type = type;
                this.source = source;
                this.data = options;
                this.scheduleFn = scheduleFn;
                this.cancelFn = cancelFn;
                if (!callback) {
                    throw new Error('callback is not defined');
                }
                this.callback = callback;
                const self = this;
                // TODO: @JiaLiPassion options should have interface
                if (type === eventTask && options && options.useG) {
                    this.invoke = ZoneTask.invokeTask;
                }
                else {
                    this.invoke = function () {
                        return ZoneTask.invokeTask.call(global, self, this, arguments);
                    };
                }
            }
            static invokeTask(task, target, args) {
                if (!task) {
                    task = this;
                }
                _numberOfNestedTaskFrames++;
                try {
                    task.runCount++;
                    return task.zone.runTask(task, target, args);
                }
                finally {
                    if (_numberOfNestedTaskFrames == 1) {
                        drainMicroTaskQueue();
                    }
                    _numberOfNestedTaskFrames--;
                }
            }
            get zone() { return this._zone; }
            get state() { return this._state; }
            cancelScheduleRequest() { this._transitionTo(notScheduled, scheduling); }
            // tslint:disable-next-line:require-internal-with-underscore
            _transitionTo(toState, fromState1, fromState2) {
                if (this._state === fromState1 || this._state === fromState2) {
                    this._state = toState;
                    if (toState == notScheduled) {
                        this._zoneDelegates = null;
                    }
                }
                else {
                    throw new Error(`${this.type} '${this.source}': can not transition to '${toState}', expecting state '${fromState1}'${fromState2 ? ' or \'' + fromState2 + '\'' : ''}, was '${this._state}'.`);
                }
            }
            toString() {
                if (this.data && typeof this.data.handleId !== 'undefined') {
                    return this.data.handleId.toString();
                }
                else {
                    return Object.prototype.toString.call(this);
                }
            }
            // add toJSON method to prevent cyclic error when
            // call JSON.stringify(zoneTask)
            toJSON() {
                return {
                    type: this.type,
                    state: this.state,
                    source: this.source,
                    zone: this.zone.name,
                    runCount: this.runCount
                };
            }
        }
        //////////////////////////////////////////////////////
        //////////////////////////////////////////////////////
        ///  MICROTASK QUEUE
        //////////////////////////////////////////////////////
        //////////////////////////////////////////////////////
        const symbolSetTimeout = __symbol__('setTimeout');
        const symbolPromise = __symbol__('Promise');
        const symbolThen = __symbol__('then');
        let _microTaskQueue = [];
        let _isDrainingMicrotaskQueue = false;
        let nativeMicroTaskQueuePromise;
        function scheduleMicroTask(task) {
            // if we are not running in any task, and there has not been anything scheduled
            // we must bootstrap the initial task creation by manually scheduling the drain
            if (_numberOfNestedTaskFrames === 0 && _microTaskQueue.length === 0) {
                // We are not running in Task, so we need to kickstart the microtask queue.
                if (!nativeMicroTaskQueuePromise) {
                    if (global[symbolPromise]) {
                        nativeMicroTaskQueuePromise = global[symbolPromise].resolve(0);
                    }
                }
                if (nativeMicroTaskQueuePromise) {
                    let nativeThen = nativeMicroTaskQueuePromise[symbolThen];
                    if (!nativeThen) {
                        // native Promise is not patchable, we need to use `then` directly
                        // issue 1078
                        nativeThen = nativeMicroTaskQueuePromise['then'];
                    }
                    nativeThen.call(nativeMicroTaskQueuePromise, drainMicroTaskQueue);
                }
                else {
                    global[symbolSetTimeout](drainMicroTaskQueue, 0);
                }
            }
            task && _microTaskQueue.push(task);
        }
        function drainMicroTaskQueue() {
            if (!_isDrainingMicrotaskQueue) {
                _isDrainingMicrotaskQueue = true;
                while (_microTaskQueue.length) {
                    const queue = _microTaskQueue;
                    _microTaskQueue = [];
                    for (let i = 0; i < queue.length; i++) {
                        const task = queue[i];
                        try {
                            task.zone.runTask(task, null, null);
                        }
                        catch (error) {
                            _api.onUnhandledError(error);
                        }
                    }
                }
                _api.microtaskDrainDone();
                _isDrainingMicrotaskQueue = false;
            }
        }
        //////////////////////////////////////////////////////
        //////////////////////////////////////////////////////
        ///  BOOTSTRAP
        //////////////////////////////////////////////////////
        //////////////////////////////////////////////////////
        const NO_ZONE = { name: 'NO ZONE' };
        const notScheduled = 'notScheduled', scheduling = 'scheduling', scheduled = 'scheduled', running = 'running', canceling = 'canceling', unknown = 'unknown';
        const microTask = 'microTask', macroTask = 'macroTask', eventTask = 'eventTask';
        const patches = {};
        const _api = {
            symbol: __symbol__,
            currentZoneFrame: () => _currentZoneFrame,
            onUnhandledError: noop,
            microtaskDrainDone: noop,
            scheduleMicroTask: scheduleMicroTask,
            showUncaughtError: () => !Zone[__symbol__('ignoreConsoleErrorUncaughtError')],
            patchEventTarget: () => [],
            patchOnProperties: noop,
            patchMethod: () => noop,
            bindArguments: () => [],
            patchThen: () => noop,
            patchMacroTask: () => noop,
            setNativePromise: (NativePromise) => {
                // sometimes NativePromise.resolve static function
                // is not ready yet, (such as core-js/es6.promise)
                // so we need to check here.
                if (NativePromise && typeof NativePromise.resolve === 'function') {
                    nativeMicroTaskQueuePromise = NativePromise.resolve(0);
                }
            },
            patchEventPrototype: () => noop,
            isIEOrEdge: () => false,
            getGlobalObjects: () => undefined,
            ObjectDefineProperty: () => noop,
            ObjectGetOwnPropertyDescriptor: () => undefined,
            ObjectCreate: () => undefined,
            ArraySlice: () => [],
            patchClass: () => noop,
            wrapWithCurrentZone: () => noop,
            filterProperties: () => [],
            attachOriginToPatched: () => noop,
            _redefineProperty: () => noop,
            patchCallbacks: () => noop
        };
        let _currentZoneFrame = { parent: null, zone: new Zone(null, null) };
        let _currentTask = null;
        let _numberOfNestedTaskFrames = 0;
        function noop() { }
        performanceMeasure('Zone', 'Zone');
        return global['Zone'] = Zone;
    })(typeof window !== 'undefined' && window || typeof self !== 'undefined' && self || global);

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    Zone.__load_patch('ZoneAwarePromise', (global, Zone, api) => {
        const ObjectGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;
        const ObjectDefineProperty = Object.defineProperty;
        function readableObjectToString(obj) {
            if (obj && obj.toString === Object.prototype.toString) {
                const className = obj.constructor && obj.constructor.name;
                return (className ? className : '') + ': ' + JSON.stringify(obj);
            }
            return obj ? obj.toString() : Object.prototype.toString.call(obj);
        }
        const __symbol__ = api.symbol;
        const _uncaughtPromiseErrors = [];
        const isDisableWrappingUncaughtPromiseRejection = global[__symbol__('DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION')] === true;
        const symbolPromise = __symbol__('Promise');
        const symbolThen = __symbol__('then');
        const creationTrace = '__creationTrace__';
        api.onUnhandledError = (e) => {
            if (api.showUncaughtError()) {
                const rejection = e && e.rejection;
                if (rejection) {
                    console.error('Unhandled Promise rejection:', rejection instanceof Error ? rejection.message : rejection, '; Zone:', e.zone.name, '; Task:', e.task && e.task.source, '; Value:', rejection, rejection instanceof Error ? rejection.stack : undefined);
                }
                else {
                    console.error(e);
                }
            }
        };
        api.microtaskDrainDone = () => {
            while (_uncaughtPromiseErrors.length) {
                const uncaughtPromiseError = _uncaughtPromiseErrors.shift();
                try {
                    uncaughtPromiseError.zone.runGuarded(() => { throw uncaughtPromiseError; });
                }
                catch (error) {
                    handleUnhandledRejection(error);
                }
            }
        };
        const UNHANDLED_PROMISE_REJECTION_HANDLER_SYMBOL = __symbol__('unhandledPromiseRejectionHandler');
        function handleUnhandledRejection(e) {
            api.onUnhandledError(e);
            try {
                const handler = Zone[UNHANDLED_PROMISE_REJECTION_HANDLER_SYMBOL];
                if (typeof handler === 'function') {
                    handler.call(this, e);
                }
            }
            catch (err) {
            }
        }
        function isThenable(value) { return value && value.then; }
        function forwardResolution(value) { return value; }
        function forwardRejection(rejection) { return ZoneAwarePromise.reject(rejection); }
        const symbolState = __symbol__('state');
        const symbolValue = __symbol__('value');
        const symbolFinally = __symbol__('finally');
        const symbolParentPromiseValue = __symbol__('parentPromiseValue');
        const symbolParentPromiseState = __symbol__('parentPromiseState');
        const source = 'Promise.then';
        const UNRESOLVED = null;
        const RESOLVED = true;
        const REJECTED = false;
        const REJECTED_NO_CATCH = 0;
        function makeResolver(promise, state) {
            return (v) => {
                try {
                    resolvePromise(promise, state, v);
                }
                catch (err) {
                    resolvePromise(promise, false, err);
                }
                // Do not return value or you will break the Promise spec.
            };
        }
        const once = function () {
            let wasCalled = false;
            return function wrapper(wrappedFunction) {
                return function () {
                    if (wasCalled) {
                        return;
                    }
                    wasCalled = true;
                    wrappedFunction.apply(null, arguments);
                };
            };
        };
        const TYPE_ERROR = 'Promise resolved with itself';
        const CURRENT_TASK_TRACE_SYMBOL = __symbol__('currentTaskTrace');
        // Promise Resolution
        function resolvePromise(promise, state, value) {
            const onceWrapper = once();
            if (promise === value) {
                throw new TypeError(TYPE_ERROR);
            }
            if (promise[symbolState] === UNRESOLVED) {
                // should only get value.then once based on promise spec.
                let then = null;
                try {
                    if (typeof value === 'object' || typeof value === 'function') {
                        then = value && value.then;
                    }
                }
                catch (err) {
                    onceWrapper(() => { resolvePromise(promise, false, err); })();
                    return promise;
                }
                // if (value instanceof ZoneAwarePromise) {
                if (state !== REJECTED && value instanceof ZoneAwarePromise &&
                    value.hasOwnProperty(symbolState) && value.hasOwnProperty(symbolValue) &&
                    value[symbolState] !== UNRESOLVED) {
                    clearRejectedNoCatch(value);
                    resolvePromise(promise, value[symbolState], value[symbolValue]);
                }
                else if (state !== REJECTED && typeof then === 'function') {
                    try {
                        then.call(value, onceWrapper(makeResolver(promise, state)), onceWrapper(makeResolver(promise, false)));
                    }
                    catch (err) {
                        onceWrapper(() => { resolvePromise(promise, false, err); })();
                    }
                }
                else {
                    promise[symbolState] = state;
                    const queue = promise[symbolValue];
                    promise[symbolValue] = value;
                    if (promise[symbolFinally] === symbolFinally) {
                        // the promise is generated by Promise.prototype.finally
                        if (state === RESOLVED) {
                            // the state is resolved, should ignore the value
                            // and use parent promise value
                            promise[symbolState] = promise[symbolParentPromiseState];
                            promise[symbolValue] = promise[symbolParentPromiseValue];
                        }
                    }
                    // record task information in value when error occurs, so we can
                    // do some additional work such as render longStackTrace
                    if (state === REJECTED && value instanceof Error) {
                        // check if longStackTraceZone is here
                        const trace = Zone.currentTask && Zone.currentTask.data &&
                            Zone.currentTask.data[creationTrace];
                        if (trace) {
                            // only keep the long stack trace into error when in longStackTraceZone
                            ObjectDefineProperty(value, CURRENT_TASK_TRACE_SYMBOL, { configurable: true, enumerable: false, writable: true, value: trace });
                        }
                    }
                    for (let i = 0; i < queue.length;) {
                        scheduleResolveOrReject(promise, queue[i++], queue[i++], queue[i++], queue[i++]);
                    }
                    if (queue.length == 0 && state == REJECTED) {
                        promise[symbolState] = REJECTED_NO_CATCH;
                        let uncaughtPromiseError = value;
                        if (!isDisableWrappingUncaughtPromiseRejection) {
                            // If disable wrapping uncaught promise reject
                            // and the rejected value is an Error object,
                            // use the value instead of wrapping it.
                            try {
                                // Here we throws a new Error to print more readable error log
                                // and if the value is not an error, zone.js builds an `Error`
                                // Object here to attach the stack information.
                                throw new Error('Uncaught (in promise): ' + readableObjectToString(value) +
                                    (value && value.stack ? '\n' + value.stack : ''));
                            }
                            catch (err) {
                                uncaughtPromiseError = err;
                            }
                        }
                        uncaughtPromiseError.rejection = value;
                        uncaughtPromiseError.promise = promise;
                        uncaughtPromiseError.zone = Zone.current;
                        uncaughtPromiseError.task = Zone.currentTask;
                        _uncaughtPromiseErrors.push(uncaughtPromiseError);
                        api.scheduleMicroTask(); // to make sure that it is running
                    }
                }
            }
            // Resolving an already resolved promise is a noop.
            return promise;
        }
        const REJECTION_HANDLED_HANDLER = __symbol__('rejectionHandledHandler');
        function clearRejectedNoCatch(promise) {
            if (promise[symbolState] === REJECTED_NO_CATCH) {
                // if the promise is rejected no catch status
                // and queue.length > 0, means there is a error handler
                // here to handle the rejected promise, we should trigger
                // windows.rejectionhandled eventHandler or nodejs rejectionHandled
                // eventHandler
                try {
                    const handler = Zone[REJECTION_HANDLED_HANDLER];
                    if (handler && typeof handler === 'function') {
                        handler.call(this, { rejection: promise[symbolValue], promise: promise });
                    }
                }
                catch (err) {
                }
                promise[symbolState] = REJECTED;
                for (let i = 0; i < _uncaughtPromiseErrors.length; i++) {
                    if (promise === _uncaughtPromiseErrors[i].promise) {
                        _uncaughtPromiseErrors.splice(i, 1);
                    }
                }
            }
        }
        function scheduleResolveOrReject(promise, zone, chainPromise, onFulfilled, onRejected) {
            clearRejectedNoCatch(promise);
            const promiseState = promise[symbolState];
            const delegate = promiseState ?
                (typeof onFulfilled === 'function') ? onFulfilled : forwardResolution :
                (typeof onRejected === 'function') ? onRejected : forwardRejection;
            zone.scheduleMicroTask(source, () => {
                try {
                    const parentPromiseValue = promise[symbolValue];
                    const isFinallyPromise = !!chainPromise && symbolFinally === chainPromise[symbolFinally];
                    if (isFinallyPromise) {
                        // if the promise is generated from finally call, keep parent promise's state and value
                        chainPromise[symbolParentPromiseValue] = parentPromiseValue;
                        chainPromise[symbolParentPromiseState] = promiseState;
                    }
                    // should not pass value to finally callback
                    const value = zone.run(delegate, undefined, isFinallyPromise && delegate !== forwardRejection && delegate !== forwardResolution ?
                        [] :
                        [parentPromiseValue]);
                    resolvePromise(chainPromise, true, value);
                }
                catch (error) {
                    // if error occurs, should always return this error
                    resolvePromise(chainPromise, false, error);
                }
            }, chainPromise);
        }
        const ZONE_AWARE_PROMISE_TO_STRING = 'function ZoneAwarePromise() { [native code] }';
        const noop = function () { };
        class ZoneAwarePromise {
            static toString() { return ZONE_AWARE_PROMISE_TO_STRING; }
            static resolve(value) {
                return resolvePromise(new this(null), RESOLVED, value);
            }
            static reject(error) {
                return resolvePromise(new this(null), REJECTED, error);
            }
            static race(values) {
                let resolve;
                let reject;
                let promise = new this((res, rej) => {
                    resolve = res;
                    reject = rej;
                });
                function onResolve(value) { resolve(value); }
                function onReject(error) { reject(error); }
                for (let value of values) {
                    if (!isThenable(value)) {
                        value = this.resolve(value);
                    }
                    value.then(onResolve, onReject);
                }
                return promise;
            }
            static all(values) { return ZoneAwarePromise.allWithCallback(values); }
            static allSettled(values) {
                const P = this && this.prototype instanceof ZoneAwarePromise ? this : ZoneAwarePromise;
                return P.allWithCallback(values, {
                    thenCallback: (value) => ({ status: 'fulfilled', value }),
                    errorCallback: (err) => ({ status: 'rejected', reason: err })
                });
            }
            static allWithCallback(values, callback) {
                let resolve;
                let reject;
                let promise = new this((res, rej) => {
                    resolve = res;
                    reject = rej;
                });
                // Start at 2 to prevent prematurely resolving if .then is called immediately.
                let unresolvedCount = 2;
                let valueIndex = 0;
                const resolvedValues = [];
                for (let value of values) {
                    if (!isThenable(value)) {
                        value = this.resolve(value);
                    }
                    const curValueIndex = valueIndex;
                    try {
                        value.then((value) => {
                            resolvedValues[curValueIndex] = callback ? callback.thenCallback(value) : value;
                            unresolvedCount--;
                            if (unresolvedCount === 0) {
                                resolve(resolvedValues);
                            }
                        }, (err) => {
                            if (!callback) {
                                reject(err);
                            }
                            else {
                                resolvedValues[curValueIndex] = callback.errorCallback(err);
                                unresolvedCount--;
                                if (unresolvedCount === 0) {
                                    resolve(resolvedValues);
                                }
                            }
                        });
                    }
                    catch (thenErr) {
                        reject(thenErr);
                    }
                    unresolvedCount++;
                    valueIndex++;
                }
                // Make the unresolvedCount zero-based again.
                unresolvedCount -= 2;
                if (unresolvedCount === 0) {
                    resolve(resolvedValues);
                }
                return promise;
            }
            constructor(executor) {
                const promise = this;
                if (!(promise instanceof ZoneAwarePromise)) {
                    throw new Error('Must be an instanceof Promise.');
                }
                promise[symbolState] = UNRESOLVED;
                promise[symbolValue] = []; // queue;
                try {
                    executor && executor(makeResolver(promise, RESOLVED), makeResolver(promise, REJECTED));
                }
                catch (error) {
                    resolvePromise(promise, false, error);
                }
            }
            get [Symbol.toStringTag]() { return 'Promise'; }
            get [Symbol.species]() { return ZoneAwarePromise; }
            then(onFulfilled, onRejected) {
                let C = this.constructor[Symbol.species];
                if (!C || typeof C !== 'function') {
                    C = this.constructor || ZoneAwarePromise;
                }
                const chainPromise = new C(noop);
                const zone = Zone.current;
                if (this[symbolState] == UNRESOLVED) {
                    this[symbolValue].push(zone, chainPromise, onFulfilled, onRejected);
                }
                else {
                    scheduleResolveOrReject(this, zone, chainPromise, onFulfilled, onRejected);
                }
                return chainPromise;
            }
            catch(onRejected) {
                return this.then(null, onRejected);
            }
            finally(onFinally) {
                let C = this.constructor[Symbol.species];
                if (!C || typeof C !== 'function') {
                    C = ZoneAwarePromise;
                }
                const chainPromise = new C(noop);
                chainPromise[symbolFinally] = symbolFinally;
                const zone = Zone.current;
                if (this[symbolState] == UNRESOLVED) {
                    this[symbolValue].push(zone, chainPromise, onFinally, onFinally);
                }
                else {
                    scheduleResolveOrReject(this, zone, chainPromise, onFinally, onFinally);
                }
                return chainPromise;
            }
        }
        // Protect against aggressive optimizers dropping seemingly unused properties.
        // E.g. Closure Compiler in advanced mode.
        ZoneAwarePromise['resolve'] = ZoneAwarePromise.resolve;
        ZoneAwarePromise['reject'] = ZoneAwarePromise.reject;
        ZoneAwarePromise['race'] = ZoneAwarePromise.race;
        ZoneAwarePromise['all'] = ZoneAwarePromise.all;
        const NativePromise = global[symbolPromise] = global['Promise'];
        const ZONE_AWARE_PROMISE = Zone.__symbol__('ZoneAwarePromise');
        let desc = ObjectGetOwnPropertyDescriptor(global, 'Promise');
        if (!desc || desc.configurable) {
            desc && delete desc.writable;
            desc && delete desc.value;
            if (!desc) {
                desc = { configurable: true, enumerable: true };
            }
            desc.get = function () {
                // if we already set ZoneAwarePromise, use patched one
                // otherwise return native one.
                return global[ZONE_AWARE_PROMISE] ? global[ZONE_AWARE_PROMISE] : global[symbolPromise];
            };
            desc.set = function (NewNativePromise) {
                if (NewNativePromise === ZoneAwarePromise) {
                    // if the NewNativePromise is ZoneAwarePromise
                    // save to global
                    global[ZONE_AWARE_PROMISE] = NewNativePromise;
                }
                else {
                    // if the NewNativePromise is not ZoneAwarePromise
                    // for example: after load zone.js, some library just
                    // set es6-promise to global, if we set it to global
                    // directly, assertZonePatched will fail and angular
                    // will not loaded, so we just set the NewNativePromise
                    // to global[symbolPromise], so the result is just like
                    // we load ES6 Promise before zone.js
                    global[symbolPromise] = NewNativePromise;
                    if (!NewNativePromise.prototype[symbolThen]) {
                        patchThen(NewNativePromise);
                    }
                    api.setNativePromise(NewNativePromise);
                }
            };
            ObjectDefineProperty(global, 'Promise', desc);
        }
        global['Promise'] = ZoneAwarePromise;
        const symbolThenPatched = __symbol__('thenPatched');
        function patchThen(Ctor) {
            const proto = Ctor.prototype;
            const prop = ObjectGetOwnPropertyDescriptor(proto, 'then');
            if (prop && (prop.writable === false || !prop.configurable)) {
                // check Ctor.prototype.then propertyDescriptor is writable or not
                // in meteor env, writable is false, we should ignore such case
                return;
            }
            const originalThen = proto.then;
            // Keep a reference to the original method.
            proto[symbolThen] = originalThen;
            Ctor.prototype.then = function (onResolve, onReject) {
                const wrapped = new ZoneAwarePromise((resolve, reject) => { originalThen.call(this, resolve, reject); });
                return wrapped.then(onResolve, onReject);
            };
            Ctor[symbolThenPatched] = true;
        }
        api.patchThen = patchThen;
        function zoneify(fn) {
            return function () {
                let resultPromise = fn.apply(this, arguments);
                if (resultPromise instanceof ZoneAwarePromise) {
                    return resultPromise;
                }
                let ctor = resultPromise.constructor;
                if (!ctor[symbolThenPatched]) {
                    patchThen(ctor);
                }
                return resultPromise;
            };
        }
        if (NativePromise) {
            patchThen(NativePromise);
            const fetch = global['fetch'];
            if (typeof fetch == 'function') {
                global[api.symbol('fetch')] = fetch;
                global['fetch'] = zoneify(fetch);
            }
        }
        // This is not part of public API, but it is useful for tests, so we expose it.
        Promise[Zone.__symbol__('uncaughtPromiseErrors')] = _uncaughtPromiseErrors;
        return ZoneAwarePromise;
    });

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    /**
     * Suppress closure compiler errors about unknown 'Zone' variable
     * @fileoverview
     * @suppress {undefinedVars,globalThis,missingRequire}
     */
    /// <reference types="node"/>
    // issue #989, to reduce bundle size, use short name
    /** Object.getOwnPropertyDescriptor */
    const ObjectGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;
    /** Object.defineProperty */
    const ObjectDefineProperty = Object.defineProperty;
    /** Object.getPrototypeOf */
    const ObjectGetPrototypeOf = Object.getPrototypeOf;
    /** Object.create */
    const ObjectCreate = Object.create;
    /** Array.prototype.slice */
    const ArraySlice = Array.prototype.slice;
    /** addEventListener string const */
    const ADD_EVENT_LISTENER_STR = 'addEventListener';
    /** removeEventListener string const */
    const REMOVE_EVENT_LISTENER_STR = 'removeEventListener';
    /** zoneSymbol addEventListener */
    const ZONE_SYMBOL_ADD_EVENT_LISTENER = Zone.__symbol__(ADD_EVENT_LISTENER_STR);
    /** zoneSymbol removeEventListener */
    const ZONE_SYMBOL_REMOVE_EVENT_LISTENER = Zone.__symbol__(REMOVE_EVENT_LISTENER_STR);
    /** true string const */
    const TRUE_STR = 'true';
    /** false string const */
    const FALSE_STR = 'false';
    /** Zone symbol prefix string const. */
    const ZONE_SYMBOL_PREFIX = Zone.__symbol__('');
    function wrapWithCurrentZone(callback, source) {
        return Zone.current.wrap(callback, source);
    }
    function scheduleMacroTaskWithCurrentZone(source, callback, data, customSchedule, customCancel) {
        return Zone.current.scheduleMacroTask(source, callback, data, customSchedule, customCancel);
    }
    const zoneSymbol = Zone.__symbol__;
    const isWindowExists = typeof window !== 'undefined';
    const internalWindow = isWindowExists ? window : undefined;
    const _global = isWindowExists && internalWindow || typeof self === 'object' && self || global;
    const REMOVE_ATTRIBUTE = 'removeAttribute';
    const NULL_ON_PROP_VALUE = [null];
    function bindArguments(args, source) {
        for (let i = args.length - 1; i >= 0; i--) {
            if (typeof args[i] === 'function') {
                args[i] = wrapWithCurrentZone(args[i], source + '_' + i);
            }
        }
        return args;
    }
    function patchPrototype(prototype, fnNames) {
        const source = prototype.constructor['name'];
        for (let i = 0; i < fnNames.length; i++) {
            const name = fnNames[i];
            const delegate = prototype[name];
            if (delegate) {
                const prototypeDesc = ObjectGetOwnPropertyDescriptor(prototype, name);
                if (!isPropertyWritable(prototypeDesc)) {
                    continue;
                }
                prototype[name] = ((delegate) => {
                    const patched = function () {
                        return delegate.apply(this, bindArguments(arguments, source + '.' + name));
                    };
                    attachOriginToPatched(patched, delegate);
                    return patched;
                })(delegate);
            }
        }
    }
    function isPropertyWritable(propertyDesc) {
        if (!propertyDesc) {
            return true;
        }
        if (propertyDesc.writable === false) {
            return false;
        }
        return !(typeof propertyDesc.get === 'function' && typeof propertyDesc.set === 'undefined');
    }
    const isWebWorker = (typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope);
    // Make sure to access `process` through `_global` so that WebPack does not accidentally browserify
    // this code.
    const isNode = (!('nw' in _global) && typeof _global.process !== 'undefined' &&
        {}.toString.call(_global.process) === '[object process]');
    const isBrowser = !isNode && !isWebWorker && !!(isWindowExists && internalWindow['HTMLElement']);
    // we are in electron of nw, so we are both browser and nodejs
    // Make sure to access `process` through `_global` so that WebPack does not accidentally browserify
    // this code.
    const isMix = typeof _global.process !== 'undefined' &&
        {}.toString.call(_global.process) === '[object process]' && !isWebWorker &&
        !!(isWindowExists && internalWindow['HTMLElement']);
    const zoneSymbolEventNames = {};
    const wrapFn = function (event) {
        // https://github.com/angular/zone.js/issues/911, in IE, sometimes
        // event will be undefined, so we need to use window.event
        event = event || _global.event;
        if (!event) {
            return;
        }
        let eventNameSymbol = zoneSymbolEventNames[event.type];
        if (!eventNameSymbol) {
            eventNameSymbol = zoneSymbolEventNames[event.type] = zoneSymbol('ON_PROPERTY' + event.type);
        }
        const target = this || event.target || _global;
        const listener = target[eventNameSymbol];
        let result;
        if (isBrowser && target === internalWindow && event.type === 'error') {
            // window.onerror have different signiture
            // https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onerror#window.onerror
            // and onerror callback will prevent default when callback return true
            const errorEvent = event;
            result = listener &&
                listener.call(this, errorEvent.message, errorEvent.filename, errorEvent.lineno, errorEvent.colno, errorEvent.error);
            if (result === true) {
                event.preventDefault();
            }
        }
        else {
            result = listener && listener.apply(this, arguments);
            if (result != undefined && !result) {
                event.preventDefault();
            }
        }
        return result;
    };
    function patchProperty(obj, prop, prototype) {
        let desc = ObjectGetOwnPropertyDescriptor(obj, prop);
        if (!desc && prototype) {
            // when patch window object, use prototype to check prop exist or not
            const prototypeDesc = ObjectGetOwnPropertyDescriptor(prototype, prop);
            if (prototypeDesc) {
                desc = { enumerable: true, configurable: true };
            }
        }
        // if the descriptor not exists or is not configurable
        // just return
        if (!desc || !desc.configurable) {
            return;
        }
        const onPropPatchedSymbol = zoneSymbol('on' + prop + 'patched');
        if (obj.hasOwnProperty(onPropPatchedSymbol) && obj[onPropPatchedSymbol]) {
            return;
        }
        // A property descriptor cannot have getter/setter and be writable
        // deleting the writable and value properties avoids this error:
        //
        // TypeError: property descriptors must not specify a value or be writable when a
        // getter or setter has been specified
        delete desc.writable;
        delete desc.value;
        const originalDescGet = desc.get;
        const originalDescSet = desc.set;
        // substr(2) cuz 'onclick' -> 'click', etc
        const eventName = prop.substr(2);
        let eventNameSymbol = zoneSymbolEventNames[eventName];
        if (!eventNameSymbol) {
            eventNameSymbol = zoneSymbolEventNames[eventName] = zoneSymbol('ON_PROPERTY' + eventName);
        }
        desc.set = function (newValue) {
            // in some of windows's onproperty callback, this is undefined
            // so we need to check it
            let target = this;
            if (!target && obj === _global) {
                target = _global;
            }
            if (!target) {
                return;
            }
            let previousValue = target[eventNameSymbol];
            if (previousValue) {
                target.removeEventListener(eventName, wrapFn);
            }
            // issue #978, when onload handler was added before loading zone.js
            // we should remove it with originalDescSet
            if (originalDescSet) {
                originalDescSet.apply(target, NULL_ON_PROP_VALUE);
            }
            if (typeof newValue === 'function') {
                target[eventNameSymbol] = newValue;
                target.addEventListener(eventName, wrapFn, false);
            }
            else {
                target[eventNameSymbol] = null;
            }
        };
        // The getter would return undefined for unassigned properties but the default value of an
        // unassigned property is null
        desc.get = function () {
            // in some of windows's onproperty callback, this is undefined
            // so we need to check it
            let target = this;
            if (!target && obj === _global) {
                target = _global;
            }
            if (!target) {
                return null;
            }
            const listener = target[eventNameSymbol];
            if (listener) {
                return listener;
            }
            else if (originalDescGet) {
                // result will be null when use inline event attribute,
                // such as <button onclick="func();">OK</button>
                // because the onclick function is internal raw uncompiled handler
                // the onclick will be evaluated when first time event was triggered or
                // the property is accessed, https://github.com/angular/zone.js/issues/525
                // so we should use original native get to retrieve the handler
                let value = originalDescGet && originalDescGet.call(this);
                if (value) {
                    desc.set.call(this, value);
                    if (typeof target[REMOVE_ATTRIBUTE] === 'function') {
                        target.removeAttribute(prop);
                    }
                    return value;
                }
            }
            return null;
        };
        ObjectDefineProperty(obj, prop, desc);
        obj[onPropPatchedSymbol] = true;
    }
    function patchOnProperties(obj, properties, prototype) {
        if (properties) {
            for (let i = 0; i < properties.length; i++) {
                patchProperty(obj, 'on' + properties[i], prototype);
            }
        }
        else {
            const onProperties = [];
            for (const prop in obj) {
                if (prop.substr(0, 2) == 'on') {
                    onProperties.push(prop);
                }
            }
            for (let j = 0; j < onProperties.length; j++) {
                patchProperty(obj, onProperties[j], prototype);
            }
        }
    }
    const originalInstanceKey = zoneSymbol('originalInstance');
    // wrap some native API on `window`
    function patchClass(className) {
        const OriginalClass = _global[className];
        if (!OriginalClass)
            return;
        // keep original class in global
        _global[zoneSymbol(className)] = OriginalClass;
        _global[className] = function () {
            const a = bindArguments(arguments, className);
            switch (a.length) {
                case 0:
                    this[originalInstanceKey] = new OriginalClass();
                    break;
                case 1:
                    this[originalInstanceKey] = new OriginalClass(a[0]);
                    break;
                case 2:
                    this[originalInstanceKey] = new OriginalClass(a[0], a[1]);
                    break;
                case 3:
                    this[originalInstanceKey] = new OriginalClass(a[0], a[1], a[2]);
                    break;
                case 4:
                    this[originalInstanceKey] = new OriginalClass(a[0], a[1], a[2], a[3]);
                    break;
                default:
                    throw new Error('Arg list too long.');
            }
        };
        // attach original delegate to patched function
        attachOriginToPatched(_global[className], OriginalClass);
        const instance = new OriginalClass(function () { });
        let prop;
        for (prop in instance) {
            // https://bugs.webkit.org/show_bug.cgi?id=44721
            if (className === 'XMLHttpRequest' && prop === 'responseBlob')
                continue;
            (function (prop) {
                if (typeof instance[prop] === 'function') {
                    _global[className].prototype[prop] = function () {
                        return this[originalInstanceKey][prop].apply(this[originalInstanceKey], arguments);
                    };
                }
                else {
                    ObjectDefineProperty(_global[className].prototype, prop, {
                        set: function (fn) {
                            if (typeof fn === 'function') {
                                this[originalInstanceKey][prop] = wrapWithCurrentZone(fn, className + '.' + prop);
                                // keep callback in wrapped function so we can
                                // use it in Function.prototype.toString to return
                                // the native one.
                                attachOriginToPatched(this[originalInstanceKey][prop], fn);
                            }
                            else {
                                this[originalInstanceKey][prop] = fn;
                            }
                        },
                        get: function () { return this[originalInstanceKey][prop]; }
                    });
                }
            }(prop));
        }
        for (prop in OriginalClass) {
            if (prop !== 'prototype' && OriginalClass.hasOwnProperty(prop)) {
                _global[className][prop] = OriginalClass[prop];
            }
        }
    }
    function copySymbolProperties(src, dest) {
        if (typeof Object.getOwnPropertySymbols !== 'function') {
            return;
        }
        const symbols = Object.getOwnPropertySymbols(src);
        symbols.forEach((symbol) => {
            const desc = Object.getOwnPropertyDescriptor(src, symbol);
            Object.defineProperty(dest, symbol, {
                get: function () { return src[symbol]; },
                set: function (value) {
                    if (desc && (!desc.writable || typeof desc.set !== 'function')) {
                        // if src[symbol] is not writable or not have a setter, just return
                        return;
                    }
                    src[symbol] = value;
                },
                enumerable: desc ? desc.enumerable : true,
                configurable: desc ? desc.configurable : true
            });
        });
    }
    let shouldCopySymbolProperties = false;
    function patchMethod(target, name, patchFn) {
        let proto = target;
        while (proto && !proto.hasOwnProperty(name)) {
            proto = ObjectGetPrototypeOf(proto);
        }
        if (!proto && target[name]) {
            // somehow we did not find it, but we can see it. This happens on IE for Window properties.
            proto = target;
        }
        const delegateName = zoneSymbol(name);
        let delegate = null;
        if (proto && !(delegate = proto[delegateName])) {
            delegate = proto[delegateName] = proto[name];
            // check whether proto[name] is writable
            // some property is readonly in safari, such as HtmlCanvasElement.prototype.toBlob
            const desc = proto && ObjectGetOwnPropertyDescriptor(proto, name);
            if (isPropertyWritable(desc)) {
                const patchDelegate = patchFn(delegate, delegateName, name);
                proto[name] = function () { return patchDelegate(this, arguments); };
                attachOriginToPatched(proto[name], delegate);
                if (shouldCopySymbolProperties) {
                    copySymbolProperties(delegate, proto[name]);
                }
            }
        }
        return delegate;
    }
    // TODO: @JiaLiPassion, support cancel task later if necessary
    function patchMacroTask(obj, funcName, metaCreator) {
        let setNative = null;
        function scheduleTask(task) {
            const data = task.data;
            data.args[data.cbIdx] = function () { task.invoke.apply(this, arguments); };
            setNative.apply(data.target, data.args);
            return task;
        }
        setNative = patchMethod(obj, funcName, (delegate) => function (self, args) {
            const meta = metaCreator(self, args);
            if (meta.cbIdx >= 0 && typeof args[meta.cbIdx] === 'function') {
                return scheduleMacroTaskWithCurrentZone(meta.name, args[meta.cbIdx], meta, scheduleTask);
            }
            else {
                // cause an error by calling it directly.
                return delegate.apply(self, args);
            }
        });
    }
    function attachOriginToPatched(patched, original) {
        patched[zoneSymbol('OriginalDelegate')] = original;
    }
    let isDetectedIEOrEdge = false;
    let ieOrEdge = false;
    function isIE() {
        try {
            const ua = internalWindow.navigator.userAgent;
            if (ua.indexOf('MSIE ') !== -1 || ua.indexOf('Trident/') !== -1) {
                return true;
            }
        }
        catch (error) {
        }
        return false;
    }
    function isIEOrEdge() {
        if (isDetectedIEOrEdge) {
            return ieOrEdge;
        }
        isDetectedIEOrEdge = true;
        try {
            const ua = internalWindow.navigator.userAgent;
            if (ua.indexOf('MSIE ') !== -1 || ua.indexOf('Trident/') !== -1 || ua.indexOf('Edge/') !== -1) {
                ieOrEdge = true;
            }
        }
        catch (error) {
        }
        return ieOrEdge;
    }

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    // override Function.prototype.toString to make zone.js patched function
    // look like native function
    Zone.__load_patch('toString', (global) => {
        // patch Func.prototype.toString to let them look like native
        const originalFunctionToString = Function.prototype.toString;
        const ORIGINAL_DELEGATE_SYMBOL = zoneSymbol('OriginalDelegate');
        const PROMISE_SYMBOL = zoneSymbol('Promise');
        const ERROR_SYMBOL = zoneSymbol('Error');
        const newFunctionToString = function toString() {
            if (typeof this === 'function') {
                const originalDelegate = this[ORIGINAL_DELEGATE_SYMBOL];
                if (originalDelegate) {
                    if (typeof originalDelegate === 'function') {
                        return originalFunctionToString.call(originalDelegate);
                    }
                    else {
                        return Object.prototype.toString.call(originalDelegate);
                    }
                }
                if (this === Promise) {
                    const nativePromise = global[PROMISE_SYMBOL];
                    if (nativePromise) {
                        return originalFunctionToString.call(nativePromise);
                    }
                }
                if (this === Error) {
                    const nativeError = global[ERROR_SYMBOL];
                    if (nativeError) {
                        return originalFunctionToString.call(nativeError);
                    }
                }
            }
            return originalFunctionToString.call(this);
        };
        newFunctionToString[ORIGINAL_DELEGATE_SYMBOL] = originalFunctionToString;
        Function.prototype.toString = newFunctionToString;
        // patch Object.prototype.toString to let them look like native
        const originalObjectToString = Object.prototype.toString;
        const PROMISE_OBJECT_TO_STRING = '[object Promise]';
        Object.prototype.toString = function () {
            if (this instanceof Promise) {
                return PROMISE_OBJECT_TO_STRING;
            }
            return originalObjectToString.call(this);
        };
    });

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    let passiveSupported = false;
    if (typeof window !== 'undefined') {
        try {
            const options = Object.defineProperty({}, 'passive', { get: function () { passiveSupported = true; } });
            window.addEventListener('test', options, options);
            window.removeEventListener('test', options, options);
        }
        catch (err) {
            passiveSupported = false;
        }
    }
    // an identifier to tell ZoneTask do not create a new invoke closure
    const OPTIMIZED_ZONE_EVENT_TASK_DATA = {
        useG: true
    };
    const zoneSymbolEventNames$1 = {};
    const globalSources = {};
    const EVENT_NAME_SYMBOL_REGX = new RegExp('^' + ZONE_SYMBOL_PREFIX + '(\\w+)(true|false)$');
    const IMMEDIATE_PROPAGATION_SYMBOL = zoneSymbol('propagationStopped');
    function prepareEventNames(eventName, eventNameToString) {
        const falseEventName = (eventNameToString ? eventNameToString(eventName) : eventName) + FALSE_STR;
        const trueEventName = (eventNameToString ? eventNameToString(eventName) : eventName) + TRUE_STR;
        const symbol = ZONE_SYMBOL_PREFIX + falseEventName;
        const symbolCapture = ZONE_SYMBOL_PREFIX + trueEventName;
        zoneSymbolEventNames$1[eventName] = {};
        zoneSymbolEventNames$1[eventName][FALSE_STR] = symbol;
        zoneSymbolEventNames$1[eventName][TRUE_STR] = symbolCapture;
    }
    function patchEventTarget(_global, apis, patchOptions) {
        const ADD_EVENT_LISTENER = (patchOptions && patchOptions.add) || ADD_EVENT_LISTENER_STR;
        const REMOVE_EVENT_LISTENER = (patchOptions && patchOptions.rm) || REMOVE_EVENT_LISTENER_STR;
        const LISTENERS_EVENT_LISTENER = (patchOptions && patchOptions.listeners) || 'eventListeners';
        const REMOVE_ALL_LISTENERS_EVENT_LISTENER = (patchOptions && patchOptions.rmAll) || 'removeAllListeners';
        const zoneSymbolAddEventListener = zoneSymbol(ADD_EVENT_LISTENER);
        const ADD_EVENT_LISTENER_SOURCE = '.' + ADD_EVENT_LISTENER + ':';
        const PREPEND_EVENT_LISTENER = 'prependListener';
        const PREPEND_EVENT_LISTENER_SOURCE = '.' + PREPEND_EVENT_LISTENER + ':';
        const invokeTask = function (task, target, event) {
            // for better performance, check isRemoved which is set
            // by removeEventListener
            if (task.isRemoved) {
                return;
            }
            const delegate = task.callback;
            if (typeof delegate === 'object' && delegate.handleEvent) {
                // create the bind version of handleEvent when invoke
                task.callback = (event) => delegate.handleEvent(event);
                task.originalDelegate = delegate;
            }
            // invoke static task.invoke
            task.invoke(task, target, [event]);
            const options = task.options;
            if (options && typeof options === 'object' && options.once) {
                // if options.once is true, after invoke once remove listener here
                // only browser need to do this, nodejs eventEmitter will cal removeListener
                // inside EventEmitter.once
                const delegate = task.originalDelegate ? task.originalDelegate : task.callback;
                target[REMOVE_EVENT_LISTENER].call(target, event.type, delegate, options);
            }
        };
        // global shared zoneAwareCallback to handle all event callback with capture = false
        const globalZoneAwareCallback = function (event) {
            // https://github.com/angular/zone.js/issues/911, in IE, sometimes
            // event will be undefined, so we need to use window.event
            event = event || _global.event;
            if (!event) {
                return;
            }
            // event.target is needed for Samsung TV and SourceBuffer
            // || global is needed https://github.com/angular/zone.js/issues/190
            const target = this || event.target || _global;
            const tasks = target[zoneSymbolEventNames$1[event.type][FALSE_STR]];
            if (tasks) {
                // invoke all tasks which attached to current target with given event.type and capture = false
                // for performance concern, if task.length === 1, just invoke
                if (tasks.length === 1) {
                    invokeTask(tasks[0], target, event);
                }
                else {
                    // https://github.com/angular/zone.js/issues/836
                    // copy the tasks array before invoke, to avoid
                    // the callback will remove itself or other listener
                    const copyTasks = tasks.slice();
                    for (let i = 0; i < copyTasks.length; i++) {
                        if (event && event[IMMEDIATE_PROPAGATION_SYMBOL] === true) {
                            break;
                        }
                        invokeTask(copyTasks[i], target, event);
                    }
                }
            }
        };
        // global shared zoneAwareCallback to handle all event callback with capture = true
        const globalZoneAwareCaptureCallback = function (event) {
            // https://github.com/angular/zone.js/issues/911, in IE, sometimes
            // event will be undefined, so we need to use window.event
            event = event || _global.event;
            if (!event) {
                return;
            }
            // event.target is needed for Samsung TV and SourceBuffer
            // || global is needed https://github.com/angular/zone.js/issues/190
            const target = this || event.target || _global;
            const tasks = target[zoneSymbolEventNames$1[event.type][TRUE_STR]];
            if (tasks) {
                // invoke all tasks which attached to current target with given event.type and capture = false
                // for performance concern, if task.length === 1, just invoke
                if (tasks.length === 1) {
                    invokeTask(tasks[0], target, event);
                }
                else {
                    // https://github.com/angular/zone.js/issues/836
                    // copy the tasks array before invoke, to avoid
                    // the callback will remove itself or other listener
                    const copyTasks = tasks.slice();
                    for (let i = 0; i < copyTasks.length; i++) {
                        if (event && event[IMMEDIATE_PROPAGATION_SYMBOL] === true) {
                            break;
                        }
                        invokeTask(copyTasks[i], target, event);
                    }
                }
            }
        };
        function patchEventTargetMethods(obj, patchOptions) {
            if (!obj) {
                return false;
            }
            let useGlobalCallback = true;
            if (patchOptions && patchOptions.useG !== undefined) {
                useGlobalCallback = patchOptions.useG;
            }
            const validateHandler = patchOptions && patchOptions.vh;
            let checkDuplicate = true;
            if (patchOptions && patchOptions.chkDup !== undefined) {
                checkDuplicate = patchOptions.chkDup;
            }
            let returnTarget = false;
            if (patchOptions && patchOptions.rt !== undefined) {
                returnTarget = patchOptions.rt;
            }
            let proto = obj;
            while (proto && !proto.hasOwnProperty(ADD_EVENT_LISTENER)) {
                proto = ObjectGetPrototypeOf(proto);
            }
            if (!proto && obj[ADD_EVENT_LISTENER]) {
                // somehow we did not find it, but we can see it. This happens on IE for Window properties.
                proto = obj;
            }
            if (!proto) {
                return false;
            }
            if (proto[zoneSymbolAddEventListener]) {
                return false;
            }
            const eventNameToString = patchOptions && patchOptions.eventNameToString;
            // a shared global taskData to pass data for scheduleEventTask
            // so we do not need to create a new object just for pass some data
            const taskData = {};
            const nativeAddEventListener = proto[zoneSymbolAddEventListener] = proto[ADD_EVENT_LISTENER];
            const nativeRemoveEventListener = proto[zoneSymbol(REMOVE_EVENT_LISTENER)] =
                proto[REMOVE_EVENT_LISTENER];
            const nativeListeners = proto[zoneSymbol(LISTENERS_EVENT_LISTENER)] =
                proto[LISTENERS_EVENT_LISTENER];
            const nativeRemoveAllListeners = proto[zoneSymbol(REMOVE_ALL_LISTENERS_EVENT_LISTENER)] =
                proto[REMOVE_ALL_LISTENERS_EVENT_LISTENER];
            let nativePrependEventListener;
            if (patchOptions && patchOptions.prepend) {
                nativePrependEventListener = proto[zoneSymbol(patchOptions.prepend)] =
                    proto[patchOptions.prepend];
            }
            /**
             * This util function will build an option object with passive option
             * to handle all possible input from the user.
             */
            function buildEventListenerOptions(options, passive) {
                if (!passiveSupported && typeof options === 'object' && options) {
                    // doesn't support passive but user want to pass an object as options.
                    // this will not work on some old browser, so we just pass a boolean
                    // as useCapture parameter
                    return !!options.capture;
                }
                if (!passiveSupported || !passive) {
                    return options;
                }
                if (typeof options === 'boolean') {
                    return { capture: options, passive: true };
                }
                if (!options) {
                    return { passive: true };
                }
                if (typeof options === 'object' && options.passive !== false) {
                    return Object.assign(Object.assign({}, options), { passive: true });
                }
                return options;
            }
            const customScheduleGlobal = function (task) {
                // if there is already a task for the eventName + capture,
                // just return, because we use the shared globalZoneAwareCallback here.
                if (taskData.isExisting) {
                    return;
                }
                return nativeAddEventListener.call(taskData.target, taskData.eventName, taskData.capture ? globalZoneAwareCaptureCallback : globalZoneAwareCallback, taskData.options);
            };
            const customCancelGlobal = function (task) {
                // if task is not marked as isRemoved, this call is directly
                // from Zone.prototype.cancelTask, we should remove the task
                // from tasksList of target first
                if (!task.isRemoved) {
                    const symbolEventNames = zoneSymbolEventNames$1[task.eventName];
                    let symbolEventName;
                    if (symbolEventNames) {
                        symbolEventName = symbolEventNames[task.capture ? TRUE_STR : FALSE_STR];
                    }
                    const existingTasks = symbolEventName && task.target[symbolEventName];
                    if (existingTasks) {
                        for (let i = 0; i < existingTasks.length; i++) {
                            const existingTask = existingTasks[i];
                            if (existingTask === task) {
                                existingTasks.splice(i, 1);
                                // set isRemoved to data for faster invokeTask check
                                task.isRemoved = true;
                                if (existingTasks.length === 0) {
                                    // all tasks for the eventName + capture have gone,
                                    // remove globalZoneAwareCallback and remove the task cache from target
                                    task.allRemoved = true;
                                    task.target[symbolEventName] = null;
                                }
                                break;
                            }
                        }
                    }
                }
                // if all tasks for the eventName + capture have gone,
                // we will really remove the global event callback,
                // if not, return
                if (!task.allRemoved) {
                    return;
                }
                return nativeRemoveEventListener.call(task.target, task.eventName, task.capture ? globalZoneAwareCaptureCallback : globalZoneAwareCallback, task.options);
            };
            const customScheduleNonGlobal = function (task) {
                return nativeAddEventListener.call(taskData.target, taskData.eventName, task.invoke, taskData.options);
            };
            const customSchedulePrepend = function (task) {
                return nativePrependEventListener.call(taskData.target, taskData.eventName, task.invoke, taskData.options);
            };
            const customCancelNonGlobal = function (task) {
                return nativeRemoveEventListener.call(task.target, task.eventName, task.invoke, task.options);
            };
            const customSchedule = useGlobalCallback ? customScheduleGlobal : customScheduleNonGlobal;
            const customCancel = useGlobalCallback ? customCancelGlobal : customCancelNonGlobal;
            const compareTaskCallbackVsDelegate = function (task, delegate) {
                const typeOfDelegate = typeof delegate;
                return (typeOfDelegate === 'function' && task.callback === delegate) ||
                    (typeOfDelegate === 'object' && task.originalDelegate === delegate);
            };
            const compare = (patchOptions && patchOptions.diff) ? patchOptions.diff : compareTaskCallbackVsDelegate;
            const blackListedEvents = Zone[zoneSymbol('BLACK_LISTED_EVENTS')];
            const passiveEvents = _global[zoneSymbol('PASSIVE_EVENTS')];
            const makeAddListener = function (nativeListener, addSource, customScheduleFn, customCancelFn, returnTarget = false, prepend = false) {
                return function () {
                    const target = this || _global;
                    let eventName = arguments[0];
                    if (patchOptions && patchOptions.transferEventName) {
                        eventName = patchOptions.transferEventName(eventName);
                    }
                    let delegate = arguments[1];
                    if (!delegate) {
                        return nativeListener.apply(this, arguments);
                    }
                    if (isNode && eventName === 'uncaughtException') {
                        // don't patch uncaughtException of nodejs to prevent endless loop
                        return nativeListener.apply(this, arguments);
                    }
                    // don't create the bind delegate function for handleEvent
                    // case here to improve addEventListener performance
                    // we will create the bind delegate when invoke
                    let isHandleEvent = false;
                    if (typeof delegate !== 'function') {
                        if (!delegate.handleEvent) {
                            return nativeListener.apply(this, arguments);
                        }
                        isHandleEvent = true;
                    }
                    if (validateHandler && !validateHandler(nativeListener, delegate, target, arguments)) {
                        return;
                    }
                    const passive = passiveSupported && !!passiveEvents && passiveEvents.indexOf(eventName) !== -1;
                    const options = buildEventListenerOptions(arguments[2], passive);
                    if (blackListedEvents) {
                        // check black list
                        for (let i = 0; i < blackListedEvents.length; i++) {
                            if (eventName === blackListedEvents[i]) {
                                if (passive) {
                                    return nativeListener.call(target, eventName, delegate, options);
                                }
                                else {
                                    return nativeListener.apply(this, arguments);
                                }
                            }
                        }
                    }
                    const capture = !options ? false : typeof options === 'boolean' ? true : options.capture;
                    const once = options && typeof options === 'object' ? options.once : false;
                    const zone = Zone.current;
                    let symbolEventNames = zoneSymbolEventNames$1[eventName];
                    if (!symbolEventNames) {
                        prepareEventNames(eventName, eventNameToString);
                        symbolEventNames = zoneSymbolEventNames$1[eventName];
                    }
                    const symbolEventName = symbolEventNames[capture ? TRUE_STR : FALSE_STR];
                    let existingTasks = target[symbolEventName];
                    let isExisting = false;
                    if (existingTasks) {
                        // already have task registered
                        isExisting = true;
                        if (checkDuplicate) {
                            for (let i = 0; i < existingTasks.length; i++) {
                                if (compare(existingTasks[i], delegate)) {
                                    // same callback, same capture, same event name, just return
                                    return;
                                }
                            }
                        }
                    }
                    else {
                        existingTasks = target[symbolEventName] = [];
                    }
                    let source;
                    const constructorName = target.constructor['name'];
                    const targetSource = globalSources[constructorName];
                    if (targetSource) {
                        source = targetSource[eventName];
                    }
                    if (!source) {
                        source = constructorName + addSource +
                            (eventNameToString ? eventNameToString(eventName) : eventName);
                    }
                    // do not create a new object as task.data to pass those things
                    // just use the global shared one
                    taskData.options = options;
                    if (once) {
                        // if addEventListener with once options, we don't pass it to
                        // native addEventListener, instead we keep the once setting
                        // and handle ourselves.
                        taskData.options.once = false;
                    }
                    taskData.target = target;
                    taskData.capture = capture;
                    taskData.eventName = eventName;
                    taskData.isExisting = isExisting;
                    const data = useGlobalCallback ? OPTIMIZED_ZONE_EVENT_TASK_DATA : undefined;
                    // keep taskData into data to allow onScheduleEventTask to access the task information
                    if (data) {
                        data.taskData = taskData;
                    }
                    const task = zone.scheduleEventTask(source, delegate, data, customScheduleFn, customCancelFn);
                    // should clear taskData.target to avoid memory leak
                    // issue, https://github.com/angular/angular/issues/20442
                    taskData.target = null;
                    // need to clear up taskData because it is a global object
                    if (data) {
                        data.taskData = null;
                    }
                    // have to save those information to task in case
                    // application may call task.zone.cancelTask() directly
                    if (once) {
                        options.once = true;
                    }
                    if (!(!passiveSupported && typeof task.options === 'boolean')) {
                        // if not support passive, and we pass an option object
                        // to addEventListener, we should save the options to task
                        task.options = options;
                    }
                    task.target = target;
                    task.capture = capture;
                    task.eventName = eventName;
                    if (isHandleEvent) {
                        // save original delegate for compare to check duplicate
                        task.originalDelegate = delegate;
                    }
                    if (!prepend) {
                        existingTasks.push(task);
                    }
                    else {
                        existingTasks.unshift(task);
                    }
                    if (returnTarget) {
                        return target;
                    }
                };
            };
            proto[ADD_EVENT_LISTENER] = makeAddListener(nativeAddEventListener, ADD_EVENT_LISTENER_SOURCE, customSchedule, customCancel, returnTarget);
            if (nativePrependEventListener) {
                proto[PREPEND_EVENT_LISTENER] = makeAddListener(nativePrependEventListener, PREPEND_EVENT_LISTENER_SOURCE, customSchedulePrepend, customCancel, returnTarget, true);
            }
            proto[REMOVE_EVENT_LISTENER] = function () {
                const target = this || _global;
                let eventName = arguments[0];
                if (patchOptions && patchOptions.transferEventName) {
                    eventName = patchOptions.transferEventName(eventName);
                }
                const options = arguments[2];
                const capture = !options ? false : typeof options === 'boolean' ? true : options.capture;
                const delegate = arguments[1];
                if (!delegate) {
                    return nativeRemoveEventListener.apply(this, arguments);
                }
                if (validateHandler &&
                    !validateHandler(nativeRemoveEventListener, delegate, target, arguments)) {
                    return;
                }
                const symbolEventNames = zoneSymbolEventNames$1[eventName];
                let symbolEventName;
                if (symbolEventNames) {
                    symbolEventName = symbolEventNames[capture ? TRUE_STR : FALSE_STR];
                }
                const existingTasks = symbolEventName && target[symbolEventName];
                if (existingTasks) {
                    for (let i = 0; i < existingTasks.length; i++) {
                        const existingTask = existingTasks[i];
                        if (compare(existingTask, delegate)) {
                            existingTasks.splice(i, 1);
                            // set isRemoved to data for faster invokeTask check
                            existingTask.isRemoved = true;
                            if (existingTasks.length === 0) {
                                // all tasks for the eventName + capture have gone,
                                // remove globalZoneAwareCallback and remove the task cache from target
                                existingTask.allRemoved = true;
                                target[symbolEventName] = null;
                                // in the target, we have an event listener which is added by on_property
                                // such as target.onclick = function() {}, so we need to clear this internal
                                // property too if all delegates all removed
                                if (typeof eventName === 'string') {
                                    const onPropertySymbol = ZONE_SYMBOL_PREFIX + 'ON_PROPERTY' + eventName;
                                    target[onPropertySymbol] = null;
                                }
                            }
                            existingTask.zone.cancelTask(existingTask);
                            if (returnTarget) {
                                return target;
                            }
                            return;
                        }
                    }
                }
                // issue 930, didn't find the event name or callback
                // from zone kept existingTasks, the callback maybe
                // added outside of zone, we need to call native removeEventListener
                // to try to remove it.
                return nativeRemoveEventListener.apply(this, arguments);
            };
            proto[LISTENERS_EVENT_LISTENER] = function () {
                const target = this || _global;
                let eventName = arguments[0];
                if (patchOptions && patchOptions.transferEventName) {
                    eventName = patchOptions.transferEventName(eventName);
                }
                const listeners = [];
                const tasks = findEventTasks(target, eventNameToString ? eventNameToString(eventName) : eventName);
                for (let i = 0; i < tasks.length; i++) {
                    const task = tasks[i];
                    let delegate = task.originalDelegate ? task.originalDelegate : task.callback;
                    listeners.push(delegate);
                }
                return listeners;
            };
            proto[REMOVE_ALL_LISTENERS_EVENT_LISTENER] = function () {
                const target = this || _global;
                let eventName = arguments[0];
                if (!eventName) {
                    const keys = Object.keys(target);
                    for (let i = 0; i < keys.length; i++) {
                        const prop = keys[i];
                        const match = EVENT_NAME_SYMBOL_REGX.exec(prop);
                        let evtName = match && match[1];
                        // in nodejs EventEmitter, removeListener event is
                        // used for monitoring the removeListener call,
                        // so just keep removeListener eventListener until
                        // all other eventListeners are removed
                        if (evtName && evtName !== 'removeListener') {
                            this[REMOVE_ALL_LISTENERS_EVENT_LISTENER].call(this, evtName);
                        }
                    }
                    // remove removeListener listener finally
                    this[REMOVE_ALL_LISTENERS_EVENT_LISTENER].call(this, 'removeListener');
                }
                else {
                    if (patchOptions && patchOptions.transferEventName) {
                        eventName = patchOptions.transferEventName(eventName);
                    }
                    const symbolEventNames = zoneSymbolEventNames$1[eventName];
                    if (symbolEventNames) {
                        const symbolEventName = symbolEventNames[FALSE_STR];
                        const symbolCaptureEventName = symbolEventNames[TRUE_STR];
                        const tasks = target[symbolEventName];
                        const captureTasks = target[symbolCaptureEventName];
                        if (tasks) {
                            const removeTasks = tasks.slice();
                            for (let i = 0; i < removeTasks.length; i++) {
                                const task = removeTasks[i];
                                let delegate = task.originalDelegate ? task.originalDelegate : task.callback;
                                this[REMOVE_EVENT_LISTENER].call(this, eventName, delegate, task.options);
                            }
                        }
                        if (captureTasks) {
                            const removeTasks = captureTasks.slice();
                            for (let i = 0; i < removeTasks.length; i++) {
                                const task = removeTasks[i];
                                let delegate = task.originalDelegate ? task.originalDelegate : task.callback;
                                this[REMOVE_EVENT_LISTENER].call(this, eventName, delegate, task.options);
                            }
                        }
                    }
                }
                if (returnTarget) {
                    return this;
                }
            };
            // for native toString patch
            attachOriginToPatched(proto[ADD_EVENT_LISTENER], nativeAddEventListener);
            attachOriginToPatched(proto[REMOVE_EVENT_LISTENER], nativeRemoveEventListener);
            if (nativeRemoveAllListeners) {
                attachOriginToPatched(proto[REMOVE_ALL_LISTENERS_EVENT_LISTENER], nativeRemoveAllListeners);
            }
            if (nativeListeners) {
                attachOriginToPatched(proto[LISTENERS_EVENT_LISTENER], nativeListeners);
            }
            return true;
        }
        let results = [];
        for (let i = 0; i < apis.length; i++) {
            results[i] = patchEventTargetMethods(apis[i], patchOptions);
        }
        return results;
    }
    function findEventTasks(target, eventName) {
        if (!eventName) {
            const foundTasks = [];
            for (let prop in target) {
                const match = EVENT_NAME_SYMBOL_REGX.exec(prop);
                let evtName = match && match[1];
                if (evtName && (!eventName || evtName === eventName)) {
                    const tasks = target[prop];
                    if (tasks) {
                        for (let i = 0; i < tasks.length; i++) {
                            foundTasks.push(tasks[i]);
                        }
                    }
                }
            }
            return foundTasks;
        }
        let symbolEventName = zoneSymbolEventNames$1[eventName];
        if (!symbolEventName) {
            prepareEventNames(eventName);
            symbolEventName = zoneSymbolEventNames$1[eventName];
        }
        const captureFalseTasks = target[symbolEventName[FALSE_STR]];
        const captureTrueTasks = target[symbolEventName[TRUE_STR]];
        if (!captureFalseTasks) {
            return captureTrueTasks ? captureTrueTasks.slice() : [];
        }
        else {
            return captureTrueTasks ? captureFalseTasks.concat(captureTrueTasks) :
                captureFalseTasks.slice();
        }
    }
    function patchEventPrototype(global, api) {
        const Event = global['Event'];
        if (Event && Event.prototype) {
            api.patchMethod(Event.prototype, 'stopImmediatePropagation', (delegate) => function (self, args) {
                self[IMMEDIATE_PROPAGATION_SYMBOL] = true;
                // we need to call the native stopImmediatePropagation
                // in case in some hybrid application, some part of
                // application will be controlled by zone, some are not
                delegate && delegate.apply(self, args);
            });
        }
    }

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    function patchCallbacks(api, target, targetName, method, callbacks) {
        const symbol = Zone.__symbol__(method);
        if (target[symbol]) {
            return;
        }
        const nativeDelegate = target[symbol] = target[method];
        target[method] = function (name, opts, options) {
            if (opts && opts.prototype) {
                callbacks.forEach(function (callback) {
                    const source = `${targetName}.${method}::` + callback;
                    const prototype = opts.prototype;
                    if (prototype.hasOwnProperty(callback)) {
                        const descriptor = api.ObjectGetOwnPropertyDescriptor(prototype, callback);
                        if (descriptor && descriptor.value) {
                            descriptor.value = api.wrapWithCurrentZone(descriptor.value, source);
                            api._redefineProperty(opts.prototype, callback, descriptor);
                        }
                        else if (prototype[callback]) {
                            prototype[callback] = api.wrapWithCurrentZone(prototype[callback], source);
                        }
                    }
                    else if (prototype[callback]) {
                        prototype[callback] = api.wrapWithCurrentZone(prototype[callback], source);
                    }
                });
            }
            return nativeDelegate.call(target, name, opts, options);
        };
        api.attachOriginToPatched(target[method], nativeDelegate);
    }

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    const globalEventHandlersEventNames = [
        'abort',
        'animationcancel',
        'animationend',
        'animationiteration',
        'auxclick',
        'beforeinput',
        'blur',
        'cancel',
        'canplay',
        'canplaythrough',
        'change',
        'compositionstart',
        'compositionupdate',
        'compositionend',
        'cuechange',
        'click',
        'close',
        'contextmenu',
        'curechange',
        'dblclick',
        'drag',
        'dragend',
        'dragenter',
        'dragexit',
        'dragleave',
        'dragover',
        'drop',
        'durationchange',
        'emptied',
        'ended',
        'error',
        'focus',
        'focusin',
        'focusout',
        'gotpointercapture',
        'input',
        'invalid',
        'keydown',
        'keypress',
        'keyup',
        'load',
        'loadstart',
        'loadeddata',
        'loadedmetadata',
        'lostpointercapture',
        'mousedown',
        'mouseenter',
        'mouseleave',
        'mousemove',
        'mouseout',
        'mouseover',
        'mouseup',
        'mousewheel',
        'orientationchange',
        'pause',
        'play',
        'playing',
        'pointercancel',
        'pointerdown',
        'pointerenter',
        'pointerleave',
        'pointerlockchange',
        'mozpointerlockchange',
        'webkitpointerlockerchange',
        'pointerlockerror',
        'mozpointerlockerror',
        'webkitpointerlockerror',
        'pointermove',
        'pointout',
        'pointerover',
        'pointerup',
        'progress',
        'ratechange',
        'reset',
        'resize',
        'scroll',
        'seeked',
        'seeking',
        'select',
        'selectionchange',
        'selectstart',
        'show',
        'sort',
        'stalled',
        'submit',
        'suspend',
        'timeupdate',
        'volumechange',
        'touchcancel',
        'touchmove',
        'touchstart',
        'touchend',
        'transitioncancel',
        'transitionend',
        'waiting',
        'wheel'
    ];
    const documentEventNames = [
        'afterscriptexecute', 'beforescriptexecute', 'DOMContentLoaded', 'freeze', 'fullscreenchange',
        'mozfullscreenchange', 'webkitfullscreenchange', 'msfullscreenchange', 'fullscreenerror',
        'mozfullscreenerror', 'webkitfullscreenerror', 'msfullscreenerror', 'readystatechange',
        'visibilitychange', 'resume'
    ];
    const windowEventNames = [
        'absolutedeviceorientation',
        'afterinput',
        'afterprint',
        'appinstalled',
        'beforeinstallprompt',
        'beforeprint',
        'beforeunload',
        'devicelight',
        'devicemotion',
        'deviceorientation',
        'deviceorientationabsolute',
        'deviceproximity',
        'hashchange',
        'languagechange',
        'message',
        'mozbeforepaint',
        'offline',
        'online',
        'paint',
        'pageshow',
        'pagehide',
        'popstate',
        'rejectionhandled',
        'storage',
        'unhandledrejection',
        'unload',
        'userproximity',
        'vrdisplayconnected',
        'vrdisplaydisconnected',
        'vrdisplaypresentchange'
    ];
    const htmlElementEventNames = [
        'beforecopy', 'beforecut', 'beforepaste', 'copy', 'cut', 'paste', 'dragstart', 'loadend',
        'animationstart', 'search', 'transitionrun', 'transitionstart', 'webkitanimationend',
        'webkitanimationiteration', 'webkitanimationstart', 'webkittransitionend'
    ];
    const mediaElementEventNames = ['encrypted', 'waitingforkey', 'msneedkey', 'mozinterruptbegin', 'mozinterruptend'];
    const ieElementEventNames = [
        'activate',
        'afterupdate',
        'ariarequest',
        'beforeactivate',
        'beforedeactivate',
        'beforeeditfocus',
        'beforeupdate',
        'cellchange',
        'controlselect',
        'dataavailable',
        'datasetchanged',
        'datasetcomplete',
        'errorupdate',
        'filterchange',
        'layoutcomplete',
        'losecapture',
        'move',
        'moveend',
        'movestart',
        'propertychange',
        'resizeend',
        'resizestart',
        'rowenter',
        'rowexit',
        'rowsdelete',
        'rowsinserted',
        'command',
        'compassneedscalibration',
        'deactivate',
        'help',
        'mscontentzoom',
        'msmanipulationstatechanged',
        'msgesturechange',
        'msgesturedoubletap',
        'msgestureend',
        'msgesturehold',
        'msgesturestart',
        'msgesturetap',
        'msgotpointercapture',
        'msinertiastart',
        'mslostpointercapture',
        'mspointercancel',
        'mspointerdown',
        'mspointerenter',
        'mspointerhover',
        'mspointerleave',
        'mspointermove',
        'mspointerout',
        'mspointerover',
        'mspointerup',
        'pointerout',
        'mssitemodejumplistitemremoved',
        'msthumbnailclick',
        'stop',
        'storagecommit'
    ];
    const webglEventNames = ['webglcontextrestored', 'webglcontextlost', 'webglcontextcreationerror'];
    const formEventNames = ['autocomplete', 'autocompleteerror'];
    const detailEventNames = ['toggle'];
    const frameEventNames = ['load'];
    const frameSetEventNames = ['blur', 'error', 'focus', 'load', 'resize', 'scroll', 'messageerror'];
    const marqueeEventNames = ['bounce', 'finish', 'start'];
    const XMLHttpRequestEventNames = [
        'loadstart', 'progress', 'abort', 'error', 'load', 'progress', 'timeout', 'loadend',
        'readystatechange'
    ];
    const IDBIndexEventNames = ['upgradeneeded', 'complete', 'abort', 'success', 'error', 'blocked', 'versionchange', 'close'];
    const websocketEventNames = ['close', 'error', 'open', 'message'];
    const workerEventNames = ['error', 'message'];
    const eventNames = globalEventHandlersEventNames.concat(webglEventNames, formEventNames, detailEventNames, documentEventNames, windowEventNames, htmlElementEventNames, ieElementEventNames);
    function filterProperties(target, onProperties, ignoreProperties) {
        if (!ignoreProperties || ignoreProperties.length === 0) {
            return onProperties;
        }
        const tip = ignoreProperties.filter(ip => ip.target === target);
        if (!tip || tip.length === 0) {
            return onProperties;
        }
        const targetIgnoreProperties = tip[0].ignoreProperties;
        return onProperties.filter(op => targetIgnoreProperties.indexOf(op) === -1);
    }
    function patchFilteredProperties(target, onProperties, ignoreProperties, prototype) {
        // check whether target is available, sometimes target will be undefined
        // because different browser or some 3rd party plugin.
        if (!target) {
            return;
        }
        const filteredProperties = filterProperties(target, onProperties, ignoreProperties);
        patchOnProperties(target, filteredProperties, prototype);
    }
    function propertyDescriptorPatch(api, _global) {
        if (isNode && !isMix) {
            return;
        }
        if (Zone[api.symbol('patchEvents')]) {
            // events are already been patched by legacy patch.
            return;
        }
        const supportsWebSocket = typeof WebSocket !== 'undefined';
        const ignoreProperties = _global['__Zone_ignore_on_properties'];
        // for browsers that we can patch the descriptor:  Chrome & Firefox
        if (isBrowser) {
            const internalWindow = window;
            const ignoreErrorProperties = isIE ? [{ target: internalWindow, ignoreProperties: ['error'] }] : [];
            // in IE/Edge, onProp not exist in window object, but in WindowPrototype
            // so we need to pass WindowPrototype to check onProp exist or not
            patchFilteredProperties(internalWindow, eventNames.concat(['messageerror']), ignoreProperties ? ignoreProperties.concat(ignoreErrorProperties) : ignoreProperties, ObjectGetPrototypeOf(internalWindow));
            patchFilteredProperties(Document.prototype, eventNames, ignoreProperties);
            if (typeof internalWindow['SVGElement'] !== 'undefined') {
                patchFilteredProperties(internalWindow['SVGElement'].prototype, eventNames, ignoreProperties);
            }
            patchFilteredProperties(Element.prototype, eventNames, ignoreProperties);
            patchFilteredProperties(HTMLElement.prototype, eventNames, ignoreProperties);
            patchFilteredProperties(HTMLMediaElement.prototype, mediaElementEventNames, ignoreProperties);
            patchFilteredProperties(HTMLFrameSetElement.prototype, windowEventNames.concat(frameSetEventNames), ignoreProperties);
            patchFilteredProperties(HTMLBodyElement.prototype, windowEventNames.concat(frameSetEventNames), ignoreProperties);
            patchFilteredProperties(HTMLFrameElement.prototype, frameEventNames, ignoreProperties);
            patchFilteredProperties(HTMLIFrameElement.prototype, frameEventNames, ignoreProperties);
            const HTMLMarqueeElement = internalWindow['HTMLMarqueeElement'];
            if (HTMLMarqueeElement) {
                patchFilteredProperties(HTMLMarqueeElement.prototype, marqueeEventNames, ignoreProperties);
            }
            const Worker = internalWindow['Worker'];
            if (Worker) {
                patchFilteredProperties(Worker.prototype, workerEventNames, ignoreProperties);
            }
        }
        const XMLHttpRequest = _global['XMLHttpRequest'];
        if (XMLHttpRequest) {
            // XMLHttpRequest is not available in ServiceWorker, so we need to check here
            patchFilteredProperties(XMLHttpRequest.prototype, XMLHttpRequestEventNames, ignoreProperties);
        }
        const XMLHttpRequestEventTarget = _global['XMLHttpRequestEventTarget'];
        if (XMLHttpRequestEventTarget) {
            patchFilteredProperties(XMLHttpRequestEventTarget && XMLHttpRequestEventTarget.prototype, XMLHttpRequestEventNames, ignoreProperties);
        }
        if (typeof IDBIndex !== 'undefined') {
            patchFilteredProperties(IDBIndex.prototype, IDBIndexEventNames, ignoreProperties);
            patchFilteredProperties(IDBRequest.prototype, IDBIndexEventNames, ignoreProperties);
            patchFilteredProperties(IDBOpenDBRequest.prototype, IDBIndexEventNames, ignoreProperties);
            patchFilteredProperties(IDBDatabase.prototype, IDBIndexEventNames, ignoreProperties);
            patchFilteredProperties(IDBTransaction.prototype, IDBIndexEventNames, ignoreProperties);
            patchFilteredProperties(IDBCursor.prototype, IDBIndexEventNames, ignoreProperties);
        }
        if (supportsWebSocket) {
            patchFilteredProperties(WebSocket.prototype, websocketEventNames, ignoreProperties);
        }
    }

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    Zone.__load_patch('util', (global, Zone, api) => {
        api.patchOnProperties = patchOnProperties;
        api.patchMethod = patchMethod;
        api.bindArguments = bindArguments;
        api.patchMacroTask = patchMacroTask;
        // In earlier version of zone.js (<0.9.0), we use env name `__zone_symbol__BLACK_LISTED_EVENTS` to
        // define which events will not be patched by `Zone.js`.
        // In newer version (>=0.9.0), we change the env name to `__zone_symbol__UNPATCHED_EVENTS` to keep
        // the name consistent with angular repo.
        // The  `__zone_symbol__BLACK_LISTED_EVENTS` is deprecated, but it is still be supported for
        // backwards compatibility.
        const SYMBOL_BLACK_LISTED_EVENTS = Zone.__symbol__('BLACK_LISTED_EVENTS');
        const SYMBOL_UNPATCHED_EVENTS = Zone.__symbol__('UNPATCHED_EVENTS');
        if (global[SYMBOL_UNPATCHED_EVENTS]) {
            global[SYMBOL_BLACK_LISTED_EVENTS] = global[SYMBOL_UNPATCHED_EVENTS];
        }
        if (global[SYMBOL_BLACK_LISTED_EVENTS]) {
            Zone[SYMBOL_BLACK_LISTED_EVENTS] = Zone[SYMBOL_UNPATCHED_EVENTS] =
                global[SYMBOL_BLACK_LISTED_EVENTS];
        }
        api.patchEventPrototype = patchEventPrototype;
        api.patchEventTarget = patchEventTarget;
        api.isIEOrEdge = isIEOrEdge;
        api.ObjectDefineProperty = ObjectDefineProperty;
        api.ObjectGetOwnPropertyDescriptor = ObjectGetOwnPropertyDescriptor;
        api.ObjectCreate = ObjectCreate;
        api.ArraySlice = ArraySlice;
        api.patchClass = patchClass;
        api.wrapWithCurrentZone = wrapWithCurrentZone;
        api.filterProperties = filterProperties;
        api.attachOriginToPatched = attachOriginToPatched;
        api._redefineProperty = Object.defineProperty;
        api.patchCallbacks = patchCallbacks;
        api.getGlobalObjects = () => ({ globalSources, zoneSymbolEventNames: zoneSymbolEventNames$1, eventNames, isBrowser, isMix, isNode, TRUE_STR,
            FALSE_STR, ZONE_SYMBOL_PREFIX, ADD_EVENT_LISTENER_STR, REMOVE_EVENT_LISTENER_STR });
    });

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    const taskSymbol = zoneSymbol('zoneTask');
    function patchTimer(window, setName, cancelName, nameSuffix) {
        let setNative = null;
        let clearNative = null;
        setName += nameSuffix;
        cancelName += nameSuffix;
        const tasksByHandleId = {};
        function scheduleTask(task) {
            const data = task.data;
            function timer() {
                try {
                    task.invoke.apply(this, arguments);
                }
                finally {
                    // issue-934, task will be cancelled
                    // even it is a periodic task such as
                    // setInterval
                    if (!(task.data && task.data.isPeriodic)) {
                        if (typeof data.handleId === 'number') {
                            // in non-nodejs env, we remove timerId
                            // from local cache
                            delete tasksByHandleId[data.handleId];
                        }
                        else if (data.handleId) {
                            // Node returns complex objects as handleIds
                            // we remove task reference from timer object
                            data.handleId[taskSymbol] = null;
                        }
                    }
                }
            }
            data.args[0] = timer;
            data.handleId = setNative.apply(window, data.args);
            return task;
        }
        function clearTask(task) { return clearNative(task.data.handleId); }
        setNative =
            patchMethod(window, setName, (delegate) => function (self, args) {
                if (typeof args[0] === 'function') {
                    const options = {
                        isPeriodic: nameSuffix === 'Interval',
                        delay: (nameSuffix === 'Timeout' || nameSuffix === 'Interval') ? args[1] || 0 :
                            undefined,
                        args: args
                    };
                    const task = scheduleMacroTaskWithCurrentZone(setName, args[0], options, scheduleTask, clearTask);
                    if (!task) {
                        return task;
                    }
                    // Node.js must additionally support the ref and unref functions.
                    const handle = task.data.handleId;
                    if (typeof handle === 'number') {
                        // for non nodejs env, we save handleId: task
                        // mapping in local cache for clearTimeout
                        tasksByHandleId[handle] = task;
                    }
                    else if (handle) {
                        // for nodejs env, we save task
                        // reference in timerId Object for clearTimeout
                        handle[taskSymbol] = task;
                    }
                    // check whether handle is null, because some polyfill or browser
                    // may return undefined from setTimeout/setInterval/setImmediate/requestAnimationFrame
                    if (handle && handle.ref && handle.unref && typeof handle.ref === 'function' &&
                        typeof handle.unref === 'function') {
                        task.ref = handle.ref.bind(handle);
                        task.unref = handle.unref.bind(handle);
                    }
                    if (typeof handle === 'number' || handle) {
                        return handle;
                    }
                    return task;
                }
                else {
                    // cause an error by calling it directly.
                    return delegate.apply(window, args);
                }
            });
        clearNative =
            patchMethod(window, cancelName, (delegate) => function (self, args) {
                const id = args[0];
                let task;
                if (typeof id === 'number') {
                    // non nodejs env.
                    task = tasksByHandleId[id];
                }
                else {
                    // nodejs env.
                    task = id && id[taskSymbol];
                    // other environments.
                    if (!task) {
                        task = id;
                    }
                }
                if (task && typeof task.type === 'string') {
                    if (task.state !== 'notScheduled' &&
                        (task.cancelFn && task.data.isPeriodic || task.runCount === 0)) {
                        if (typeof id === 'number') {
                            delete tasksByHandleId[id];
                        }
                        else if (id) {
                            id[taskSymbol] = null;
                        }
                        // Do not cancel already canceled functions
                        task.zone.cancelTask(task);
                    }
                }
                else {
                    // cause an error by calling it directly.
                    delegate.apply(window, args);
                }
            });
    }

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    function patchCustomElements(_global, api) {
        const { isBrowser, isMix } = api.getGlobalObjects();
        if ((!isBrowser && !isMix) || !_global['customElements'] || !('customElements' in _global)) {
            return;
        }
        const callbacks = ['connectedCallback', 'disconnectedCallback', 'adoptedCallback', 'attributeChangedCallback'];
        api.patchCallbacks(api, _global.customElements, 'customElements', 'define', callbacks);
    }

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    function eventTargetPatch(_global, api) {
        if (Zone[api.symbol('patchEventTarget')]) {
            // EventTarget is already patched.
            return;
        }
        const { eventNames, zoneSymbolEventNames, TRUE_STR, FALSE_STR, ZONE_SYMBOL_PREFIX } = api.getGlobalObjects();
        //  predefine all __zone_symbol__ + eventName + true/false string
        for (let i = 0; i < eventNames.length; i++) {
            const eventName = eventNames[i];
            const falseEventName = eventName + FALSE_STR;
            const trueEventName = eventName + TRUE_STR;
            const symbol = ZONE_SYMBOL_PREFIX + falseEventName;
            const symbolCapture = ZONE_SYMBOL_PREFIX + trueEventName;
            zoneSymbolEventNames[eventName] = {};
            zoneSymbolEventNames[eventName][FALSE_STR] = symbol;
            zoneSymbolEventNames[eventName][TRUE_STR] = symbolCapture;
        }
        const EVENT_TARGET = _global['EventTarget'];
        if (!EVENT_TARGET || !EVENT_TARGET.prototype) {
            return;
        }
        api.patchEventTarget(_global, [EVENT_TARGET && EVENT_TARGET.prototype]);
        return true;
    }
    function patchEvent(global, api) {
        api.patchEventPrototype(global, api);
    }

    /**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
    Zone.__load_patch('legacy', (global) => {
        const legacyPatch = global[Zone.__symbol__('legacyPatch')];
        if (legacyPatch) {
            legacyPatch();
        }
    });
    Zone.__load_patch('timers', (global) => {
        const set = 'set';
        const clear = 'clear';
        patchTimer(global, set, clear, 'Timeout');
        patchTimer(global, set, clear, 'Interval');
        patchTimer(global, set, clear, 'Immediate');
    });
    Zone.__load_patch('requestAnimationFrame', (global) => {
        patchTimer(global, 'request', 'cancel', 'AnimationFrame');
        patchTimer(global, 'mozRequest', 'mozCancel', 'AnimationFrame');
        patchTimer(global, 'webkitRequest', 'webkitCancel', 'AnimationFrame');
    });
    Zone.__load_patch('blocking', (global, Zone) => {
        const blockingMethods = ['alert', 'prompt', 'confirm'];
        for (let i = 0; i < blockingMethods.length; i++) {
            const name = blockingMethods[i];
            patchMethod(global, name, (delegate, symbol, name) => {
                return function (s, args) {
                    return Zone.current.run(delegate, global, args, name);
                };
            });
        }
    });
    Zone.__load_patch('EventTarget', (global, Zone, api) => {
        patchEvent(global, api);
        eventTargetPatch(global, api);
        // patch XMLHttpRequestEventTarget's addEventListener/removeEventListener
        const XMLHttpRequestEventTarget = global['XMLHttpRequestEventTarget'];
        if (XMLHttpRequestEventTarget && XMLHttpRequestEventTarget.prototype) {
            api.patchEventTarget(global, [XMLHttpRequestEventTarget.prototype]);
        }
        patchClass('MutationObserver');
        patchClass('WebKitMutationObserver');
        patchClass('IntersectionObserver');
        patchClass('FileReader');
    });
    Zone.__load_patch('on_property', (global, Zone, api) => {
        propertyDescriptorPatch(api, global);
    });
    Zone.__load_patch('customElements', (global, Zone, api) => {
        patchCustomElements(global, api);
    });
    Zone.__load_patch('XHR', (global, Zone) => {
        // Treat XMLHttpRequest as a macrotask.
        patchXHR(global);
        const XHR_TASK = zoneSymbol('xhrTask');
        const XHR_SYNC = zoneSymbol('xhrSync');
        const XHR_LISTENER = zoneSymbol('xhrListener');
        const XHR_SCHEDULED = zoneSymbol('xhrScheduled');
        const XHR_URL = zoneSymbol('xhrURL');
        const XHR_ERROR_BEFORE_SCHEDULED = zoneSymbol('xhrErrorBeforeScheduled');
        function patchXHR(window) {
            const XMLHttpRequest = window['XMLHttpRequest'];
            if (!XMLHttpRequest) {
                // XMLHttpRequest is not available in service worker
                return;
            }
            const XMLHttpRequestPrototype = XMLHttpRequest.prototype;
            function findPendingTask(target) { return target[XHR_TASK]; }
            let oriAddListener = XMLHttpRequestPrototype[ZONE_SYMBOL_ADD_EVENT_LISTENER];
            let oriRemoveListener = XMLHttpRequestPrototype[ZONE_SYMBOL_REMOVE_EVENT_LISTENER];
            if (!oriAddListener) {
                const XMLHttpRequestEventTarget = window['XMLHttpRequestEventTarget'];
                if (XMLHttpRequestEventTarget) {
                    const XMLHttpRequestEventTargetPrototype = XMLHttpRequestEventTarget.prototype;
                    oriAddListener = XMLHttpRequestEventTargetPrototype[ZONE_SYMBOL_ADD_EVENT_LISTENER];
                    oriRemoveListener = XMLHttpRequestEventTargetPrototype[ZONE_SYMBOL_REMOVE_EVENT_LISTENER];
                }
            }
            const READY_STATE_CHANGE = 'readystatechange';
            const SCHEDULED = 'scheduled';
            function scheduleTask(task) {
                const data = task.data;
                const target = data.target;
                target[XHR_SCHEDULED] = false;
                target[XHR_ERROR_BEFORE_SCHEDULED] = false;
                // remove existing event listener
                const listener = target[XHR_LISTENER];
                if (!oriAddListener) {
                    oriAddListener = target[ZONE_SYMBOL_ADD_EVENT_LISTENER];
                    oriRemoveListener = target[ZONE_SYMBOL_REMOVE_EVENT_LISTENER];
                }
                if (listener) {
                    oriRemoveListener.call(target, READY_STATE_CHANGE, listener);
                }
                const newListener = target[XHR_LISTENER] = () => {
                    if (target.readyState === target.DONE) {
                        // sometimes on some browsers XMLHttpRequest will fire onreadystatechange with
                        // readyState=4 multiple times, so we need to check task state here
                        if (!data.aborted && target[XHR_SCHEDULED] && task.state === SCHEDULED) {
                            // check whether the xhr has registered onload listener
                            // if that is the case, the task should invoke after all
                            // onload listeners finish.
                            const loadTasks = target[Zone.__symbol__('loadfalse')];
                            if (loadTasks && loadTasks.length > 0) {
                                const oriInvoke = task.invoke;
                                task.invoke = function () {
                                    // need to load the tasks again, because in other
                                    // load listener, they may remove themselves
                                    const loadTasks = target[Zone.__symbol__('loadfalse')];
                                    for (let i = 0; i < loadTasks.length; i++) {
                                        if (loadTasks[i] === task) {
                                            loadTasks.splice(i, 1);
                                        }
                                    }
                                    if (!data.aborted && task.state === SCHEDULED) {
                                        oriInvoke.call(task);
                                    }
                                };
                                loadTasks.push(task);
                            }
                            else {
                                task.invoke();
                            }
                        }
                        else if (!data.aborted && target[XHR_SCHEDULED] === false) {
                            // error occurs when xhr.send()
                            target[XHR_ERROR_BEFORE_SCHEDULED] = true;
                        }
                    }
                };
                oriAddListener.call(target, READY_STATE_CHANGE, newListener);
                const storedTask = target[XHR_TASK];
                if (!storedTask) {
                    target[XHR_TASK] = task;
                }
                sendNative.apply(target, data.args);
                target[XHR_SCHEDULED] = true;
                return task;
            }
            function placeholderCallback() { }
            function clearTask(task) {
                const data = task.data;
                // Note - ideally, we would call data.target.removeEventListener here, but it's too late
                // to prevent it from firing. So instead, we store info for the event listener.
                data.aborted = true;
                return abortNative.apply(data.target, data.args);
            }
            const openNative = patchMethod(XMLHttpRequestPrototype, 'open', () => function (self, args) {
                self[XHR_SYNC] = args[2] == false;
                self[XHR_URL] = args[1];
                return openNative.apply(self, args);
            });
            const XMLHTTPREQUEST_SOURCE = 'XMLHttpRequest.send';
            const fetchTaskAborting = zoneSymbol('fetchTaskAborting');
            const fetchTaskScheduling = zoneSymbol('fetchTaskScheduling');
            const sendNative = patchMethod(XMLHttpRequestPrototype, 'send', () => function (self, args) {
                if (Zone.current[fetchTaskScheduling] === true) {
                    // a fetch is scheduling, so we are using xhr to polyfill fetch
                    // and because we already schedule macroTask for fetch, we should
                    // not schedule a macroTask for xhr again
                    return sendNative.apply(self, args);
                }
                if (self[XHR_SYNC]) {
                    // if the XHR is sync there is no task to schedule, just execute the code.
                    return sendNative.apply(self, args);
                }
                else {
                    const options = { target: self, url: self[XHR_URL], isPeriodic: false, args: args, aborted: false };
                    const task = scheduleMacroTaskWithCurrentZone(XMLHTTPREQUEST_SOURCE, placeholderCallback, options, scheduleTask, clearTask);
                    if (self && self[XHR_ERROR_BEFORE_SCHEDULED] === true && !options.aborted &&
                        task.state === SCHEDULED) {
                        // xhr request throw error when send
                        // we should invoke task instead of leaving a scheduled
                        // pending macroTask
                        task.invoke();
                    }
                }
            });
            const abortNative = patchMethod(XMLHttpRequestPrototype, 'abort', () => function (self, args) {
                const task = findPendingTask(self);
                if (task && typeof task.type == 'string') {
                    // If the XHR has already completed, do nothing.
                    // If the XHR has already been aborted, do nothing.
                    // Fix #569, call abort multiple times before done will cause
                    // macroTask task count be negative number
                    if (task.cancelFn == null || (task.data && task.data.aborted)) {
                        return;
                    }
                    task.zone.cancelTask(task);
                }
                else if (Zone.current[fetchTaskAborting] === true) {
                    // the abort is called from fetch polyfill, we need to call native abort of XHR.
                    return abortNative.apply(self, args);
                }
                // Otherwise, we are trying to abort an XHR which has not yet been sent, so there is no
                // task
                // to cancel. Do nothing.
            });
        }
    });
    Zone.__load_patch('geolocation', (global) => {
        /// GEO_LOCATION
        if (global['navigator'] && global['navigator'].geolocation) {
            patchPrototype(global['navigator'].geolocation, ['getCurrentPosition', 'watchPosition']);
        }
    });
    Zone.__load_patch('PromiseRejectionEvent', (global, Zone) => {
        // handle unhandled promise rejection
        function findPromiseRejectionHandler(evtName) {
            return function (e) {
                const eventTasks = findEventTasks(global, evtName);
                eventTasks.forEach(eventTask => {
                    // windows has added unhandledrejection event listener
                    // trigger the event listener
                    const PromiseRejectionEvent = global['PromiseRejectionEvent'];
                    if (PromiseRejectionEvent) {
                        const evt = new PromiseRejectionEvent(evtName, { promise: e.promise, reason: e.rejection });
                        eventTask.invoke(evt);
                    }
                });
            };
        }
        if (global['PromiseRejectionEvent']) {
            Zone[zoneSymbol('unhandledPromiseRejectionHandler')] =
                findPromiseRejectionHandler('unhandledrejection');
            Zone[zoneSymbol('rejectionHandledHandler')] =
                findPromiseRejectionHandler('rejectionhandled');
        }
    });

})));


/***/ })

},[[1,"runtime"]]]);
//# sourceMappingURL=polyfills.js.map        20200826145745                          5     5   5 ( w i n d o w [ " w e b p a c k J s o n p " ]   =   w i n d o w [ " w e b p a c k J s o n p " ]   | |   [ ] ) . p u s h ( [ [ " p o l y f i l l s " ] , { 
 
 / * * * /   1 : 
 / * ! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * ! * \ 
     ! * * *   m u l t i   . / s r c / p o l y f i l l s . t s   * * * ! 
     \ * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * / 
 / * !   n o   s t a t i c   e x p o r t s   f o u n d   * / 
 / * * * /   ( f u n c t i o n ( m o d u l e ,   e x p o r t s ,   _ _ w e b p a c k _ r e q u i r e _ _ )   { 
 
 m o d u l e . e x p o r t s   =   _ _ w e b p a c k _ r e q u i r e _ _ ( / * !   / a n g u l a r - a p p / s r c / p o l y f i l l s . t s   * / " h N / g " ) ; 
 
 
 / * * * /   } ) , 
 
 / * * * /   " h N / g " : 
 / * ! * * * * * * * * * * * * * * * * * * * * * * * * * * ! * \ 
     ! * * *   . / s r c / p o l y f i l l s . t s   * * * ! 
     \ * * * * * * * * * * * * * * * * * * * * * * * * * * / 
 / * !   n o   e x p o r t s   p r o v i d e d   * / 
 / * * * /   ( f u n c t i o n ( m o d u l e ,   _ _ w e b p a c k _ e x p o r t s _ _ ,   _ _ w e b p a c k _ r e q u i r e _ _ )   { 
 
 " u s e   s t r i c t " ; 
 _ _ w e b p a c k _ r e q u i r e _ _ . r ( _ _ w e b p a c k _ e x p o r t s _ _ ) ; 
 / *   h a r m o n y   i m p o r t   * /   v a r   z o n e _ j s _ d i s t _ z o n e _ _ W E B P A C K _ I M P O R T E D _ M O D U L E _ 0 _ _   =   _ _ w e b p a c k _ r e q u i r e _ _ ( / * !   z o n e . j s / d i s t / z o n e   * /   " p D p N " ) ; 
 / *   h a r m o n y   i m p o r t   * /   v a r   z o n e _ j s _ d i s t _ z o n e _ _ W E B P A C K _ I M P O R T E D _ M O D U L E _ 0 _ _ _ d e f a u l t   =   / * # _ _ P U R E _ _ * / _ _ w e b p a c k _ r e q u i r e _ _ . n ( z o n e _ j s _ d i s t _ z o n e _ _ W E B P A C K _ I M P O R T E D _ M O D U L E _ 0 _ _ ) ; 
 / * * 
   *   T h i s   f i l e   i n c l u d e s   p o l y f i l l s   n e e d e d   b y   A n g u l a r   a n d   i s   l o a d e d   b e f o r e   t h e   a p p . 
   *   Y o u   c a n   a d d   y o u r   o w n   e x t r a   p o l y f i l l s   t o   t h i s   f i l e . 
   * 
   *   T h i s   f i l e   i s   d i v i d e d   i n t o   2   s e c t i o n s : 
   *       1 .   B r o w s e r   p o l y f i l l s .   T h e s e   a r e   a p p l i e d   b e f o r e   l o a d i n g   Z o n e J S   a n d   a r e   s o r t e d   b y   b r o w s e r s . 
   *       2 .   A p p l i c a t i o n   i m p o r t s .   F i l e s   i m p o r t e d   a f t e r   Z o n e J S   t h a t   s h o u l d   b e   l o a d e d   b e f o r e   y o u r   m a i n 
   *             f i l e . 
   * 
   *   T h e   c u r r e n t   s e t u p   i s   f o r   s o - c a l l e d   " e v e r g r e e n "   b r o w s e r s ;   t h e   l a s t   v e r s i o n s   o f   b r o w s e r s   t h a t 
   *   a u t o m a t i c a l l y   u p d a t e   t h e m s e l v e s .   T h i s   i n c l u d e s   S a f a r i   > =   1 0 ,   C h r o m e   > =   5 5   ( i n c l u d i n g   O p e r a ) , 
   *   E d g e   > =   1 3   o n   t h e   d e s k t o p ,   a n d   i O S   1 0   a n d   C h r o m e   o n   m o b i l e . 
   * 
   *   L e a r n   m o r e   i n   h t t p s : / / a n g u l a r . i o / g u i d e / b r o w s e r - s u p p o r t 
   * / 
 / * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
   *   B R O W S E R   P O L Y F I L L S 
   * / 
 / * *   I E 1 1   r e q u i r e s   t h e   f o l l o w i n g   f o r   N g C l a s s   s u p p o r t   o n   S V G   e l e m e n t s   * / 
 / /   i m p o r t   ' c l a s s l i s t . j s ' ;     / /   R u n   ` n p m   i n s t a l l   - - s a v e   c l a s s l i s t . j s ` . 
 / * * 
   *   W e b   A n i m a t i o n s   ` @ a n g u l a r / p l a t f o r m - b r o w s e r / a n i m a t i o n s ` 
   *   O n l y   r e q u i r e d   i f   A n i m a t i o n B u i l d e r   i s   u s e d   w i t h i n   t h e   a p p l i c a t i o n   a n d   u s i n g   I E / E d g e   o r   S a f a r i . 
   *   S t a n d a r d   a n i m a t i o n   s u p p o r t   i n   A n g u l a r   D O E S   N O T   r e q u i r e   a n y   p o l y f i l l s   ( a s   o f   A n g u l a r   6 . 0 ) . 
   * / 
 / /   i m p o r t   ' w e b - a n i m a t i o n s - j s ' ;     / /   R u n   ` n p m   i n s t a l l   - - s a v e   w e b - a n i m a t i o n s - j s ` . 
 / * * 
   *   B y   d e f a u l t ,   z o n e . j s   w i l l   p a t c h   a l l   p o s s i b l e   m a c r o T a s k   a n d   D o m E v e n t s 
   *   u s e r   c a n   d i s a b l e   p a r t s   o f   m a c r o T a s k / D o m E v e n t s   p a t c h   b y   s e t t i n g   f o l l o w i n g   f l a g s 
   *   b e c a u s e   t h o s e   f l a g s   n e e d   t o   b e   s e t   b e f o r e   ` z o n e . j s `   b e i n g   l o a d e d ,   a n d   w e b p a c k 
   *   w i l l   p u t   i m p o r t   i n   t h e   t o p   o f   b u n d l e ,   s o   u s e r   n e e d   t o   c r e a t e   a   s e p a r a t e   f i l e 
   *   i n   t h i s   d i r e c t o r y   ( f o r   e x a m p l e :   z o n e - f l a g s . t s ) ,   a n d   p u t   t h e   f o l l o w i n g   f l a g s 
   *   i n t o   t h a t   f i l e ,   a n d   t h e n   a d d   t h e   f o l l o w i n g   c o d e   b e f o r e   i m p o r t i n g   z o n e . j s . 
   *   i m p o r t   ' . / z o n e - f l a g s ' ; 
   * 
   *   T h e   f l a g s   a l l o w e d   i n   z o n e - f l a g s . t s   a r e   l i s t e d   h e r e . 
   * 
   *   T h e   f o l l o w i n g   f l a g s   w i l l   w o r k   f o r   a l l   b r o w s e r s . 
   * 
   *   ( w i n d o w   a s   a n y ) . _ _ Z o n e _ d i s a b l e _ r e q u e s t A n i m a t i o n F r a m e   =   t r u e ;   / /   d i s a b l e   p a t c h   r e q u e s t A n i m a t i o n F r a m e 
   *   ( w i n d o w   a s   a n y ) . _ _ Z o n e _ d i s a b l e _ o n _ p r o p e r t y   =   t r u e ;   / /   d i s a b l e   p a t c h   o n P r o p e r t y   s u c h   a s   o n c l i c k 
   *   ( w i n d o w   a s   a n y ) . _ _ z o n e _ s y m b o l _ _ U N P A T C H E D _ E V E N T S   =   [ ' s c r o l l ' ,   ' m o u s e m o v e ' ] ;   / /   d i s a b l e   p a t c h   s p e c i f i e d   e v e n t N a m e s 
   * 
   *     i n   I E / E d g e   d e v e l o p e r   t o o l s ,   t h e   a d d E v e n t L i s t e n e r   w i l l   a l s o   b e   w r a p p e d   b y   z o n e . j s 
   *     w i t h   t h e   f o l l o w i n g   f l a g ,   i t   w i l l   b y p a s s   ` z o n e . j s `   p a t c h   f o r   I E / E d g e 
   * 
   *     ( w i n d o w   a s   a n y ) . _ _ Z o n e _ e n a b l e _ c r o s s _ c o n t e x t _ c h e c k   =   t r u e ; 
   * 
   * / 
 / * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
   *   Z o n e   J S   i s   r e q u i r e d   b y   d e f a u l t   f o r   A n g u l a r   i t s e l f . 
   * / 
   / /   I n c l u d e d   w i t h   A n g u l a r   C L I . 
 / * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 
   *   A P P L I C A T I O N   I M P O R T S 
   * / 
 
 
 / * * * /   } ) , 
 
 / * * * /   " p D p N " : 
 / * ! * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * ! * \ 
     ! * * *   . / n o d e _ m o d u l e s / z o n e . j s / d i s t / z o n e - e v e r g r e e n . j s   * * * ! 
     \ * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * / 
 / * !   n o   s t a t i c   e x p o r t s   f o u n d   * / 
 / * * * /   ( f u n c t i o n ( m o d u l e ,   e x p o r t s ,   _ _ w e b p a c k _ r e q u i r e _ _ )   { 
 
 v a r   _ _ W E B P A C K _ A M D _ D E F I N E _ F A C T O R Y _ _ ,   _ _ W E B P A C K _ A M D _ D E F I N E _ R E S U L T _ _ ; / * * 
 *   @ l i c e n s e   A n g u l a r   v 9 . 1 . 0 - n e x t . 4 + 6 1 . s h a - e 5 5 2 5 9 1 . w i t h - l o c a l - c h a n g e s 
 *   ( c )   2 0 1 0 - 2 0 2 0   G o o g l e   L L C .   h t t p s : / / a n g u l a r . i o / 
 *   L i c e n s e :   M I T 
 * / 
 ( f u n c t i o n   ( f a c t o r y )   { 
           t r u e   ?   ! ( _ _ W E B P A C K _ A M D _ D E F I N E _ F A C T O R Y _ _   =   ( f a c t o r y ) , 
 	 	 	 	 _ _ W E B P A C K _ A M D _ D E F I N E _ R E S U L T _ _   =   ( t y p e o f   _ _ W E B P A C K _ A M D _ D E F I N E _ F A C T O R Y _ _   = = =   ' f u n c t i o n '   ? 
 	 	 	 	 ( _ _ W E B P A C K _ A M D _ D E F I N E _ F A C T O R Y _ _ . c a l l ( e x p o r t s ,   _ _ w e b p a c k _ r e q u i r e _ _ ,   e x p o r t s ,   m o d u l e ) )   : 
 	 	 	 	 _ _ W E B P A C K _ A M D _ D E F I N E _ F A C T O R Y _ _ ) , 
 	 	 	 	 _ _ W E B P A C K _ A M D _ D E F I N E _ R E S U L T _ _   ! = =   u n d e f i n e d   & &   ( m o d u l e . e x p o r t s   =   _ _ W E B P A C K _ A M D _ D E F I N E _ R E S U L T _ _ ) )   : 
         u n d e f i n e d ; 
 } ( ( f u n c t i o n   ( )   {   ' u s e   s t r i c t ' ; 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         c o n s t   Z o n e $ 1   =   ( f u n c t i o n   ( g l o b a l )   { 
                 c o n s t   p e r f o r m a n c e   =   g l o b a l [ ' p e r f o r m a n c e ' ] ; 
                 f u n c t i o n   m a r k ( n a m e )   {   p e r f o r m a n c e   & &   p e r f o r m a n c e [ ' m a r k ' ]   & &   p e r f o r m a n c e [ ' m a r k ' ] ( n a m e ) ;   } 
                 f u n c t i o n   p e r f o r m a n c e M e a s u r e ( n a m e ,   l a b e l )   { 
                         p e r f o r m a n c e   & &   p e r f o r m a n c e [ ' m e a s u r e ' ]   & &   p e r f o r m a n c e [ ' m e a s u r e ' ] ( n a m e ,   l a b e l ) ; 
                 } 
                 m a r k ( ' Z o n e ' ) ; 
                 / /   I n i t i a l i z e   b e f o r e   i t ' s   a c c e s s e d   b e l o w . 
                 / /   _ _ Z o n e _ s y m b o l _ p r e f i x   g l o b a l   c a n   b e   u s e d   t o   o v e r r i d e   t h e   d e f a u l t   z o n e 
                 / /   s y m b o l   p r e f i x   w i t h   a   c u s t o m   o n e   i f   n e e d e d . 
                 c o n s t   s y m b o l P r e f i x   =   g l o b a l [ ' _ _ Z o n e _ s y m b o l _ p r e f i x ' ]   | |   ' _ _ z o n e _ s y m b o l _ _ ' ; 
                 f u n c t i o n   _ _ s y m b o l _ _ ( n a m e )   {   r e t u r n   s y m b o l P r e f i x   +   n a m e ;   } 
                 c o n s t   c h e c k D u p l i c a t e   =   g l o b a l [ _ _ s y m b o l _ _ ( ' f o r c e D u p l i c a t e Z o n e C h e c k ' ) ]   = = =   t r u e ; 
                 i f   ( g l o b a l [ ' Z o n e ' ] )   { 
                         / /   i f   g l o b a l [ ' Z o n e ' ]   a l r e a d y   e x i s t s   ( m a y b e   z o n e . j s   w a s   a l r e a d y   l o a d e d   o r 
                         / /   s o m e   o t h e r   l i b   a l s o   r e g i s t e r e d   a   g l o b a l   o b j e c t   n a m e d   Z o n e ) ,   w e   m a y   n e e d 
                         / /   t o   t h r o w   a n   e r r o r ,   b u t   s o m e t i m e s   u s e r   m a y   n o t   w a n t   t h i s   e r r o r . 
                         / /   F o r   e x a m p l e , 
                         / /   w e   h a v e   t w o   w e b   p a g e s ,   p a g e 1   i n c l u d e s   z o n e . j s ,   p a g e 2   d o e s n ' t . 
                         / /   a n d   t h e   1 s t   t i m e   u s e r   l o a d   p a g e 1   a n d   p a g e 2 ,   e v e r y t h i n g   w o r k   f i n e , 
                         / /   b u t   w h e n   u s e r   l o a d   p a g e 2   a g a i n ,   e r r o r   o c c u r s   b e c a u s e   g l o b a l [ ' Z o n e ' ]   a l r e a d y   e x i s t s . 
                         / /   s o   w e   a d d   a   f l a g   t o   l e t   u s e r   c h o o s e   w h e t h e r   t o   t h r o w   t h i s   e r r o r   o r   n o t . 
                         / /   B y   d e f a u l t ,   i f   e x i s t i n g   Z o n e   i s   f r o m   z o n e . j s ,   w e   w i l l   n o t   t h r o w   t h e   e r r o r . 
                         i f   ( c h e c k D u p l i c a t e   | |   t y p e o f   g l o b a l [ ' Z o n e ' ] . _ _ s y m b o l _ _   ! = =   ' f u n c t i o n ' )   { 
                                 t h r o w   n e w   E r r o r ( ' Z o n e   a l r e a d y   l o a d e d . ' ) ; 
                         } 
                         e l s e   { 
                                 r e t u r n   g l o b a l [ ' Z o n e ' ] ; 
                         } 
                 } 
                 c l a s s   Z o n e   { 
                         c o n s t r u c t o r ( p a r e n t ,   z o n e S p e c )   { 
                                 t h i s . _ p a r e n t   =   p a r e n t ; 
                                 t h i s . _ n a m e   =   z o n e S p e c   ?   z o n e S p e c . n a m e   | |   ' u n n a m e d '   :   ' < r o o t > ' ; 
                                 t h i s . _ p r o p e r t i e s   =   z o n e S p e c   & &   z o n e S p e c . p r o p e r t i e s   | |   { } ; 
                                 t h i s . _ z o n e D e l e g a t e   = 
                                         n e w   Z o n e D e l e g a t e ( t h i s ,   t h i s . _ p a r e n t   & &   t h i s . _ p a r e n t . _ z o n e D e l e g a t e ,   z o n e S p e c ) ; 
                         } 
                         s t a t i c   a s s e r t Z o n e P a t c h e d ( )   { 
                                 i f   ( g l o b a l [ ' P r o m i s e ' ]   ! = =   p a t c h e s [ ' Z o n e A w a r e P r o m i s e ' ] )   { 
                                         t h r o w   n e w   E r r o r ( ' Z o n e . j s   h a s   d e t e c t e d   t h a t   Z o n e A w a r e P r o m i s e   ` ( w i n d o w | g l o b a l ) . P r o m i s e `   '   + 
                                                 ' h a s   b e e n   o v e r w r i t t e n . \ n '   + 
                                                 ' M o s t   l i k e l y   c a u s e   i s   t h a t   a   P r o m i s e   p o l y f i l l   h a s   b e e n   l o a d e d   '   + 
                                                 ' a f t e r   Z o n e . j s   ( P o l y f i l l i n g   P r o m i s e   a p i   i s   n o t   n e c e s s a r y   w h e n   z o n e . j s   i s   l o a d e d .   '   + 
                                                 ' I f   y o u   m u s t   l o a d   o n e ,   d o   s o   b e f o r e   l o a d i n g   z o n e . j s . ) ' ) ; 
                                 } 
                         } 
                         s t a t i c   g e t   r o o t ( )   { 
                                 l e t   z o n e   =   Z o n e . c u r r e n t ; 
                                 w h i l e   ( z o n e . p a r e n t )   { 
                                         z o n e   =   z o n e . p a r e n t ; 
                                 } 
                                 r e t u r n   z o n e ; 
                         } 
                         s t a t i c   g e t   c u r r e n t ( )   {   r e t u r n   _ c u r r e n t Z o n e F r a m e . z o n e ;   } 
                         s t a t i c   g e t   c u r r e n t T a s k ( )   {   r e t u r n   _ c u r r e n t T a s k ;   } 
                         / /   t s l i n t : d i s a b l e - n e x t - l i n e : r e q u i r e - i n t e r n a l - w i t h - u n d e r s c o r e 
                         s t a t i c   _ _ l o a d _ p a t c h ( n a m e ,   f n )   { 
                                 i f   ( p a t c h e s . h a s O w n P r o p e r t y ( n a m e ) )   { 
                                         i f   ( c h e c k D u p l i c a t e )   { 
                                                 t h r o w   E r r o r ( ' A l r e a d y   l o a d e d   p a t c h :   '   +   n a m e ) ; 
                                         } 
                                 } 
                                 e l s e   i f   ( ! g l o b a l [ ' _ _ Z o n e _ d i s a b l e _ '   +   n a m e ] )   { 
                                         c o n s t   p e r f N a m e   =   ' Z o n e : '   +   n a m e ; 
                                         m a r k ( p e r f N a m e ) ; 
                                         p a t c h e s [ n a m e ]   =   f n ( g l o b a l ,   Z o n e ,   _ a p i ) ; 
                                         p e r f o r m a n c e M e a s u r e ( p e r f N a m e ,   p e r f N a m e ) ; 
                                 } 
                         } 
                         g e t   p a r e n t ( )   {   r e t u r n   t h i s . _ p a r e n t ;   } 
                         g e t   n a m e ( )   {   r e t u r n   t h i s . _ n a m e ;   } 
                         g e t ( k e y )   { 
                                 c o n s t   z o n e   =   t h i s . g e t Z o n e W i t h ( k e y ) ; 
                                 i f   ( z o n e ) 
                                         r e t u r n   z o n e . _ p r o p e r t i e s [ k e y ] ; 
                         } 
                         g e t Z o n e W i t h ( k e y )   { 
                                 l e t   c u r r e n t   =   t h i s ; 
                                 w h i l e   ( c u r r e n t )   { 
                                         i f   ( c u r r e n t . _ p r o p e r t i e s . h a s O w n P r o p e r t y ( k e y ) )   { 
                                                 r e t u r n   c u r r e n t ; 
                                         } 
                                         c u r r e n t   =   c u r r e n t . _ p a r e n t ; 
                                 } 
                                 r e t u r n   n u l l ; 
                         } 
                         f o r k ( z o n e S p e c )   { 
                                 i f   ( ! z o n e S p e c ) 
                                         t h r o w   n e w   E r r o r ( ' Z o n e S p e c   r e q u i r e d ! ' ) ; 
                                 r e t u r n   t h i s . _ z o n e D e l e g a t e . f o r k ( t h i s ,   z o n e S p e c ) ; 
                         } 
                         w r a p ( c a l l b a c k ,   s o u r c e )   { 
                                 i f   ( t y p e o f   c a l l b a c k   ! = =   ' f u n c t i o n ' )   { 
                                         t h r o w   n e w   E r r o r ( ' E x p e c t i n g   f u n c t i o n   g o t :   '   +   c a l l b a c k ) ; 
                                 } 
                                 c o n s t   _ c a l l b a c k   =   t h i s . _ z o n e D e l e g a t e . i n t e r c e p t ( t h i s ,   c a l l b a c k ,   s o u r c e ) ; 
                                 c o n s t   z o n e   =   t h i s ; 
                                 r e t u r n   f u n c t i o n   ( )   { 
                                         r e t u r n   z o n e . r u n G u a r d e d ( _ c a l l b a c k ,   t h i s ,   a r g u m e n t s ,   s o u r c e ) ; 
                                 } ; 
                         } 
                         r u n ( c a l l b a c k ,   a p p l y T h i s ,   a p p l y A r g s ,   s o u r c e )   { 
                                 _ c u r r e n t Z o n e F r a m e   =   {   p a r e n t :   _ c u r r e n t Z o n e F r a m e ,   z o n e :   t h i s   } ; 
                                 t r y   { 
                                         r e t u r n   t h i s . _ z o n e D e l e g a t e . i n v o k e ( t h i s ,   c a l l b a c k ,   a p p l y T h i s ,   a p p l y A r g s ,   s o u r c e ) ; 
                                 } 
                                 f i n a l l y   { 
                                         _ c u r r e n t Z o n e F r a m e   =   _ c u r r e n t Z o n e F r a m e . p a r e n t ; 
                                 } 
                         } 
                         r u n G u a r d e d ( c a l l b a c k ,   a p p l y T h i s   =   n u l l ,   a p p l y A r g s ,   s o u r c e )   { 
                                 _ c u r r e n t Z o n e F r a m e   =   {   p a r e n t :   _ c u r r e n t Z o n e F r a m e ,   z o n e :   t h i s   } ; 
                                 t r y   { 
                                         t r y   { 
                                                 r e t u r n   t h i s . _ z o n e D e l e g a t e . i n v o k e ( t h i s ,   c a l l b a c k ,   a p p l y T h i s ,   a p p l y A r g s ,   s o u r c e ) ; 
                                         } 
                                         c a t c h   ( e r r o r )   { 
                                                 i f   ( t h i s . _ z o n e D e l e g a t e . h a n d l e E r r o r ( t h i s ,   e r r o r ) )   { 
                                                         t h r o w   e r r o r ; 
                                                 } 
                                         } 
                                 } 
                                 f i n a l l y   { 
                                         _ c u r r e n t Z o n e F r a m e   =   _ c u r r e n t Z o n e F r a m e . p a r e n t ; 
                                 } 
                         } 
                         r u n T a s k ( t a s k ,   a p p l y T h i s ,   a p p l y A r g s )   { 
                                 i f   ( t a s k . z o n e   ! =   t h i s )   { 
                                         t h r o w   n e w   E r r o r ( ' A   t a s k   c a n   o n l y   b e   r u n   i n   t h e   z o n e   o f   c r e a t i o n !   ( C r e a t i o n :   '   + 
                                                 ( t a s k . z o n e   | |   N O _ Z O N E ) . n a m e   +   ' ;   E x e c u t i o n :   '   +   t h i s . n a m e   +   ' ) ' ) ; 
                                 } 
                                 / /   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 7 7 8 ,   s o m e t i m e s   e v e n t T a s k 
                                 / /   w i l l   r u n   i n   n o t S c h e d u l e d ( c a n c e l e d )   s t a t e ,   w e   s h o u l d   n o t   t r y   t o 
                                 / /   r u n   s u c h   k i n d   o f   t a s k   b u t   j u s t   r e t u r n 
                                 i f   ( t a s k . s t a t e   = = =   n o t S c h e d u l e d   & &   ( t a s k . t y p e   = = =   e v e n t T a s k   | |   t a s k . t y p e   = = =   m a c r o T a s k ) )   { 
                                         r e t u r n ; 
                                 } 
                                 c o n s t   r e E n t r y G u a r d   =   t a s k . s t a t e   ! =   r u n n i n g ; 
                                 r e E n t r y G u a r d   & &   t a s k . _ t r a n s i t i o n T o ( r u n n i n g ,   s c h e d u l e d ) ; 
                                 t a s k . r u n C o u n t + + ; 
                                 c o n s t   p r e v i o u s T a s k   =   _ c u r r e n t T a s k ; 
                                 _ c u r r e n t T a s k   =   t a s k ; 
                                 _ c u r r e n t Z o n e F r a m e   =   {   p a r e n t :   _ c u r r e n t Z o n e F r a m e ,   z o n e :   t h i s   } ; 
                                 t r y   { 
                                         i f   ( t a s k . t y p e   = =   m a c r o T a s k   & &   t a s k . d a t a   & &   ! t a s k . d a t a . i s P e r i o d i c )   { 
                                                 t a s k . c a n c e l F n   =   u n d e f i n e d ; 
                                         } 
                                         t r y   { 
                                                 r e t u r n   t h i s . _ z o n e D e l e g a t e . i n v o k e T a s k ( t h i s ,   t a s k ,   a p p l y T h i s ,   a p p l y A r g s ) ; 
                                         } 
                                         c a t c h   ( e r r o r )   { 
                                                 i f   ( t h i s . _ z o n e D e l e g a t e . h a n d l e E r r o r ( t h i s ,   e r r o r ) )   { 
                                                         t h r o w   e r r o r ; 
                                                 } 
                                         } 
                                 } 
                                 f i n a l l y   { 
                                         / /   i f   t h e   t a s k ' s   s t a t e   i s   n o t S c h e d u l e d   o r   u n k n o w n ,   t h e n   i t   h a s   a l r e a d y   b e e n   c a n c e l l e d 
                                         / /   w e   s h o u l d   n o t   r e s e t   t h e   s t a t e   t o   s c h e d u l e d 
                                         i f   ( t a s k . s t a t e   ! = =   n o t S c h e d u l e d   & &   t a s k . s t a t e   ! = =   u n k n o w n )   { 
                                                 i f   ( t a s k . t y p e   = =   e v e n t T a s k   | |   ( t a s k . d a t a   & &   t a s k . d a t a . i s P e r i o d i c ) )   { 
                                                         r e E n t r y G u a r d   & &   t a s k . _ t r a n s i t i o n T o ( s c h e d u l e d ,   r u n n i n g ) ; 
                                                 } 
                                                 e l s e   { 
                                                         t a s k . r u n C o u n t   =   0 ; 
                                                         t h i s . _ u p d a t e T a s k C o u n t ( t a s k ,   - 1 ) ; 
                                                         r e E n t r y G u a r d   & & 
                                                                 t a s k . _ t r a n s i t i o n T o ( n o t S c h e d u l e d ,   r u n n i n g ,   n o t S c h e d u l e d ) ; 
                                                 } 
                                         } 
                                         _ c u r r e n t Z o n e F r a m e   =   _ c u r r e n t Z o n e F r a m e . p a r e n t ; 
                                         _ c u r r e n t T a s k   =   p r e v i o u s T a s k ; 
                                 } 
                         } 
                         s c h e d u l e T a s k ( t a s k )   { 
                                 i f   ( t a s k . z o n e   & &   t a s k . z o n e   ! = =   t h i s )   { 
                                         / /   c h e c k   i f   t h e   t a s k   w a s   r e s c h e d u l e d ,   t h e   n e w Z o n e 
                                         / /   s h o u l d   n o t   b e   t h e   c h i l d r e n   o f   t h e   o r i g i n a l   z o n e 
                                         l e t   n e w Z o n e   =   t h i s ; 
                                         w h i l e   ( n e w Z o n e )   { 
                                                 i f   ( n e w Z o n e   = = =   t a s k . z o n e )   { 
                                                         t h r o w   E r r o r ( ` c a n   n o t   r e s c h e d u l e   t a s k   t o   $ { t h i s . n a m e }   w h i c h   i s   d e s c e n d a n t s   o f   t h e   o r i g i n a l   z o n e   $ { t a s k . z o n e . n a m e } ` ) ; 
                                                 } 
                                                 n e w Z o n e   =   n e w Z o n e . p a r e n t ; 
                                         } 
                                 } 
                                 t a s k . _ t r a n s i t i o n T o ( s c h e d u l i n g ,   n o t S c h e d u l e d ) ; 
                                 c o n s t   z o n e D e l e g a t e s   =   [ ] ; 
                                 t a s k . _ z o n e D e l e g a t e s   =   z o n e D e l e g a t e s ; 
                                 t a s k . _ z o n e   =   t h i s ; 
                                 t r y   { 
                                         t a s k   =   t h i s . _ z o n e D e l e g a t e . s c h e d u l e T a s k ( t h i s ,   t a s k ) ; 
                                 } 
                                 c a t c h   ( e r r )   { 
                                         / /   s h o u l d   s e t   t a s k ' s   s t a t e   t o   u n k n o w n   w h e n   s c h e d u l e T a s k   t h r o w   e r r o r 
                                         / /   b e c a u s e   t h e   e r r   m a y   f r o m   r e s c h e d u l e ,   s o   t h e   f r o m S t a t e   m a y b e   n o t S c h e d u l e d 
                                         t a s k . _ t r a n s i t i o n T o ( u n k n o w n ,   s c h e d u l i n g ,   n o t S c h e d u l e d ) ; 
                                         / /   T O D O :   @ J i a L i P a s s i o n ,   s h o u l d   w e   c h e c k   t h e   r e s u l t   f r o m   h a n d l e E r r o r ? 
                                         t h i s . _ z o n e D e l e g a t e . h a n d l e E r r o r ( t h i s ,   e r r ) ; 
                                         t h r o w   e r r ; 
                                 } 
                                 i f   ( t a s k . _ z o n e D e l e g a t e s   = = =   z o n e D e l e g a t e s )   { 
                                         / /   w e   h a v e   t o   c h e c k   b e c a u s e   i n t e r n a l l y   t h e   d e l e g a t e   c a n   r e s c h e d u l e   t h e   t a s k . 
                                         t h i s . _ u p d a t e T a s k C o u n t ( t a s k ,   1 ) ; 
                                 } 
                                 i f   ( t a s k . s t a t e   = =   s c h e d u l i n g )   { 
                                         t a s k . _ t r a n s i t i o n T o ( s c h e d u l e d ,   s c h e d u l i n g ) ; 
                                 } 
                                 r e t u r n   t a s k ; 
                         } 
                         s c h e d u l e M i c r o T a s k ( s o u r c e ,   c a l l b a c k ,   d a t a ,   c u s t o m S c h e d u l e )   { 
                                 r e t u r n   t h i s . s c h e d u l e T a s k ( n e w   Z o n e T a s k ( m i c r o T a s k ,   s o u r c e ,   c a l l b a c k ,   d a t a ,   c u s t o m S c h e d u l e ,   u n d e f i n e d ) ) ; 
                         } 
                         s c h e d u l e M a c r o T a s k ( s o u r c e ,   c a l l b a c k ,   d a t a ,   c u s t o m S c h e d u l e ,   c u s t o m C a n c e l )   { 
                                 r e t u r n   t h i s . s c h e d u l e T a s k ( n e w   Z o n e T a s k ( m a c r o T a s k ,   s o u r c e ,   c a l l b a c k ,   d a t a ,   c u s t o m S c h e d u l e ,   c u s t o m C a n c e l ) ) ; 
                         } 
                         s c h e d u l e E v e n t T a s k ( s o u r c e ,   c a l l b a c k ,   d a t a ,   c u s t o m S c h e d u l e ,   c u s t o m C a n c e l )   { 
                                 r e t u r n   t h i s . s c h e d u l e T a s k ( n e w   Z o n e T a s k ( e v e n t T a s k ,   s o u r c e ,   c a l l b a c k ,   d a t a ,   c u s t o m S c h e d u l e ,   c u s t o m C a n c e l ) ) ; 
                         } 
                         c a n c e l T a s k ( t a s k )   { 
                                 i f   ( t a s k . z o n e   ! =   t h i s ) 
                                         t h r o w   n e w   E r r o r ( ' A   t a s k   c a n   o n l y   b e   c a n c e l l e d   i n   t h e   z o n e   o f   c r e a t i o n !   ( C r e a t i o n :   '   + 
                                                 ( t a s k . z o n e   | |   N O _ Z O N E ) . n a m e   +   ' ;   E x e c u t i o n :   '   +   t h i s . n a m e   +   ' ) ' ) ; 
                                 t a s k . _ t r a n s i t i o n T o ( c a n c e l i n g ,   s c h e d u l e d ,   r u n n i n g ) ; 
                                 t r y   { 
                                         t h i s . _ z o n e D e l e g a t e . c a n c e l T a s k ( t h i s ,   t a s k ) ; 
                                 } 
                                 c a t c h   ( e r r )   { 
                                         / /   i f   e r r o r   o c c u r s   w h e n   c a n c e l T a s k ,   t r a n s i t   t h e   s t a t e   t o   u n k n o w n 
                                         t a s k . _ t r a n s i t i o n T o ( u n k n o w n ,   c a n c e l i n g ) ; 
                                         t h i s . _ z o n e D e l e g a t e . h a n d l e E r r o r ( t h i s ,   e r r ) ; 
                                         t h r o w   e r r ; 
                                 } 
                                 t h i s . _ u p d a t e T a s k C o u n t ( t a s k ,   - 1 ) ; 
                                 t a s k . _ t r a n s i t i o n T o ( n o t S c h e d u l e d ,   c a n c e l i n g ) ; 
                                 t a s k . r u n C o u n t   =   0 ; 
                                 r e t u r n   t a s k ; 
                         } 
                         _ u p d a t e T a s k C o u n t ( t a s k ,   c o u n t )   { 
                                 c o n s t   z o n e D e l e g a t e s   =   t a s k . _ z o n e D e l e g a t e s ; 
                                 i f   ( c o u n t   = =   - 1 )   { 
                                         t a s k . _ z o n e D e l e g a t e s   =   n u l l ; 
                                 } 
                                 f o r   ( l e t   i   =   0 ;   i   <   z o n e D e l e g a t e s . l e n g t h ;   i + + )   { 
                                         z o n e D e l e g a t e s [ i ] . _ u p d a t e T a s k C o u n t ( t a s k . t y p e ,   c o u n t ) ; 
                                 } 
                         } 
                 } 
                 / /   t s l i n t : d i s a b l e - n e x t - l i n e : r e q u i r e - i n t e r n a l - w i t h - u n d e r s c o r e 
                 Z o n e . _ _ s y m b o l _ _   =   _ _ s y m b o l _ _ ; 
                 c o n s t   D E L E G A T E _ Z S   =   { 
                         n a m e :   ' ' , 
                         o n H a s T a s k :   ( d e l e g a t e ,   _ ,   t a r g e t ,   h a s T a s k S t a t e )   = >   d e l e g a t e . h a s T a s k ( t a r g e t ,   h a s T a s k S t a t e ) , 
                         o n S c h e d u l e T a s k :   ( d e l e g a t e ,   _ ,   t a r g e t ,   t a s k )   = >   d e l e g a t e . s c h e d u l e T a s k ( t a r g e t ,   t a s k ) , 
                         o n I n v o k e T a s k :   ( d e l e g a t e ,   _ ,   t a r g e t ,   t a s k ,   a p p l y T h i s ,   a p p l y A r g s )   = >   d e l e g a t e . i n v o k e T a s k ( t a r g e t ,   t a s k ,   a p p l y T h i s ,   a p p l y A r g s ) , 
                         o n C a n c e l T a s k :   ( d e l e g a t e ,   _ ,   t a r g e t ,   t a s k )   = >   d e l e g a t e . c a n c e l T a s k ( t a r g e t ,   t a s k ) 
                 } ; 
                 c l a s s   Z o n e D e l e g a t e   { 
                         c o n s t r u c t o r ( z o n e ,   p a r e n t D e l e g a t e ,   z o n e S p e c )   { 
                                 t h i s . _ t a s k C o u n t s   =   {   ' m i c r o T a s k ' :   0 ,   ' m a c r o T a s k ' :   0 ,   ' e v e n t T a s k ' :   0   } ; 
                                 t h i s . z o n e   =   z o n e ; 
                                 t h i s . _ p a r e n t D e l e g a t e   =   p a r e n t D e l e g a t e ; 
                                 t h i s . _ f o r k Z S   = 
                                         z o n e S p e c   & &   ( z o n e S p e c   & &   z o n e S p e c . o n F o r k   ?   z o n e S p e c   :   p a r e n t D e l e g a t e . _ f o r k Z S ) ; 
                                 t h i s . _ f o r k D l g t   =   z o n e S p e c   & &   ( z o n e S p e c . o n F o r k   ?   p a r e n t D e l e g a t e   :   p a r e n t D e l e g a t e . _ f o r k D l g t ) ; 
                                 t h i s . _ f o r k C u r r Z o n e   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n F o r k   ?   t h i s . z o n e   :   p a r e n t D e l e g a t e . _ f o r k C u r r Z o n e ) ; 
                                 t h i s . _ i n t e r c e p t Z S   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n I n t e r c e p t   ?   z o n e S p e c   :   p a r e n t D e l e g a t e . _ i n t e r c e p t Z S ) ; 
                                 t h i s . _ i n t e r c e p t D l g t   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n I n t e r c e p t   ?   p a r e n t D e l e g a t e   :   p a r e n t D e l e g a t e . _ i n t e r c e p t D l g t ) ; 
                                 t h i s . _ i n t e r c e p t C u r r Z o n e   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n I n t e r c e p t   ?   t h i s . z o n e   :   p a r e n t D e l e g a t e . _ i n t e r c e p t C u r r Z o n e ) ; 
                                 t h i s . _ i n v o k e Z S   =   z o n e S p e c   & &   ( z o n e S p e c . o n I n v o k e   ?   z o n e S p e c   :   p a r e n t D e l e g a t e . _ i n v o k e Z S ) ; 
                                 t h i s . _ i n v o k e D l g t   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n I n v o k e   ?   p a r e n t D e l e g a t e   :   p a r e n t D e l e g a t e . _ i n v o k e D l g t ) ; 
                                 t h i s . _ i n v o k e C u r r Z o n e   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n I n v o k e   ?   t h i s . z o n e   :   p a r e n t D e l e g a t e . _ i n v o k e C u r r Z o n e ) ; 
                                 t h i s . _ h a n d l e E r r o r Z S   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n H a n d l e E r r o r   ?   z o n e S p e c   :   p a r e n t D e l e g a t e . _ h a n d l e E r r o r Z S ) ; 
                                 t h i s . _ h a n d l e E r r o r D l g t   =   z o n e S p e c   & & 
                                         ( z o n e S p e c . o n H a n d l e E r r o r   ?   p a r e n t D e l e g a t e   :   p a r e n t D e l e g a t e . _ h a n d l e E r r o r D l g t ) ; 
                                 t h i s . _ h a n d l e E r r o r C u r r Z o n e   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n H a n d l e E r r o r   ?   t h i s . z o n e   :   p a r e n t D e l e g a t e . _ h a n d l e E r r o r C u r r Z o n e ) ; 
                                 t h i s . _ s c h e d u l e T a s k Z S   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n S c h e d u l e T a s k   ?   z o n e S p e c   :   p a r e n t D e l e g a t e . _ s c h e d u l e T a s k Z S ) ; 
                                 t h i s . _ s c h e d u l e T a s k D l g t   =   z o n e S p e c   & & 
                                         ( z o n e S p e c . o n S c h e d u l e T a s k   ?   p a r e n t D e l e g a t e   :   p a r e n t D e l e g a t e . _ s c h e d u l e T a s k D l g t ) ; 
                                 t h i s . _ s c h e d u l e T a s k C u r r Z o n e   =   z o n e S p e c   & & 
                                         ( z o n e S p e c . o n S c h e d u l e T a s k   ?   t h i s . z o n e   :   p a r e n t D e l e g a t e . _ s c h e d u l e T a s k C u r r Z o n e ) ; 
                                 t h i s . _ i n v o k e T a s k Z S   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n I n v o k e T a s k   ?   z o n e S p e c   :   p a r e n t D e l e g a t e . _ i n v o k e T a s k Z S ) ; 
                                 t h i s . _ i n v o k e T a s k D l g t   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n I n v o k e T a s k   ?   p a r e n t D e l e g a t e   :   p a r e n t D e l e g a t e . _ i n v o k e T a s k D l g t ) ; 
                                 t h i s . _ i n v o k e T a s k C u r r Z o n e   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n I n v o k e T a s k   ?   t h i s . z o n e   :   p a r e n t D e l e g a t e . _ i n v o k e T a s k C u r r Z o n e ) ; 
                                 t h i s . _ c a n c e l T a s k Z S   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n C a n c e l T a s k   ?   z o n e S p e c   :   p a r e n t D e l e g a t e . _ c a n c e l T a s k Z S ) ; 
                                 t h i s . _ c a n c e l T a s k D l g t   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n C a n c e l T a s k   ?   p a r e n t D e l e g a t e   :   p a r e n t D e l e g a t e . _ c a n c e l T a s k D l g t ) ; 
                                 t h i s . _ c a n c e l T a s k C u r r Z o n e   = 
                                         z o n e S p e c   & &   ( z o n e S p e c . o n C a n c e l T a s k   ?   t h i s . z o n e   :   p a r e n t D e l e g a t e . _ c a n c e l T a s k C u r r Z o n e ) ; 
                                 t h i s . _ h a s T a s k Z S   =   n u l l ; 
                                 t h i s . _ h a s T a s k D l g t   =   n u l l ; 
                                 t h i s . _ h a s T a s k D l g t O w n e r   =   n u l l ; 
                                 t h i s . _ h a s T a s k C u r r Z o n e   =   n u l l ; 
                                 c o n s t   z o n e S p e c H a s T a s k   =   z o n e S p e c   & &   z o n e S p e c . o n H a s T a s k ; 
                                 c o n s t   p a r e n t H a s T a s k   =   p a r e n t D e l e g a t e   & &   p a r e n t D e l e g a t e . _ h a s T a s k Z S ; 
                                 i f   ( z o n e S p e c H a s T a s k   | |   p a r e n t H a s T a s k )   { 
                                         / /   I f   w e   n e e d   t o   r e p o r t   h a s T a s k ,   t h a n   t h i s   Z S   n e e d s   t o   d o   r e f   c o u n t i n g   o n   t a s k s .   I n   s u c h 
                                         / /   a   c a s e   a l l   t a s k   r e l a t e d   i n t e r c e p t o r s   m u s t   g o   t h r o u g h   t h i s   Z D .   W e   c a n ' t   s h o r t   c i r c u i t   i t . 
                                         t h i s . _ h a s T a s k Z S   =   z o n e S p e c H a s T a s k   ?   z o n e S p e c   :   D E L E G A T E _ Z S ; 
                                         t h i s . _ h a s T a s k D l g t   =   p a r e n t D e l e g a t e ; 
                                         t h i s . _ h a s T a s k D l g t O w n e r   =   t h i s ; 
                                         t h i s . _ h a s T a s k C u r r Z o n e   =   z o n e ; 
                                         i f   ( ! z o n e S p e c . o n S c h e d u l e T a s k )   { 
                                                 t h i s . _ s c h e d u l e T a s k Z S   =   D E L E G A T E _ Z S ; 
                                                 t h i s . _ s c h e d u l e T a s k D l g t   =   p a r e n t D e l e g a t e ; 
                                                 t h i s . _ s c h e d u l e T a s k C u r r Z o n e   =   t h i s . z o n e ; 
                                         } 
                                         i f   ( ! z o n e S p e c . o n I n v o k e T a s k )   { 
                                                 t h i s . _ i n v o k e T a s k Z S   =   D E L E G A T E _ Z S ; 
                                                 t h i s . _ i n v o k e T a s k D l g t   =   p a r e n t D e l e g a t e ; 
                                                 t h i s . _ i n v o k e T a s k C u r r Z o n e   =   t h i s . z o n e ; 
                                         } 
                                         i f   ( ! z o n e S p e c . o n C a n c e l T a s k )   { 
                                                 t h i s . _ c a n c e l T a s k Z S   =   D E L E G A T E _ Z S ; 
                                                 t h i s . _ c a n c e l T a s k D l g t   =   p a r e n t D e l e g a t e ; 
                                                 t h i s . _ c a n c e l T a s k C u r r Z o n e   =   t h i s . z o n e ; 
                                         } 
                                 } 
                         } 
                         f o r k ( t a r g e t Z o n e ,   z o n e S p e c )   { 
                                 r e t u r n   t h i s . _ f o r k Z S   ? 
                                         t h i s . _ f o r k Z S . o n F o r k ( t h i s . _ f o r k D l g t ,   t h i s . z o n e ,   t a r g e t Z o n e ,   z o n e S p e c )   : 
                                         n e w   Z o n e ( t a r g e t Z o n e ,   z o n e S p e c ) ; 
                         } 
                         i n t e r c e p t ( t a r g e t Z o n e ,   c a l l b a c k ,   s o u r c e )   { 
                                 r e t u r n   t h i s . _ i n t e r c e p t Z S   ? 
                                         t h i s . _ i n t e r c e p t Z S . o n I n t e r c e p t ( t h i s . _ i n t e r c e p t D l g t ,   t h i s . _ i n t e r c e p t C u r r Z o n e ,   t a r g e t Z o n e ,   c a l l b a c k ,   s o u r c e )   : 
                                         c a l l b a c k ; 
                         } 
                         i n v o k e ( t a r g e t Z o n e ,   c a l l b a c k ,   a p p l y T h i s ,   a p p l y A r g s ,   s o u r c e )   { 
                                 r e t u r n   t h i s . _ i n v o k e Z S   ? 
                                         t h i s . _ i n v o k e Z S . o n I n v o k e ( t h i s . _ i n v o k e D l g t ,   t h i s . _ i n v o k e C u r r Z o n e ,   t a r g e t Z o n e ,   c a l l b a c k ,   a p p l y T h i s ,   a p p l y A r g s ,   s o u r c e )   : 
                                         c a l l b a c k . a p p l y ( a p p l y T h i s ,   a p p l y A r g s ) ; 
                         } 
                         h a n d l e E r r o r ( t a r g e t Z o n e ,   e r r o r )   { 
                                 r e t u r n   t h i s . _ h a n d l e E r r o r Z S   ? 
                                         t h i s . _ h a n d l e E r r o r Z S . o n H a n d l e E r r o r ( t h i s . _ h a n d l e E r r o r D l g t ,   t h i s . _ h a n d l e E r r o r C u r r Z o n e ,   t a r g e t Z o n e ,   e r r o r )   : 
                                         t r u e ; 
                         } 
                         s c h e d u l e T a s k ( t a r g e t Z o n e ,   t a s k )   { 
                                 l e t   r e t u r n T a s k   =   t a s k ; 
                                 i f   ( t h i s . _ s c h e d u l e T a s k Z S )   { 
                                         i f   ( t h i s . _ h a s T a s k Z S )   { 
                                                 r e t u r n T a s k . _ z o n e D e l e g a t e s . p u s h ( t h i s . _ h a s T a s k D l g t O w n e r ) ; 
                                         } 
                                         / /   c l a n g - f o r m a t   o f f 
                                         r e t u r n T a s k   =   t h i s . _ s c h e d u l e T a s k Z S . o n S c h e d u l e T a s k ( t h i s . _ s c h e d u l e T a s k D l g t ,   t h i s . _ s c h e d u l e T a s k C u r r Z o n e ,   t a r g e t Z o n e ,   t a s k ) ; 
                                         / /   c l a n g - f o r m a t   o n 
                                         i f   ( ! r e t u r n T a s k ) 
                                                 r e t u r n T a s k   =   t a s k ; 
                                 } 
                                 e l s e   { 
                                         i f   ( t a s k . s c h e d u l e F n )   { 
                                                 t a s k . s c h e d u l e F n ( t a s k ) ; 
                                         } 
                                         e l s e   i f   ( t a s k . t y p e   = =   m i c r o T a s k )   { 
                                                 s c h e d u l e M i c r o T a s k ( t a s k ) ; 
                                         } 
                                         e l s e   { 
                                                 t h r o w   n e w   E r r o r ( ' T a s k   i s   m i s s i n g   s c h e d u l e F n . ' ) ; 
                                         } 
                                 } 
                                 r e t u r n   r e t u r n T a s k ; 
                         } 
                         i n v o k e T a s k ( t a r g e t Z o n e ,   t a s k ,   a p p l y T h i s ,   a p p l y A r g s )   { 
                                 r e t u r n   t h i s . _ i n v o k e T a s k Z S   ? 
                                         t h i s . _ i n v o k e T a s k Z S . o n I n v o k e T a s k ( t h i s . _ i n v o k e T a s k D l g t ,   t h i s . _ i n v o k e T a s k C u r r Z o n e ,   t a r g e t Z o n e ,   t a s k ,   a p p l y T h i s ,   a p p l y A r g s )   : 
                                         t a s k . c a l l b a c k . a p p l y ( a p p l y T h i s ,   a p p l y A r g s ) ; 
                         } 
                         c a n c e l T a s k ( t a r g e t Z o n e ,   t a s k )   { 
                                 l e t   v a l u e ; 
                                 i f   ( t h i s . _ c a n c e l T a s k Z S )   { 
                                         v a l u e   =   t h i s . _ c a n c e l T a s k Z S . o n C a n c e l T a s k ( t h i s . _ c a n c e l T a s k D l g t ,   t h i s . _ c a n c e l T a s k C u r r Z o n e ,   t a r g e t Z o n e ,   t a s k ) ; 
                                 } 
                                 e l s e   { 
                                         i f   ( ! t a s k . c a n c e l F n )   { 
                                                 t h r o w   E r r o r ( ' T a s k   i s   n o t   c a n c e l a b l e ' ) ; 
                                         } 
                                         v a l u e   =   t a s k . c a n c e l F n ( t a s k ) ; 
                                 } 
                                 r e t u r n   v a l u e ; 
                         } 
                         h a s T a s k ( t a r g e t Z o n e ,   i s E m p t y )   { 
                                 / /   h a s T a s k   s h o u l d   n o t   t h r o w   e r r o r   s o   o t h e r   Z o n e D e l e g a t e 
                                 / /   c a n   s t i l l   t r i g g e r   h a s T a s k   c a l l b a c k 
                                 t r y   { 
                                         t h i s . _ h a s T a s k Z S   & & 
                                                 t h i s . _ h a s T a s k Z S . o n H a s T a s k ( t h i s . _ h a s T a s k D l g t ,   t h i s . _ h a s T a s k C u r r Z o n e ,   t a r g e t Z o n e ,   i s E m p t y ) ; 
                                 } 
                                 c a t c h   ( e r r )   { 
                                         t h i s . h a n d l e E r r o r ( t a r g e t Z o n e ,   e r r ) ; 
                                 } 
                         } 
                         / /   t s l i n t : d i s a b l e - n e x t - l i n e : r e q u i r e - i n t e r n a l - w i t h - u n d e r s c o r e 
                         _ u p d a t e T a s k C o u n t ( t y p e ,   c o u n t )   { 
                                 c o n s t   c o u n t s   =   t h i s . _ t a s k C o u n t s ; 
                                 c o n s t   p r e v   =   c o u n t s [ t y p e ] ; 
                                 c o n s t   n e x t   =   c o u n t s [ t y p e ]   =   p r e v   +   c o u n t ; 
                                 i f   ( n e x t   <   0 )   { 
                                         t h r o w   n e w   E r r o r ( ' M o r e   t a s k s   e x e c u t e d   t h e n   w e r e   s c h e d u l e d . ' ) ; 
                                 } 
                                 i f   ( p r e v   = =   0   | |   n e x t   = =   0 )   { 
                                         c o n s t   i s E m p t y   =   { 
                                                 m i c r o T a s k :   c o u n t s [ ' m i c r o T a s k ' ]   >   0 , 
                                                 m a c r o T a s k :   c o u n t s [ ' m a c r o T a s k ' ]   >   0 , 
                                                 e v e n t T a s k :   c o u n t s [ ' e v e n t T a s k ' ]   >   0 , 
                                                 c h a n g e :   t y p e 
                                         } ; 
                                         t h i s . h a s T a s k ( t h i s . z o n e ,   i s E m p t y ) ; 
                                 } 
                         } 
                 } 
                 c l a s s   Z o n e T a s k   { 
                         c o n s t r u c t o r ( t y p e ,   s o u r c e ,   c a l l b a c k ,   o p t i o n s ,   s c h e d u l e F n ,   c a n c e l F n )   { 
                                 / /   t s l i n t : d i s a b l e - n e x t - l i n e : r e q u i r e - i n t e r n a l - w i t h - u n d e r s c o r e 
                                 t h i s . _ z o n e   =   n u l l ; 
                                 t h i s . r u n C o u n t   =   0 ; 
                                 / /   t s l i n t : d i s a b l e - n e x t - l i n e : r e q u i r e - i n t e r n a l - w i t h - u n d e r s c o r e 
                                 t h i s . _ z o n e D e l e g a t e s   =   n u l l ; 
                                 / /   t s l i n t : d i s a b l e - n e x t - l i n e : r e q u i r e - i n t e r n a l - w i t h - u n d e r s c o r e 
                                 t h i s . _ s t a t e   =   ' n o t S c h e d u l e d ' ; 
                                 t h i s . t y p e   =   t y p e ; 
                                 t h i s . s o u r c e   =   s o u r c e ; 
                                 t h i s . d a t a   =   o p t i o n s ; 
                                 t h i s . s c h e d u l e F n   =   s c h e d u l e F n ; 
                                 t h i s . c a n c e l F n   =   c a n c e l F n ; 
                                 i f   ( ! c a l l b a c k )   { 
                                         t h r o w   n e w   E r r o r ( ' c a l l b a c k   i s   n o t   d e f i n e d ' ) ; 
                                 } 
                                 t h i s . c a l l b a c k   =   c a l l b a c k ; 
                                 c o n s t   s e l f   =   t h i s ; 
                                 / /   T O D O :   @ J i a L i P a s s i o n   o p t i o n s   s h o u l d   h a v e   i n t e r f a c e 
                                 i f   ( t y p e   = = =   e v e n t T a s k   & &   o p t i o n s   & &   o p t i o n s . u s e G )   { 
                                         t h i s . i n v o k e   =   Z o n e T a s k . i n v o k e T a s k ; 
                                 } 
                                 e l s e   { 
                                         t h i s . i n v o k e   =   f u n c t i o n   ( )   { 
                                                 r e t u r n   Z o n e T a s k . i n v o k e T a s k . c a l l ( g l o b a l ,   s e l f ,   t h i s ,   a r g u m e n t s ) ; 
                                         } ; 
                                 } 
                         } 
                         s t a t i c   i n v o k e T a s k ( t a s k ,   t a r g e t ,   a r g s )   { 
                                 i f   ( ! t a s k )   { 
                                         t a s k   =   t h i s ; 
                                 } 
                                 _ n u m b e r O f N e s t e d T a s k F r a m e s + + ; 
                                 t r y   { 
                                         t a s k . r u n C o u n t + + ; 
                                         r e t u r n   t a s k . z o n e . r u n T a s k ( t a s k ,   t a r g e t ,   a r g s ) ; 
                                 } 
                                 f i n a l l y   { 
                                         i f   ( _ n u m b e r O f N e s t e d T a s k F r a m e s   = =   1 )   { 
                                                 d r a i n M i c r o T a s k Q u e u e ( ) ; 
                                         } 
                                         _ n u m b e r O f N e s t e d T a s k F r a m e s - - ; 
                                 } 
                         } 
                         g e t   z o n e ( )   {   r e t u r n   t h i s . _ z o n e ;   } 
                         g e t   s t a t e ( )   {   r e t u r n   t h i s . _ s t a t e ;   } 
                         c a n c e l S c h e d u l e R e q u e s t ( )   {   t h i s . _ t r a n s i t i o n T o ( n o t S c h e d u l e d ,   s c h e d u l i n g ) ;   } 
                         / /   t s l i n t : d i s a b l e - n e x t - l i n e : r e q u i r e - i n t e r n a l - w i t h - u n d e r s c o r e 
                         _ t r a n s i t i o n T o ( t o S t a t e ,   f r o m S t a t e 1 ,   f r o m S t a t e 2 )   { 
                                 i f   ( t h i s . _ s t a t e   = = =   f r o m S t a t e 1   | |   t h i s . _ s t a t e   = = =   f r o m S t a t e 2 )   { 
                                         t h i s . _ s t a t e   =   t o S t a t e ; 
                                         i f   ( t o S t a t e   = =   n o t S c h e d u l e d )   { 
                                                 t h i s . _ z o n e D e l e g a t e s   =   n u l l ; 
                                         } 
                                 } 
                                 e l s e   { 
                                         t h r o w   n e w   E r r o r ( ` $ { t h i s . t y p e }   ' $ { t h i s . s o u r c e } ' :   c a n   n o t   t r a n s i t i o n   t o   ' $ { t o S t a t e } ' ,   e x p e c t i n g   s t a t e   ' $ { f r o m S t a t e 1 } ' $ { f r o m S t a t e 2   ?   '   o r   \ ' '   +   f r o m S t a t e 2   +   ' \ ' '   :   ' ' } ,   w a s   ' $ { t h i s . _ s t a t e } ' . ` ) ; 
                                 } 
                         } 
                         t o S t r i n g ( )   { 
                                 i f   ( t h i s . d a t a   & &   t y p e o f   t h i s . d a t a . h a n d l e I d   ! = =   ' u n d e f i n e d ' )   { 
                                         r e t u r n   t h i s . d a t a . h a n d l e I d . t o S t r i n g ( ) ; 
                                 } 
                                 e l s e   { 
                                         r e t u r n   O b j e c t . p r o t o t y p e . t o S t r i n g . c a l l ( t h i s ) ; 
                                 } 
                         } 
                         / /   a d d   t o J S O N   m e t h o d   t o   p r e v e n t   c y c l i c   e r r o r   w h e n 
                         / /   c a l l   J S O N . s t r i n g i f y ( z o n e T a s k ) 
                         t o J S O N ( )   { 
                                 r e t u r n   { 
                                         t y p e :   t h i s . t y p e , 
                                         s t a t e :   t h i s . s t a t e , 
                                         s o u r c e :   t h i s . s o u r c e , 
                                         z o n e :   t h i s . z o n e . n a m e , 
                                         r u n C o u n t :   t h i s . r u n C o u n t 
                                 } ; 
                         } 
                 } 
                 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
                 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
                 / / /     M I C R O T A S K   Q U E U E 
                 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
                 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
                 c o n s t   s y m b o l S e t T i m e o u t   =   _ _ s y m b o l _ _ ( ' s e t T i m e o u t ' ) ; 
                 c o n s t   s y m b o l P r o m i s e   =   _ _ s y m b o l _ _ ( ' P r o m i s e ' ) ; 
                 c o n s t   s y m b o l T h e n   =   _ _ s y m b o l _ _ ( ' t h e n ' ) ; 
                 l e t   _ m i c r o T a s k Q u e u e   =   [ ] ; 
                 l e t   _ i s D r a i n i n g M i c r o t a s k Q u e u e   =   f a l s e ; 
                 l e t   n a t i v e M i c r o T a s k Q u e u e P r o m i s e ; 
                 f u n c t i o n   s c h e d u l e M i c r o T a s k ( t a s k )   { 
                         / /   i f   w e   a r e   n o t   r u n n i n g   i n   a n y   t a s k ,   a n d   t h e r e   h a s   n o t   b e e n   a n y t h i n g   s c h e d u l e d 
                         / /   w e   m u s t   b o o t s t r a p   t h e   i n i t i a l   t a s k   c r e a t i o n   b y   m a n u a l l y   s c h e d u l i n g   t h e   d r a i n 
                         i f   ( _ n u m b e r O f N e s t e d T a s k F r a m e s   = = =   0   & &   _ m i c r o T a s k Q u e u e . l e n g t h   = = =   0 )   { 
                                 / /   W e   a r e   n o t   r u n n i n g   i n   T a s k ,   s o   w e   n e e d   t o   k i c k s t a r t   t h e   m i c r o t a s k   q u e u e . 
                                 i f   ( ! n a t i v e M i c r o T a s k Q u e u e P r o m i s e )   { 
                                         i f   ( g l o b a l [ s y m b o l P r o m i s e ] )   { 
                                                 n a t i v e M i c r o T a s k Q u e u e P r o m i s e   =   g l o b a l [ s y m b o l P r o m i s e ] . r e s o l v e ( 0 ) ; 
                                         } 
                                 } 
                                 i f   ( n a t i v e M i c r o T a s k Q u e u e P r o m i s e )   { 
                                         l e t   n a t i v e T h e n   =   n a t i v e M i c r o T a s k Q u e u e P r o m i s e [ s y m b o l T h e n ] ; 
                                         i f   ( ! n a t i v e T h e n )   { 
                                                 / /   n a t i v e   P r o m i s e   i s   n o t   p a t c h a b l e ,   w e   n e e d   t o   u s e   ` t h e n `   d i r e c t l y 
                                                 / /   i s s u e   1 0 7 8 
                                                 n a t i v e T h e n   =   n a t i v e M i c r o T a s k Q u e u e P r o m i s e [ ' t h e n ' ] ; 
                                         } 
                                         n a t i v e T h e n . c a l l ( n a t i v e M i c r o T a s k Q u e u e P r o m i s e ,   d r a i n M i c r o T a s k Q u e u e ) ; 
                                 } 
                                 e l s e   { 
                                         g l o b a l [ s y m b o l S e t T i m e o u t ] ( d r a i n M i c r o T a s k Q u e u e ,   0 ) ; 
                                 } 
                         } 
                         t a s k   & &   _ m i c r o T a s k Q u e u e . p u s h ( t a s k ) ; 
                 } 
                 f u n c t i o n   d r a i n M i c r o T a s k Q u e u e ( )   { 
                         i f   ( ! _ i s D r a i n i n g M i c r o t a s k Q u e u e )   { 
                                 _ i s D r a i n i n g M i c r o t a s k Q u e u e   =   t r u e ; 
                                 w h i l e   ( _ m i c r o T a s k Q u e u e . l e n g t h )   { 
                                         c o n s t   q u e u e   =   _ m i c r o T a s k Q u e u e ; 
                                         _ m i c r o T a s k Q u e u e   =   [ ] ; 
                                         f o r   ( l e t   i   =   0 ;   i   <   q u e u e . l e n g t h ;   i + + )   { 
                                                 c o n s t   t a s k   =   q u e u e [ i ] ; 
                                                 t r y   { 
                                                         t a s k . z o n e . r u n T a s k ( t a s k ,   n u l l ,   n u l l ) ; 
                                                 } 
                                                 c a t c h   ( e r r o r )   { 
                                                         _ a p i . o n U n h a n d l e d E r r o r ( e r r o r ) ; 
                                                 } 
                                         } 
                                 } 
                                 _ a p i . m i c r o t a s k D r a i n D o n e ( ) ; 
                                 _ i s D r a i n i n g M i c r o t a s k Q u e u e   =   f a l s e ; 
                         } 
                 } 
                 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
                 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
                 / / /     B O O T S T R A P 
                 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
                 / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / 
                 c o n s t   N O _ Z O N E   =   {   n a m e :   ' N O   Z O N E '   } ; 
                 c o n s t   n o t S c h e d u l e d   =   ' n o t S c h e d u l e d ' ,   s c h e d u l i n g   =   ' s c h e d u l i n g ' ,   s c h e d u l e d   =   ' s c h e d u l e d ' ,   r u n n i n g   =   ' r u n n i n g ' ,   c a n c e l i n g   =   ' c a n c e l i n g ' ,   u n k n o w n   =   ' u n k n o w n ' ; 
                 c o n s t   m i c r o T a s k   =   ' m i c r o T a s k ' ,   m a c r o T a s k   =   ' m a c r o T a s k ' ,   e v e n t T a s k   =   ' e v e n t T a s k ' ; 
                 c o n s t   p a t c h e s   =   { } ; 
                 c o n s t   _ a p i   =   { 
                         s y m b o l :   _ _ s y m b o l _ _ , 
                         c u r r e n t Z o n e F r a m e :   ( )   = >   _ c u r r e n t Z o n e F r a m e , 
                         o n U n h a n d l e d E r r o r :   n o o p , 
                         m i c r o t a s k D r a i n D o n e :   n o o p , 
                         s c h e d u l e M i c r o T a s k :   s c h e d u l e M i c r o T a s k , 
                         s h o w U n c a u g h t E r r o r :   ( )   = >   ! Z o n e [ _ _ s y m b o l _ _ ( ' i g n o r e C o n s o l e E r r o r U n c a u g h t E r r o r ' ) ] , 
                         p a t c h E v e n t T a r g e t :   ( )   = >   [ ] , 
                         p a t c h O n P r o p e r t i e s :   n o o p , 
                         p a t c h M e t h o d :   ( )   = >   n o o p , 
                         b i n d A r g u m e n t s :   ( )   = >   [ ] , 
                         p a t c h T h e n :   ( )   = >   n o o p , 
                         p a t c h M a c r o T a s k :   ( )   = >   n o o p , 
                         s e t N a t i v e P r o m i s e :   ( N a t i v e P r o m i s e )   = >   { 
                                 / /   s o m e t i m e s   N a t i v e P r o m i s e . r e s o l v e   s t a t i c   f u n c t i o n 
                                 / /   i s   n o t   r e a d y   y e t ,   ( s u c h   a s   c o r e - j s / e s 6 . p r o m i s e ) 
                                 / /   s o   w e   n e e d   t o   c h e c k   h e r e . 
                                 i f   ( N a t i v e P r o m i s e   & &   t y p e o f   N a t i v e P r o m i s e . r e s o l v e   = = =   ' f u n c t i o n ' )   { 
                                         n a t i v e M i c r o T a s k Q u e u e P r o m i s e   =   N a t i v e P r o m i s e . r e s o l v e ( 0 ) ; 
                                 } 
                         } , 
                         p a t c h E v e n t P r o t o t y p e :   ( )   = >   n o o p , 
                         i s I E O r E d g e :   ( )   = >   f a l s e , 
                         g e t G l o b a l O b j e c t s :   ( )   = >   u n d e f i n e d , 
                         O b j e c t D e f i n e P r o p e r t y :   ( )   = >   n o o p , 
                         O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r :   ( )   = >   u n d e f i n e d , 
                         O b j e c t C r e a t e :   ( )   = >   u n d e f i n e d , 
                         A r r a y S l i c e :   ( )   = >   [ ] , 
                         p a t c h C l a s s :   ( )   = >   n o o p , 
                         w r a p W i t h C u r r e n t Z o n e :   ( )   = >   n o o p , 
                         f i l t e r P r o p e r t i e s :   ( )   = >   [ ] , 
                         a t t a c h O r i g i n T o P a t c h e d :   ( )   = >   n o o p , 
                         _ r e d e f i n e P r o p e r t y :   ( )   = >   n o o p , 
                         p a t c h C a l l b a c k s :   ( )   = >   n o o p 
                 } ; 
                 l e t   _ c u r r e n t Z o n e F r a m e   =   {   p a r e n t :   n u l l ,   z o n e :   n e w   Z o n e ( n u l l ,   n u l l )   } ; 
                 l e t   _ c u r r e n t T a s k   =   n u l l ; 
                 l e t   _ n u m b e r O f N e s t e d T a s k F r a m e s   =   0 ; 
                 f u n c t i o n   n o o p ( )   {   } 
                 p e r f o r m a n c e M e a s u r e ( ' Z o n e ' ,   ' Z o n e ' ) ; 
                 r e t u r n   g l o b a l [ ' Z o n e ' ]   =   Z o n e ; 
         } ) ( t y p e o f   w i n d o w   ! = =   ' u n d e f i n e d '   & &   w i n d o w   | |   t y p e o f   s e l f   ! = =   ' u n d e f i n e d '   & &   s e l f   | |   g l o b a l ) ; 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         Z o n e . _ _ l o a d _ p a t c h ( ' Z o n e A w a r e P r o m i s e ' ,   ( g l o b a l ,   Z o n e ,   a p i )   = >   { 
                 c o n s t   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r   =   O b j e c t . g e t O w n P r o p e r t y D e s c r i p t o r ; 
                 c o n s t   O b j e c t D e f i n e P r o p e r t y   =   O b j e c t . d e f i n e P r o p e r t y ; 
                 f u n c t i o n   r e a d a b l e O b j e c t T o S t r i n g ( o b j )   { 
                         i f   ( o b j   & &   o b j . t o S t r i n g   = = =   O b j e c t . p r o t o t y p e . t o S t r i n g )   { 
                                 c o n s t   c l a s s N a m e   =   o b j . c o n s t r u c t o r   & &   o b j . c o n s t r u c t o r . n a m e ; 
                                 r e t u r n   ( c l a s s N a m e   ?   c l a s s N a m e   :   ' ' )   +   ' :   '   +   J S O N . s t r i n g i f y ( o b j ) ; 
                         } 
                         r e t u r n   o b j   ?   o b j . t o S t r i n g ( )   :   O b j e c t . p r o t o t y p e . t o S t r i n g . c a l l ( o b j ) ; 
                 } 
                 c o n s t   _ _ s y m b o l _ _   =   a p i . s y m b o l ; 
                 c o n s t   _ u n c a u g h t P r o m i s e E r r o r s   =   [ ] ; 
                 c o n s t   i s D i s a b l e W r a p p i n g U n c a u g h t P r o m i s e R e j e c t i o n   =   g l o b a l [ _ _ s y m b o l _ _ ( ' D I S A B L E _ W R A P P I N G _ U N C A U G H T _ P R O M I S E _ R E J E C T I O N ' ) ]   = = =   t r u e ; 
                 c o n s t   s y m b o l P r o m i s e   =   _ _ s y m b o l _ _ ( ' P r o m i s e ' ) ; 
                 c o n s t   s y m b o l T h e n   =   _ _ s y m b o l _ _ ( ' t h e n ' ) ; 
                 c o n s t   c r e a t i o n T r a c e   =   ' _ _ c r e a t i o n T r a c e _ _ ' ; 
                 a p i . o n U n h a n d l e d E r r o r   =   ( e )   = >   { 
                         i f   ( a p i . s h o w U n c a u g h t E r r o r ( ) )   { 
                                 c o n s t   r e j e c t i o n   =   e   & &   e . r e j e c t i o n ; 
                                 i f   ( r e j e c t i o n )   { 
                                         c o n s o l e . e r r o r ( ' U n h a n d l e d   P r o m i s e   r e j e c t i o n : ' ,   r e j e c t i o n   i n s t a n c e o f   E r r o r   ?   r e j e c t i o n . m e s s a g e   :   r e j e c t i o n ,   ' ;   Z o n e : ' ,   e . z o n e . n a m e ,   ' ;   T a s k : ' ,   e . t a s k   & &   e . t a s k . s o u r c e ,   ' ;   V a l u e : ' ,   r e j e c t i o n ,   r e j e c t i o n   i n s t a n c e o f   E r r o r   ?   r e j e c t i o n . s t a c k   :   u n d e f i n e d ) ; 
                                 } 
                                 e l s e   { 
                                         c o n s o l e . e r r o r ( e ) ; 
                                 } 
                         } 
                 } ; 
                 a p i . m i c r o t a s k D r a i n D o n e   =   ( )   = >   { 
                         w h i l e   ( _ u n c a u g h t P r o m i s e E r r o r s . l e n g t h )   { 
                                 c o n s t   u n c a u g h t P r o m i s e E r r o r   =   _ u n c a u g h t P r o m i s e E r r o r s . s h i f t ( ) ; 
                                 t r y   { 
                                         u n c a u g h t P r o m i s e E r r o r . z o n e . r u n G u a r d e d ( ( )   = >   {   t h r o w   u n c a u g h t P r o m i s e E r r o r ;   } ) ; 
                                 } 
                                 c a t c h   ( e r r o r )   { 
                                         h a n d l e U n h a n d l e d R e j e c t i o n ( e r r o r ) ; 
                                 } 
                         } 
                 } ; 
                 c o n s t   U N H A N D L E D _ P R O M I S E _ R E J E C T I O N _ H A N D L E R _ S Y M B O L   =   _ _ s y m b o l _ _ ( ' u n h a n d l e d P r o m i s e R e j e c t i o n H a n d l e r ' ) ; 
                 f u n c t i o n   h a n d l e U n h a n d l e d R e j e c t i o n ( e )   { 
                         a p i . o n U n h a n d l e d E r r o r ( e ) ; 
                         t r y   { 
                                 c o n s t   h a n d l e r   =   Z o n e [ U N H A N D L E D _ P R O M I S E _ R E J E C T I O N _ H A N D L E R _ S Y M B O L ] ; 
                                 i f   ( t y p e o f   h a n d l e r   = = =   ' f u n c t i o n ' )   { 
                                         h a n d l e r . c a l l ( t h i s ,   e ) ; 
                                 } 
                         } 
                         c a t c h   ( e r r )   { 
                         } 
                 } 
                 f u n c t i o n   i s T h e n a b l e ( v a l u e )   {   r e t u r n   v a l u e   & &   v a l u e . t h e n ;   } 
                 f u n c t i o n   f o r w a r d R e s o l u t i o n ( v a l u e )   {   r e t u r n   v a l u e ;   } 
                 f u n c t i o n   f o r w a r d R e j e c t i o n ( r e j e c t i o n )   {   r e t u r n   Z o n e A w a r e P r o m i s e . r e j e c t ( r e j e c t i o n ) ;   } 
                 c o n s t   s y m b o l S t a t e   =   _ _ s y m b o l _ _ ( ' s t a t e ' ) ; 
                 c o n s t   s y m b o l V a l u e   =   _ _ s y m b o l _ _ ( ' v a l u e ' ) ; 
                 c o n s t   s y m b o l F i n a l l y   =   _ _ s y m b o l _ _ ( ' f i n a l l y ' ) ; 
                 c o n s t   s y m b o l P a r e n t P r o m i s e V a l u e   =   _ _ s y m b o l _ _ ( ' p a r e n t P r o m i s e V a l u e ' ) ; 
                 c o n s t   s y m b o l P a r e n t P r o m i s e S t a t e   =   _ _ s y m b o l _ _ ( ' p a r e n t P r o m i s e S t a t e ' ) ; 
                 c o n s t   s o u r c e   =   ' P r o m i s e . t h e n ' ; 
                 c o n s t   U N R E S O L V E D   =   n u l l ; 
                 c o n s t   R E S O L V E D   =   t r u e ; 
                 c o n s t   R E J E C T E D   =   f a l s e ; 
                 c o n s t   R E J E C T E D _ N O _ C A T C H   =   0 ; 
                 f u n c t i o n   m a k e R e s o l v e r ( p r o m i s e ,   s t a t e )   { 
                         r e t u r n   ( v )   = >   { 
                                 t r y   { 
                                         r e s o l v e P r o m i s e ( p r o m i s e ,   s t a t e ,   v ) ; 
                                 } 
                                 c a t c h   ( e r r )   { 
                                         r e s o l v e P r o m i s e ( p r o m i s e ,   f a l s e ,   e r r ) ; 
                                 } 
                                 / /   D o   n o t   r e t u r n   v a l u e   o r   y o u   w i l l   b r e a k   t h e   P r o m i s e   s p e c . 
                         } ; 
                 } 
                 c o n s t   o n c e   =   f u n c t i o n   ( )   { 
                         l e t   w a s C a l l e d   =   f a l s e ; 
                         r e t u r n   f u n c t i o n   w r a p p e r ( w r a p p e d F u n c t i o n )   { 
                                 r e t u r n   f u n c t i o n   ( )   { 
                                         i f   ( w a s C a l l e d )   { 
                                                 r e t u r n ; 
                                         } 
                                         w a s C a l l e d   =   t r u e ; 
                                         w r a p p e d F u n c t i o n . a p p l y ( n u l l ,   a r g u m e n t s ) ; 
                                 } ; 
                         } ; 
                 } ; 
                 c o n s t   T Y P E _ E R R O R   =   ' P r o m i s e   r e s o l v e d   w i t h   i t s e l f ' ; 
                 c o n s t   C U R R E N T _ T A S K _ T R A C E _ S Y M B O L   =   _ _ s y m b o l _ _ ( ' c u r r e n t T a s k T r a c e ' ) ; 
                 / /   P r o m i s e   R e s o l u t i o n 
                 f u n c t i o n   r e s o l v e P r o m i s e ( p r o m i s e ,   s t a t e ,   v a l u e )   { 
                         c o n s t   o n c e W r a p p e r   =   o n c e ( ) ; 
                         i f   ( p r o m i s e   = = =   v a l u e )   { 
                                 t h r o w   n e w   T y p e E r r o r ( T Y P E _ E R R O R ) ; 
                         } 
                         i f   ( p r o m i s e [ s y m b o l S t a t e ]   = = =   U N R E S O L V E D )   { 
                                 / /   s h o u l d   o n l y   g e t   v a l u e . t h e n   o n c e   b a s e d   o n   p r o m i s e   s p e c . 
                                 l e t   t h e n   =   n u l l ; 
                                 t r y   { 
                                         i f   ( t y p e o f   v a l u e   = = =   ' o b j e c t '   | |   t y p e o f   v a l u e   = = =   ' f u n c t i o n ' )   { 
                                                 t h e n   =   v a l u e   & &   v a l u e . t h e n ; 
                                         } 
                                 } 
                                 c a t c h   ( e r r )   { 
                                         o n c e W r a p p e r ( ( )   = >   {   r e s o l v e P r o m i s e ( p r o m i s e ,   f a l s e ,   e r r ) ;   } ) ( ) ; 
                                         r e t u r n   p r o m i s e ; 
                                 } 
                                 / /   i f   ( v a l u e   i n s t a n c e o f   Z o n e A w a r e P r o m i s e )   { 
                                 i f   ( s t a t e   ! = =   R E J E C T E D   & &   v a l u e   i n s t a n c e o f   Z o n e A w a r e P r o m i s e   & & 
                                         v a l u e . h a s O w n P r o p e r t y ( s y m b o l S t a t e )   & &   v a l u e . h a s O w n P r o p e r t y ( s y m b o l V a l u e )   & & 
                                         v a l u e [ s y m b o l S t a t e ]   ! = =   U N R E S O L V E D )   { 
                                         c l e a r R e j e c t e d N o C a t c h ( v a l u e ) ; 
                                         r e s o l v e P r o m i s e ( p r o m i s e ,   v a l u e [ s y m b o l S t a t e ] ,   v a l u e [ s y m b o l V a l u e ] ) ; 
                                 } 
                                 e l s e   i f   ( s t a t e   ! = =   R E J E C T E D   & &   t y p e o f   t h e n   = = =   ' f u n c t i o n ' )   { 
                                         t r y   { 
                                                 t h e n . c a l l ( v a l u e ,   o n c e W r a p p e r ( m a k e R e s o l v e r ( p r o m i s e ,   s t a t e ) ) ,   o n c e W r a p p e r ( m a k e R e s o l v e r ( p r o m i s e ,   f a l s e ) ) ) ; 
                                         } 
                                         c a t c h   ( e r r )   { 
                                                 o n c e W r a p p e r ( ( )   = >   {   r e s o l v e P r o m i s e ( p r o m i s e ,   f a l s e ,   e r r ) ;   } ) ( ) ; 
                                         } 
                                 } 
                                 e l s e   { 
                                         p r o m i s e [ s y m b o l S t a t e ]   =   s t a t e ; 
                                         c o n s t   q u e u e   =   p r o m i s e [ s y m b o l V a l u e ] ; 
                                         p r o m i s e [ s y m b o l V a l u e ]   =   v a l u e ; 
                                         i f   ( p r o m i s e [ s y m b o l F i n a l l y ]   = = =   s y m b o l F i n a l l y )   { 
                                                 / /   t h e   p r o m i s e   i s   g e n e r a t e d   b y   P r o m i s e . p r o t o t y p e . f i n a l l y 
                                                 i f   ( s t a t e   = = =   R E S O L V E D )   { 
                                                         / /   t h e   s t a t e   i s   r e s o l v e d ,   s h o u l d   i g n o r e   t h e   v a l u e 
                                                         / /   a n d   u s e   p a r e n t   p r o m i s e   v a l u e 
                                                         p r o m i s e [ s y m b o l S t a t e ]   =   p r o m i s e [ s y m b o l P a r e n t P r o m i s e S t a t e ] ; 
                                                         p r o m i s e [ s y m b o l V a l u e ]   =   p r o m i s e [ s y m b o l P a r e n t P r o m i s e V a l u e ] ; 
                                                 } 
                                         } 
                                         / /   r e c o r d   t a s k   i n f o r m a t i o n   i n   v a l u e   w h e n   e r r o r   o c c u r s ,   s o   w e   c a n 
                                         / /   d o   s o m e   a d d i t i o n a l   w o r k   s u c h   a s   r e n d e r   l o n g S t a c k T r a c e 
                                         i f   ( s t a t e   = = =   R E J E C T E D   & &   v a l u e   i n s t a n c e o f   E r r o r )   { 
                                                 / /   c h e c k   i f   l o n g S t a c k T r a c e Z o n e   i s   h e r e 
                                                 c o n s t   t r a c e   =   Z o n e . c u r r e n t T a s k   & &   Z o n e . c u r r e n t T a s k . d a t a   & & 
                                                         Z o n e . c u r r e n t T a s k . d a t a [ c r e a t i o n T r a c e ] ; 
                                                 i f   ( t r a c e )   { 
                                                         / /   o n l y   k e e p   t h e   l o n g   s t a c k   t r a c e   i n t o   e r r o r   w h e n   i n   l o n g S t a c k T r a c e Z o n e 
                                                         O b j e c t D e f i n e P r o p e r t y ( v a l u e ,   C U R R E N T _ T A S K _ T R A C E _ S Y M B O L ,   {   c o n f i g u r a b l e :   t r u e ,   e n u m e r a b l e :   f a l s e ,   w r i t a b l e :   t r u e ,   v a l u e :   t r a c e   } ) ; 
                                                 } 
                                         } 
                                         f o r   ( l e t   i   =   0 ;   i   <   q u e u e . l e n g t h ; )   { 
                                                 s c h e d u l e R e s o l v e O r R e j e c t ( p r o m i s e ,   q u e u e [ i + + ] ,   q u e u e [ i + + ] ,   q u e u e [ i + + ] ,   q u e u e [ i + + ] ) ; 
                                         } 
                                         i f   ( q u e u e . l e n g t h   = =   0   & &   s t a t e   = =   R E J E C T E D )   { 
                                                 p r o m i s e [ s y m b o l S t a t e ]   =   R E J E C T E D _ N O _ C A T C H ; 
                                                 l e t   u n c a u g h t P r o m i s e E r r o r   =   v a l u e ; 
                                                 i f   ( ! i s D i s a b l e W r a p p i n g U n c a u g h t P r o m i s e R e j e c t i o n )   { 
                                                         / /   I f   d i s a b l e   w r a p p i n g   u n c a u g h t   p r o m i s e   r e j e c t 
                                                         / /   a n d   t h e   r e j e c t e d   v a l u e   i s   a n   E r r o r   o b j e c t , 
                                                         / /   u s e   t h e   v a l u e   i n s t e a d   o f   w r a p p i n g   i t . 
                                                         t r y   { 
                                                                 / /   H e r e   w e   t h r o w s   a   n e w   E r r o r   t o   p r i n t   m o r e   r e a d a b l e   e r r o r   l o g 
                                                                 / /   a n d   i f   t h e   v a l u e   i s   n o t   a n   e r r o r ,   z o n e . j s   b u i l d s   a n   ` E r r o r ` 
                                                                 / /   O b j e c t   h e r e   t o   a t t a c h   t h e   s t a c k   i n f o r m a t i o n . 
                                                                 t h r o w   n e w   E r r o r ( ' U n c a u g h t   ( i n   p r o m i s e ) :   '   +   r e a d a b l e O b j e c t T o S t r i n g ( v a l u e )   + 
                                                                         ( v a l u e   & &   v a l u e . s t a c k   ?   ' \ n '   +   v a l u e . s t a c k   :   ' ' ) ) ; 
                                                         } 
                                                         c a t c h   ( e r r )   { 
                                                                 u n c a u g h t P r o m i s e E r r o r   =   e r r ; 
                                                         } 
                                                 } 
                                                 u n c a u g h t P r o m i s e E r r o r . r e j e c t i o n   =   v a l u e ; 
                                                 u n c a u g h t P r o m i s e E r r o r . p r o m i s e   =   p r o m i s e ; 
                                                 u n c a u g h t P r o m i s e E r r o r . z o n e   =   Z o n e . c u r r e n t ; 
                                                 u n c a u g h t P r o m i s e E r r o r . t a s k   =   Z o n e . c u r r e n t T a s k ; 
                                                 _ u n c a u g h t P r o m i s e E r r o r s . p u s h ( u n c a u g h t P r o m i s e E r r o r ) ; 
                                                 a p i . s c h e d u l e M i c r o T a s k ( ) ;   / /   t o   m a k e   s u r e   t h a t   i t   i s   r u n n i n g 
                                         } 
                                 } 
                         } 
                         / /   R e s o l v i n g   a n   a l r e a d y   r e s o l v e d   p r o m i s e   i s   a   n o o p . 
                         r e t u r n   p r o m i s e ; 
                 } 
                 c o n s t   R E J E C T I O N _ H A N D L E D _ H A N D L E R   =   _ _ s y m b o l _ _ ( ' r e j e c t i o n H a n d l e d H a n d l e r ' ) ; 
                 f u n c t i o n   c l e a r R e j e c t e d N o C a t c h ( p r o m i s e )   { 
                         i f   ( p r o m i s e [ s y m b o l S t a t e ]   = = =   R E J E C T E D _ N O _ C A T C H )   { 
                                 / /   i f   t h e   p r o m i s e   i s   r e j e c t e d   n o   c a t c h   s t a t u s 
                                 / /   a n d   q u e u e . l e n g t h   >   0 ,   m e a n s   t h e r e   i s   a   e r r o r   h a n d l e r 
                                 / /   h e r e   t o   h a n d l e   t h e   r e j e c t e d   p r o m i s e ,   w e   s h o u l d   t r i g g e r 
                                 / /   w i n d o w s . r e j e c t i o n h a n d l e d   e v e n t H a n d l e r   o r   n o d e j s   r e j e c t i o n H a n d l e d 
                                 / /   e v e n t H a n d l e r 
                                 t r y   { 
                                         c o n s t   h a n d l e r   =   Z o n e [ R E J E C T I O N _ H A N D L E D _ H A N D L E R ] ; 
                                         i f   ( h a n d l e r   & &   t y p e o f   h a n d l e r   = = =   ' f u n c t i o n ' )   { 
                                                 h a n d l e r . c a l l ( t h i s ,   {   r e j e c t i o n :   p r o m i s e [ s y m b o l V a l u e ] ,   p r o m i s e :   p r o m i s e   } ) ; 
                                         } 
                                 } 
                                 c a t c h   ( e r r )   { 
                                 } 
                                 p r o m i s e [ s y m b o l S t a t e ]   =   R E J E C T E D ; 
                                 f o r   ( l e t   i   =   0 ;   i   <   _ u n c a u g h t P r o m i s e E r r o r s . l e n g t h ;   i + + )   { 
                                         i f   ( p r o m i s e   = = =   _ u n c a u g h t P r o m i s e E r r o r s [ i ] . p r o m i s e )   { 
                                                 _ u n c a u g h t P r o m i s e E r r o r s . s p l i c e ( i ,   1 ) ; 
                                         } 
                                 } 
                         } 
                 } 
                 f u n c t i o n   s c h e d u l e R e s o l v e O r R e j e c t ( p r o m i s e ,   z o n e ,   c h a i n P r o m i s e ,   o n F u l f i l l e d ,   o n R e j e c t e d )   { 
                         c l e a r R e j e c t e d N o C a t c h ( p r o m i s e ) ; 
                         c o n s t   p r o m i s e S t a t e   =   p r o m i s e [ s y m b o l S t a t e ] ; 
                         c o n s t   d e l e g a t e   =   p r o m i s e S t a t e   ? 
                                 ( t y p e o f   o n F u l f i l l e d   = = =   ' f u n c t i o n ' )   ?   o n F u l f i l l e d   :   f o r w a r d R e s o l u t i o n   : 
                                 ( t y p e o f   o n R e j e c t e d   = = =   ' f u n c t i o n ' )   ?   o n R e j e c t e d   :   f o r w a r d R e j e c t i o n ; 
                         z o n e . s c h e d u l e M i c r o T a s k ( s o u r c e ,   ( )   = >   { 
                                 t r y   { 
                                         c o n s t   p a r e n t P r o m i s e V a l u e   =   p r o m i s e [ s y m b o l V a l u e ] ; 
                                         c o n s t   i s F i n a l l y P r o m i s e   =   ! ! c h a i n P r o m i s e   & &   s y m b o l F i n a l l y   = = =   c h a i n P r o m i s e [ s y m b o l F i n a l l y ] ; 
                                         i f   ( i s F i n a l l y P r o m i s e )   { 
                                                 / /   i f   t h e   p r o m i s e   i s   g e n e r a t e d   f r o m   f i n a l l y   c a l l ,   k e e p   p a r e n t   p r o m i s e ' s   s t a t e   a n d   v a l u e 
                                                 c h a i n P r o m i s e [ s y m b o l P a r e n t P r o m i s e V a l u e ]   =   p a r e n t P r o m i s e V a l u e ; 
                                                 c h a i n P r o m i s e [ s y m b o l P a r e n t P r o m i s e S t a t e ]   =   p r o m i s e S t a t e ; 
                                         } 
                                         / /   s h o u l d   n o t   p a s s   v a l u e   t o   f i n a l l y   c a l l b a c k 
                                         c o n s t   v a l u e   =   z o n e . r u n ( d e l e g a t e ,   u n d e f i n e d ,   i s F i n a l l y P r o m i s e   & &   d e l e g a t e   ! = =   f o r w a r d R e j e c t i o n   & &   d e l e g a t e   ! = =   f o r w a r d R e s o l u t i o n   ? 
                                                 [ ]   : 
                                                 [ p a r e n t P r o m i s e V a l u e ] ) ; 
                                         r e s o l v e P r o m i s e ( c h a i n P r o m i s e ,   t r u e ,   v a l u e ) ; 
                                 } 
                                 c a t c h   ( e r r o r )   { 
                                         / /   i f   e r r o r   o c c u r s ,   s h o u l d   a l w a y s   r e t u r n   t h i s   e r r o r 
                                         r e s o l v e P r o m i s e ( c h a i n P r o m i s e ,   f a l s e ,   e r r o r ) ; 
                                 } 
                         } ,   c h a i n P r o m i s e ) ; 
                 } 
                 c o n s t   Z O N E _ A W A R E _ P R O M I S E _ T O _ S T R I N G   =   ' f u n c t i o n   Z o n e A w a r e P r o m i s e ( )   {   [ n a t i v e   c o d e ]   } ' ; 
                 c o n s t   n o o p   =   f u n c t i o n   ( )   {   } ; 
                 c l a s s   Z o n e A w a r e P r o m i s e   { 
                         s t a t i c   t o S t r i n g ( )   {   r e t u r n   Z O N E _ A W A R E _ P R O M I S E _ T O _ S T R I N G ;   } 
                         s t a t i c   r e s o l v e ( v a l u e )   { 
                                 r e t u r n   r e s o l v e P r o m i s e ( n e w   t h i s ( n u l l ) ,   R E S O L V E D ,   v a l u e ) ; 
                         } 
                         s t a t i c   r e j e c t ( e r r o r )   { 
                                 r e t u r n   r e s o l v e P r o m i s e ( n e w   t h i s ( n u l l ) ,   R E J E C T E D ,   e r r o r ) ; 
                         } 
                         s t a t i c   r a c e ( v a l u e s )   { 
                                 l e t   r e s o l v e ; 
                                 l e t   r e j e c t ; 
                                 l e t   p r o m i s e   =   n e w   t h i s ( ( r e s ,   r e j )   = >   { 
                                         r e s o l v e   =   r e s ; 
                                         r e j e c t   =   r e j ; 
                                 } ) ; 
                                 f u n c t i o n   o n R e s o l v e ( v a l u e )   {   r e s o l v e ( v a l u e ) ;   } 
                                 f u n c t i o n   o n R e j e c t ( e r r o r )   {   r e j e c t ( e r r o r ) ;   } 
                                 f o r   ( l e t   v a l u e   o f   v a l u e s )   { 
                                         i f   ( ! i s T h e n a b l e ( v a l u e ) )   { 
                                                 v a l u e   =   t h i s . r e s o l v e ( v a l u e ) ; 
                                         } 
                                         v a l u e . t h e n ( o n R e s o l v e ,   o n R e j e c t ) ; 
                                 } 
                                 r e t u r n   p r o m i s e ; 
                         } 
                         s t a t i c   a l l ( v a l u e s )   {   r e t u r n   Z o n e A w a r e P r o m i s e . a l l W i t h C a l l b a c k ( v a l u e s ) ;   } 
                         s t a t i c   a l l S e t t l e d ( v a l u e s )   { 
                                 c o n s t   P   =   t h i s   & &   t h i s . p r o t o t y p e   i n s t a n c e o f   Z o n e A w a r e P r o m i s e   ?   t h i s   :   Z o n e A w a r e P r o m i s e ; 
                                 r e t u r n   P . a l l W i t h C a l l b a c k ( v a l u e s ,   { 
                                         t h e n C a l l b a c k :   ( v a l u e )   = >   ( {   s t a t u s :   ' f u l f i l l e d ' ,   v a l u e   } ) , 
                                         e r r o r C a l l b a c k :   ( e r r )   = >   ( {   s t a t u s :   ' r e j e c t e d ' ,   r e a s o n :   e r r   } ) 
                                 } ) ; 
                         } 
                         s t a t i c   a l l W i t h C a l l b a c k ( v a l u e s ,   c a l l b a c k )   { 
                                 l e t   r e s o l v e ; 
                                 l e t   r e j e c t ; 
                                 l e t   p r o m i s e   =   n e w   t h i s ( ( r e s ,   r e j )   = >   { 
                                         r e s o l v e   =   r e s ; 
                                         r e j e c t   =   r e j ; 
                                 } ) ; 
                                 / /   S t a r t   a t   2   t o   p r e v e n t   p r e m a t u r e l y   r e s o l v i n g   i f   . t h e n   i s   c a l l e d   i m m e d i a t e l y . 
                                 l e t   u n r e s o l v e d C o u n t   =   2 ; 
                                 l e t   v a l u e I n d e x   =   0 ; 
                                 c o n s t   r e s o l v e d V a l u e s   =   [ ] ; 
                                 f o r   ( l e t   v a l u e   o f   v a l u e s )   { 
                                         i f   ( ! i s T h e n a b l e ( v a l u e ) )   { 
                                                 v a l u e   =   t h i s . r e s o l v e ( v a l u e ) ; 
                                         } 
                                         c o n s t   c u r V a l u e I n d e x   =   v a l u e I n d e x ; 
                                         t r y   { 
                                                 v a l u e . t h e n ( ( v a l u e )   = >   { 
                                                         r e s o l v e d V a l u e s [ c u r V a l u e I n d e x ]   =   c a l l b a c k   ?   c a l l b a c k . t h e n C a l l b a c k ( v a l u e )   :   v a l u e ; 
                                                         u n r e s o l v e d C o u n t - - ; 
                                                         i f   ( u n r e s o l v e d C o u n t   = = =   0 )   { 
                                                                 r e s o l v e ( r e s o l v e d V a l u e s ) ; 
                                                         } 
                                                 } ,   ( e r r )   = >   { 
                                                         i f   ( ! c a l l b a c k )   { 
                                                                 r e j e c t ( e r r ) ; 
                                                         } 
                                                         e l s e   { 
                                                                 r e s o l v e d V a l u e s [ c u r V a l u e I n d e x ]   =   c a l l b a c k . e r r o r C a l l b a c k ( e r r ) ; 
                                                                 u n r e s o l v e d C o u n t - - ; 
                                                                 i f   ( u n r e s o l v e d C o u n t   = = =   0 )   { 
                                                                         r e s o l v e ( r e s o l v e d V a l u e s ) ; 
                                                                 } 
                                                         } 
                                                 } ) ; 
                                         } 
                                         c a t c h   ( t h e n E r r )   { 
                                                 r e j e c t ( t h e n E r r ) ; 
                                         } 
                                         u n r e s o l v e d C o u n t + + ; 
                                         v a l u e I n d e x + + ; 
                                 } 
                                 / /   M a k e   t h e   u n r e s o l v e d C o u n t   z e r o - b a s e d   a g a i n . 
                                 u n r e s o l v e d C o u n t   - =   2 ; 
                                 i f   ( u n r e s o l v e d C o u n t   = = =   0 )   { 
                                         r e s o l v e ( r e s o l v e d V a l u e s ) ; 
                                 } 
                                 r e t u r n   p r o m i s e ; 
                         } 
                         c o n s t r u c t o r ( e x e c u t o r )   { 
                                 c o n s t   p r o m i s e   =   t h i s ; 
                                 i f   ( ! ( p r o m i s e   i n s t a n c e o f   Z o n e A w a r e P r o m i s e ) )   { 
                                         t h r o w   n e w   E r r o r ( ' M u s t   b e   a n   i n s t a n c e o f   P r o m i s e . ' ) ; 
                                 } 
                                 p r o m i s e [ s y m b o l S t a t e ]   =   U N R E S O L V E D ; 
                                 p r o m i s e [ s y m b o l V a l u e ]   =   [ ] ;   / /   q u e u e ; 
                                 t r y   { 
                                         e x e c u t o r   & &   e x e c u t o r ( m a k e R e s o l v e r ( p r o m i s e ,   R E S O L V E D ) ,   m a k e R e s o l v e r ( p r o m i s e ,   R E J E C T E D ) ) ; 
                                 } 
                                 c a t c h   ( e r r o r )   { 
                                         r e s o l v e P r o m i s e ( p r o m i s e ,   f a l s e ,   e r r o r ) ; 
                                 } 
                         } 
                         g e t   [ S y m b o l . t o S t r i n g T a g ] ( )   {   r e t u r n   ' P r o m i s e ' ;   } 
                         g e t   [ S y m b o l . s p e c i e s ] ( )   {   r e t u r n   Z o n e A w a r e P r o m i s e ;   } 
                         t h e n ( o n F u l f i l l e d ,   o n R e j e c t e d )   { 
                                 l e t   C   =   t h i s . c o n s t r u c t o r [ S y m b o l . s p e c i e s ] ; 
                                 i f   ( ! C   | |   t y p e o f   C   ! = =   ' f u n c t i o n ' )   { 
                                         C   =   t h i s . c o n s t r u c t o r   | |   Z o n e A w a r e P r o m i s e ; 
                                 } 
                                 c o n s t   c h a i n P r o m i s e   =   n e w   C ( n o o p ) ; 
                                 c o n s t   z o n e   =   Z o n e . c u r r e n t ; 
                                 i f   ( t h i s [ s y m b o l S t a t e ]   = =   U N R E S O L V E D )   { 
                                         t h i s [ s y m b o l V a l u e ] . p u s h ( z o n e ,   c h a i n P r o m i s e ,   o n F u l f i l l e d ,   o n R e j e c t e d ) ; 
                                 } 
                                 e l s e   { 
                                         s c h e d u l e R e s o l v e O r R e j e c t ( t h i s ,   z o n e ,   c h a i n P r o m i s e ,   o n F u l f i l l e d ,   o n R e j e c t e d ) ; 
                                 } 
                                 r e t u r n   c h a i n P r o m i s e ; 
                         } 
                         c a t c h ( o n R e j e c t e d )   { 
                                 r e t u r n   t h i s . t h e n ( n u l l ,   o n R e j e c t e d ) ; 
                         } 
                         f i n a l l y ( o n F i n a l l y )   { 
                                 l e t   C   =   t h i s . c o n s t r u c t o r [ S y m b o l . s p e c i e s ] ; 
                                 i f   ( ! C   | |   t y p e o f   C   ! = =   ' f u n c t i o n ' )   { 
                                         C   =   Z o n e A w a r e P r o m i s e ; 
                                 } 
                                 c o n s t   c h a i n P r o m i s e   =   n e w   C ( n o o p ) ; 
                                 c h a i n P r o m i s e [ s y m b o l F i n a l l y ]   =   s y m b o l F i n a l l y ; 
                                 c o n s t   z o n e   =   Z o n e . c u r r e n t ; 
                                 i f   ( t h i s [ s y m b o l S t a t e ]   = =   U N R E S O L V E D )   { 
                                         t h i s [ s y m b o l V a l u e ] . p u s h ( z o n e ,   c h a i n P r o m i s e ,   o n F i n a l l y ,   o n F i n a l l y ) ; 
                                 } 
                                 e l s e   { 
                                         s c h e d u l e R e s o l v e O r R e j e c t ( t h i s ,   z o n e ,   c h a i n P r o m i s e ,   o n F i n a l l y ,   o n F i n a l l y ) ; 
                                 } 
                                 r e t u r n   c h a i n P r o m i s e ; 
                         } 
                 } 
                 / /   P r o t e c t   a g a i n s t   a g g r e s s i v e   o p t i m i z e r s   d r o p p i n g   s e e m i n g l y   u n u s e d   p r o p e r t i e s . 
                 / /   E . g .   C l o s u r e   C o m p i l e r   i n   a d v a n c e d   m o d e . 
                 Z o n e A w a r e P r o m i s e [ ' r e s o l v e ' ]   =   Z o n e A w a r e P r o m i s e . r e s o l v e ; 
                 Z o n e A w a r e P r o m i s e [ ' r e j e c t ' ]   =   Z o n e A w a r e P r o m i s e . r e j e c t ; 
                 Z o n e A w a r e P r o m i s e [ ' r a c e ' ]   =   Z o n e A w a r e P r o m i s e . r a c e ; 
                 Z o n e A w a r e P r o m i s e [ ' a l l ' ]   =   Z o n e A w a r e P r o m i s e . a l l ; 
                 c o n s t   N a t i v e P r o m i s e   =   g l o b a l [ s y m b o l P r o m i s e ]   =   g l o b a l [ ' P r o m i s e ' ] ; 
                 c o n s t   Z O N E _ A W A R E _ P R O M I S E   =   Z o n e . _ _ s y m b o l _ _ ( ' Z o n e A w a r e P r o m i s e ' ) ; 
                 l e t   d e s c   =   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r ( g l o b a l ,   ' P r o m i s e ' ) ; 
                 i f   ( ! d e s c   | |   d e s c . c o n f i g u r a b l e )   { 
                         d e s c   & &   d e l e t e   d e s c . w r i t a b l e ; 
                         d e s c   & &   d e l e t e   d e s c . v a l u e ; 
                         i f   ( ! d e s c )   { 
                                 d e s c   =   {   c o n f i g u r a b l e :   t r u e ,   e n u m e r a b l e :   t r u e   } ; 
                         } 
                         d e s c . g e t   =   f u n c t i o n   ( )   { 
                                 / /   i f   w e   a l r e a d y   s e t   Z o n e A w a r e P r o m i s e ,   u s e   p a t c h e d   o n e 
                                 / /   o t h e r w i s e   r e t u r n   n a t i v e   o n e . 
                                 r e t u r n   g l o b a l [ Z O N E _ A W A R E _ P R O M I S E ]   ?   g l o b a l [ Z O N E _ A W A R E _ P R O M I S E ]   :   g l o b a l [ s y m b o l P r o m i s e ] ; 
                         } ; 
                         d e s c . s e t   =   f u n c t i o n   ( N e w N a t i v e P r o m i s e )   { 
                                 i f   ( N e w N a t i v e P r o m i s e   = = =   Z o n e A w a r e P r o m i s e )   { 
                                         / /   i f   t h e   N e w N a t i v e P r o m i s e   i s   Z o n e A w a r e P r o m i s e 
                                         / /   s a v e   t o   g l o b a l 
                                         g l o b a l [ Z O N E _ A W A R E _ P R O M I S E ]   =   N e w N a t i v e P r o m i s e ; 
                                 } 
                                 e l s e   { 
                                         / /   i f   t h e   N e w N a t i v e P r o m i s e   i s   n o t   Z o n e A w a r e P r o m i s e 
                                         / /   f o r   e x a m p l e :   a f t e r   l o a d   z o n e . j s ,   s o m e   l i b r a r y   j u s t 
                                         / /   s e t   e s 6 - p r o m i s e   t o   g l o b a l ,   i f   w e   s e t   i t   t o   g l o b a l 
                                         / /   d i r e c t l y ,   a s s e r t Z o n e P a t c h e d   w i l l   f a i l   a n d   a n g u l a r 
                                         / /   w i l l   n o t   l o a d e d ,   s o   w e   j u s t   s e t   t h e   N e w N a t i v e P r o m i s e 
                                         / /   t o   g l o b a l [ s y m b o l P r o m i s e ] ,   s o   t h e   r e s u l t   i s   j u s t   l i k e 
                                         / /   w e   l o a d   E S 6   P r o m i s e   b e f o r e   z o n e . j s 
                                         g l o b a l [ s y m b o l P r o m i s e ]   =   N e w N a t i v e P r o m i s e ; 
                                         i f   ( ! N e w N a t i v e P r o m i s e . p r o t o t y p e [ s y m b o l T h e n ] )   { 
                                                 p a t c h T h e n ( N e w N a t i v e P r o m i s e ) ; 
                                         } 
                                         a p i . s e t N a t i v e P r o m i s e ( N e w N a t i v e P r o m i s e ) ; 
                                 } 
                         } ; 
                         O b j e c t D e f i n e P r o p e r t y ( g l o b a l ,   ' P r o m i s e ' ,   d e s c ) ; 
                 } 
                 g l o b a l [ ' P r o m i s e ' ]   =   Z o n e A w a r e P r o m i s e ; 
                 c o n s t   s y m b o l T h e n P a t c h e d   =   _ _ s y m b o l _ _ ( ' t h e n P a t c h e d ' ) ; 
                 f u n c t i o n   p a t c h T h e n ( C t o r )   { 
                         c o n s t   p r o t o   =   C t o r . p r o t o t y p e ; 
                         c o n s t   p r o p   =   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r ( p r o t o ,   ' t h e n ' ) ; 
                         i f   ( p r o p   & &   ( p r o p . w r i t a b l e   = = =   f a l s e   | |   ! p r o p . c o n f i g u r a b l e ) )   { 
                                 / /   c h e c k   C t o r . p r o t o t y p e . t h e n   p r o p e r t y D e s c r i p t o r   i s   w r i t a b l e   o r   n o t 
                                 / /   i n   m e t e o r   e n v ,   w r i t a b l e   i s   f a l s e ,   w e   s h o u l d   i g n o r e   s u c h   c a s e 
                                 r e t u r n ; 
                         } 
                         c o n s t   o r i g i n a l T h e n   =   p r o t o . t h e n ; 
                         / /   K e e p   a   r e f e r e n c e   t o   t h e   o r i g i n a l   m e t h o d . 
                         p r o t o [ s y m b o l T h e n ]   =   o r i g i n a l T h e n ; 
                         C t o r . p r o t o t y p e . t h e n   =   f u n c t i o n   ( o n R e s o l v e ,   o n R e j e c t )   { 
                                 c o n s t   w r a p p e d   =   n e w   Z o n e A w a r e P r o m i s e ( ( r e s o l v e ,   r e j e c t )   = >   {   o r i g i n a l T h e n . c a l l ( t h i s ,   r e s o l v e ,   r e j e c t ) ;   } ) ; 
                                 r e t u r n   w r a p p e d . t h e n ( o n R e s o l v e ,   o n R e j e c t ) ; 
                         } ; 
                         C t o r [ s y m b o l T h e n P a t c h e d ]   =   t r u e ; 
                 } 
                 a p i . p a t c h T h e n   =   p a t c h T h e n ; 
                 f u n c t i o n   z o n e i f y ( f n )   { 
                         r e t u r n   f u n c t i o n   ( )   { 
                                 l e t   r e s u l t P r o m i s e   =   f n . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                                 i f   ( r e s u l t P r o m i s e   i n s t a n c e o f   Z o n e A w a r e P r o m i s e )   { 
                                         r e t u r n   r e s u l t P r o m i s e ; 
                                 } 
                                 l e t   c t o r   =   r e s u l t P r o m i s e . c o n s t r u c t o r ; 
                                 i f   ( ! c t o r [ s y m b o l T h e n P a t c h e d ] )   { 
                                         p a t c h T h e n ( c t o r ) ; 
                                 } 
                                 r e t u r n   r e s u l t P r o m i s e ; 
                         } ; 
                 } 
                 i f   ( N a t i v e P r o m i s e )   { 
                         p a t c h T h e n ( N a t i v e P r o m i s e ) ; 
                         c o n s t   f e t c h   =   g l o b a l [ ' f e t c h ' ] ; 
                         i f   ( t y p e o f   f e t c h   = =   ' f u n c t i o n ' )   { 
                                 g l o b a l [ a p i . s y m b o l ( ' f e t c h ' ) ]   =   f e t c h ; 
                                 g l o b a l [ ' f e t c h ' ]   =   z o n e i f y ( f e t c h ) ; 
                         } 
                 } 
                 / /   T h i s   i s   n o t   p a r t   o f   p u b l i c   A P I ,   b u t   i t   i s   u s e f u l   f o r   t e s t s ,   s o   w e   e x p o s e   i t . 
                 P r o m i s e [ Z o n e . _ _ s y m b o l _ _ ( ' u n c a u g h t P r o m i s e E r r o r s ' ) ]   =   _ u n c a u g h t P r o m i s e E r r o r s ; 
                 r e t u r n   Z o n e A w a r e P r o m i s e ; 
         } ) ; 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         / * * 
           *   S u p p r e s s   c l o s u r e   c o m p i l e r   e r r o r s   a b o u t   u n k n o w n   ' Z o n e '   v a r i a b l e 
           *   @ f i l e o v e r v i e w 
           *   @ s u p p r e s s   { u n d e f i n e d V a r s , g l o b a l T h i s , m i s s i n g R e q u i r e } 
           * / 
         / / /   < r e f e r e n c e   t y p e s = " n o d e " / > 
         / /   i s s u e   # 9 8 9 ,   t o   r e d u c e   b u n d l e   s i z e ,   u s e   s h o r t   n a m e 
         / * *   O b j e c t . g e t O w n P r o p e r t y D e s c r i p t o r   * / 
         c o n s t   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r   =   O b j e c t . g e t O w n P r o p e r t y D e s c r i p t o r ; 
         / * *   O b j e c t . d e f i n e P r o p e r t y   * / 
         c o n s t   O b j e c t D e f i n e P r o p e r t y   =   O b j e c t . d e f i n e P r o p e r t y ; 
         / * *   O b j e c t . g e t P r o t o t y p e O f   * / 
         c o n s t   O b j e c t G e t P r o t o t y p e O f   =   O b j e c t . g e t P r o t o t y p e O f ; 
         / * *   O b j e c t . c r e a t e   * / 
         c o n s t   O b j e c t C r e a t e   =   O b j e c t . c r e a t e ; 
         / * *   A r r a y . p r o t o t y p e . s l i c e   * / 
         c o n s t   A r r a y S l i c e   =   A r r a y . p r o t o t y p e . s l i c e ; 
         / * *   a d d E v e n t L i s t e n e r   s t r i n g   c o n s t   * / 
         c o n s t   A D D _ E V E N T _ L I S T E N E R _ S T R   =   ' a d d E v e n t L i s t e n e r ' ; 
         / * *   r e m o v e E v e n t L i s t e n e r   s t r i n g   c o n s t   * / 
         c o n s t   R E M O V E _ E V E N T _ L I S T E N E R _ S T R   =   ' r e m o v e E v e n t L i s t e n e r ' ; 
         / * *   z o n e S y m b o l   a d d E v e n t L i s t e n e r   * / 
         c o n s t   Z O N E _ S Y M B O L _ A D D _ E V E N T _ L I S T E N E R   =   Z o n e . _ _ s y m b o l _ _ ( A D D _ E V E N T _ L I S T E N E R _ S T R ) ; 
         / * *   z o n e S y m b o l   r e m o v e E v e n t L i s t e n e r   * / 
         c o n s t   Z O N E _ S Y M B O L _ R E M O V E _ E V E N T _ L I S T E N E R   =   Z o n e . _ _ s y m b o l _ _ ( R E M O V E _ E V E N T _ L I S T E N E R _ S T R ) ; 
         / * *   t r u e   s t r i n g   c o n s t   * / 
         c o n s t   T R U E _ S T R   =   ' t r u e ' ; 
         / * *   f a l s e   s t r i n g   c o n s t   * / 
         c o n s t   F A L S E _ S T R   =   ' f a l s e ' ; 
         / * *   Z o n e   s y m b o l   p r e f i x   s t r i n g   c o n s t .   * / 
         c o n s t   Z O N E _ S Y M B O L _ P R E F I X   =   Z o n e . _ _ s y m b o l _ _ ( ' ' ) ; 
         f u n c t i o n   w r a p W i t h C u r r e n t Z o n e ( c a l l b a c k ,   s o u r c e )   { 
                 r e t u r n   Z o n e . c u r r e n t . w r a p ( c a l l b a c k ,   s o u r c e ) ; 
         } 
         f u n c t i o n   s c h e d u l e M a c r o T a s k W i t h C u r r e n t Z o n e ( s o u r c e ,   c a l l b a c k ,   d a t a ,   c u s t o m S c h e d u l e ,   c u s t o m C a n c e l )   { 
                 r e t u r n   Z o n e . c u r r e n t . s c h e d u l e M a c r o T a s k ( s o u r c e ,   c a l l b a c k ,   d a t a ,   c u s t o m S c h e d u l e ,   c u s t o m C a n c e l ) ; 
         } 
         c o n s t   z o n e S y m b o l   =   Z o n e . _ _ s y m b o l _ _ ; 
         c o n s t   i s W i n d o w E x i s t s   =   t y p e o f   w i n d o w   ! = =   ' u n d e f i n e d ' ; 
         c o n s t   i n t e r n a l W i n d o w   =   i s W i n d o w E x i s t s   ?   w i n d o w   :   u n d e f i n e d ; 
         c o n s t   _ g l o b a l   =   i s W i n d o w E x i s t s   & &   i n t e r n a l W i n d o w   | |   t y p e o f   s e l f   = = =   ' o b j e c t '   & &   s e l f   | |   g l o b a l ; 
         c o n s t   R E M O V E _ A T T R I B U T E   =   ' r e m o v e A t t r i b u t e ' ; 
         c o n s t   N U L L _ O N _ P R O P _ V A L U E   =   [ n u l l ] ; 
         f u n c t i o n   b i n d A r g u m e n t s ( a r g s ,   s o u r c e )   { 
                 f o r   ( l e t   i   =   a r g s . l e n g t h   -   1 ;   i   > =   0 ;   i - - )   { 
                         i f   ( t y p e o f   a r g s [ i ]   = = =   ' f u n c t i o n ' )   { 
                                 a r g s [ i ]   =   w r a p W i t h C u r r e n t Z o n e ( a r g s [ i ] ,   s o u r c e   +   ' _ '   +   i ) ; 
                         } 
                 } 
                 r e t u r n   a r g s ; 
         } 
         f u n c t i o n   p a t c h P r o t o t y p e ( p r o t o t y p e ,   f n N a m e s )   { 
                 c o n s t   s o u r c e   =   p r o t o t y p e . c o n s t r u c t o r [ ' n a m e ' ] ; 
                 f o r   ( l e t   i   =   0 ;   i   <   f n N a m e s . l e n g t h ;   i + + )   { 
                         c o n s t   n a m e   =   f n N a m e s [ i ] ; 
                         c o n s t   d e l e g a t e   =   p r o t o t y p e [ n a m e ] ; 
                         i f   ( d e l e g a t e )   { 
                                 c o n s t   p r o t o t y p e D e s c   =   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r ( p r o t o t y p e ,   n a m e ) ; 
                                 i f   ( ! i s P r o p e r t y W r i t a b l e ( p r o t o t y p e D e s c ) )   { 
                                         c o n t i n u e ; 
                                 } 
                                 p r o t o t y p e [ n a m e ]   =   ( ( d e l e g a t e )   = >   { 
                                         c o n s t   p a t c h e d   =   f u n c t i o n   ( )   { 
                                                 r e t u r n   d e l e g a t e . a p p l y ( t h i s ,   b i n d A r g u m e n t s ( a r g u m e n t s ,   s o u r c e   +   ' . '   +   n a m e ) ) ; 
                                         } ; 
                                         a t t a c h O r i g i n T o P a t c h e d ( p a t c h e d ,   d e l e g a t e ) ; 
                                         r e t u r n   p a t c h e d ; 
                                 } ) ( d e l e g a t e ) ; 
                         } 
                 } 
         } 
         f u n c t i o n   i s P r o p e r t y W r i t a b l e ( p r o p e r t y D e s c )   { 
                 i f   ( ! p r o p e r t y D e s c )   { 
                         r e t u r n   t r u e ; 
                 } 
                 i f   ( p r o p e r t y D e s c . w r i t a b l e   = = =   f a l s e )   { 
                         r e t u r n   f a l s e ; 
                 } 
                 r e t u r n   ! ( t y p e o f   p r o p e r t y D e s c . g e t   = = =   ' f u n c t i o n '   & &   t y p e o f   p r o p e r t y D e s c . s e t   = = =   ' u n d e f i n e d ' ) ; 
         } 
         c o n s t   i s W e b W o r k e r   =   ( t y p e o f   W o r k e r G l o b a l S c o p e   ! = =   ' u n d e f i n e d '   & &   s e l f   i n s t a n c e o f   W o r k e r G l o b a l S c o p e ) ; 
         / /   M a k e   s u r e   t o   a c c e s s   ` p r o c e s s `   t h r o u g h   ` _ g l o b a l `   s o   t h a t   W e b P a c k   d o e s   n o t   a c c i d e n t a l l y   b r o w s e r i f y 
         / /   t h i s   c o d e . 
         c o n s t   i s N o d e   =   ( ! ( ' n w '   i n   _ g l o b a l )   & &   t y p e o f   _ g l o b a l . p r o c e s s   ! = =   ' u n d e f i n e d '   & & 
                 { } . t o S t r i n g . c a l l ( _ g l o b a l . p r o c e s s )   = = =   ' [ o b j e c t   p r o c e s s ] ' ) ; 
         c o n s t   i s B r o w s e r   =   ! i s N o d e   & &   ! i s W e b W o r k e r   & &   ! ! ( i s W i n d o w E x i s t s   & &   i n t e r n a l W i n d o w [ ' H T M L E l e m e n t ' ] ) ; 
         / /   w e   a r e   i n   e l e c t r o n   o f   n w ,   s o   w e   a r e   b o t h   b r o w s e r   a n d   n o d e j s 
         / /   M a k e   s u r e   t o   a c c e s s   ` p r o c e s s `   t h r o u g h   ` _ g l o b a l `   s o   t h a t   W e b P a c k   d o e s   n o t   a c c i d e n t a l l y   b r o w s e r i f y 
         / /   t h i s   c o d e . 
         c o n s t   i s M i x   =   t y p e o f   _ g l o b a l . p r o c e s s   ! = =   ' u n d e f i n e d '   & & 
                 { } . t o S t r i n g . c a l l ( _ g l o b a l . p r o c e s s )   = = =   ' [ o b j e c t   p r o c e s s ] '   & &   ! i s W e b W o r k e r   & & 
                 ! ! ( i s W i n d o w E x i s t s   & &   i n t e r n a l W i n d o w [ ' H T M L E l e m e n t ' ] ) ; 
         c o n s t   z o n e S y m b o l E v e n t N a m e s   =   { } ; 
         c o n s t   w r a p F n   =   f u n c t i o n   ( e v e n t )   { 
                 / /   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 9 1 1 ,   i n   I E ,   s o m e t i m e s 
                 / /   e v e n t   w i l l   b e   u n d e f i n e d ,   s o   w e   n e e d   t o   u s e   w i n d o w . e v e n t 
                 e v e n t   =   e v e n t   | |   _ g l o b a l . e v e n t ; 
                 i f   ( ! e v e n t )   { 
                         r e t u r n ; 
                 } 
                 l e t   e v e n t N a m e S y m b o l   =   z o n e S y m b o l E v e n t N a m e s [ e v e n t . t y p e ] ; 
                 i f   ( ! e v e n t N a m e S y m b o l )   { 
                         e v e n t N a m e S y m b o l   =   z o n e S y m b o l E v e n t N a m e s [ e v e n t . t y p e ]   =   z o n e S y m b o l ( ' O N _ P R O P E R T Y '   +   e v e n t . t y p e ) ; 
                 } 
                 c o n s t   t a r g e t   =   t h i s   | |   e v e n t . t a r g e t   | |   _ g l o b a l ; 
                 c o n s t   l i s t e n e r   =   t a r g e t [ e v e n t N a m e S y m b o l ] ; 
                 l e t   r e s u l t ; 
                 i f   ( i s B r o w s e r   & &   t a r g e t   = = =   i n t e r n a l W i n d o w   & &   e v e n t . t y p e   = = =   ' e r r o r ' )   { 
                         / /   w i n d o w . o n e r r o r   h a v e   d i f f e r e n t   s i g n i t u r e 
                         / /   h t t p s : / / d e v e l o p e r . m o z i l l a . o r g / e n - U S / d o c s / W e b / A P I / G l o b a l E v e n t H a n d l e r s / o n e r r o r # w i n d o w . o n e r r o r 
                         / /   a n d   o n e r r o r   c a l l b a c k   w i l l   p r e v e n t   d e f a u l t   w h e n   c a l l b a c k   r e t u r n   t r u e 
                         c o n s t   e r r o r E v e n t   =   e v e n t ; 
                         r e s u l t   =   l i s t e n e r   & & 
                                 l i s t e n e r . c a l l ( t h i s ,   e r r o r E v e n t . m e s s a g e ,   e r r o r E v e n t . f i l e n a m e ,   e r r o r E v e n t . l i n e n o ,   e r r o r E v e n t . c o l n o ,   e r r o r E v e n t . e r r o r ) ; 
                         i f   ( r e s u l t   = = =   t r u e )   { 
                                 e v e n t . p r e v e n t D e f a u l t ( ) ; 
                         } 
                 } 
                 e l s e   { 
                         r e s u l t   =   l i s t e n e r   & &   l i s t e n e r . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                         i f   ( r e s u l t   ! =   u n d e f i n e d   & &   ! r e s u l t )   { 
                                 e v e n t . p r e v e n t D e f a u l t ( ) ; 
                         } 
                 } 
                 r e t u r n   r e s u l t ; 
         } ; 
         f u n c t i o n   p a t c h P r o p e r t y ( o b j ,   p r o p ,   p r o t o t y p e )   { 
                 l e t   d e s c   =   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r ( o b j ,   p r o p ) ; 
                 i f   ( ! d e s c   & &   p r o t o t y p e )   { 
                         / /   w h e n   p a t c h   w i n d o w   o b j e c t ,   u s e   p r o t o t y p e   t o   c h e c k   p r o p   e x i s t   o r   n o t 
                         c o n s t   p r o t o t y p e D e s c   =   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r ( p r o t o t y p e ,   p r o p ) ; 
                         i f   ( p r o t o t y p e D e s c )   { 
                                 d e s c   =   {   e n u m e r a b l e :   t r u e ,   c o n f i g u r a b l e :   t r u e   } ; 
                         } 
                 } 
                 / /   i f   t h e   d e s c r i p t o r   n o t   e x i s t s   o r   i s   n o t   c o n f i g u r a b l e 
                 / /   j u s t   r e t u r n 
                 i f   ( ! d e s c   | |   ! d e s c . c o n f i g u r a b l e )   { 
                         r e t u r n ; 
                 } 
                 c o n s t   o n P r o p P a t c h e d S y m b o l   =   z o n e S y m b o l ( ' o n '   +   p r o p   +   ' p a t c h e d ' ) ; 
                 i f   ( o b j . h a s O w n P r o p e r t y ( o n P r o p P a t c h e d S y m b o l )   & &   o b j [ o n P r o p P a t c h e d S y m b o l ] )   { 
                         r e t u r n ; 
                 } 
                 / /   A   p r o p e r t y   d e s c r i p t o r   c a n n o t   h a v e   g e t t e r / s e t t e r   a n d   b e   w r i t a b l e 
                 / /   d e l e t i n g   t h e   w r i t a b l e   a n d   v a l u e   p r o p e r t i e s   a v o i d s   t h i s   e r r o r : 
                 / / 
                 / /   T y p e E r r o r :   p r o p e r t y   d e s c r i p t o r s   m u s t   n o t   s p e c i f y   a   v a l u e   o r   b e   w r i t a b l e   w h e n   a 
                 / /   g e t t e r   o r   s e t t e r   h a s   b e e n   s p e c i f i e d 
                 d e l e t e   d e s c . w r i t a b l e ; 
                 d e l e t e   d e s c . v a l u e ; 
                 c o n s t   o r i g i n a l D e s c G e t   =   d e s c . g e t ; 
                 c o n s t   o r i g i n a l D e s c S e t   =   d e s c . s e t ; 
                 / /   s u b s t r ( 2 )   c u z   ' o n c l i c k '   - >   ' c l i c k ' ,   e t c 
                 c o n s t   e v e n t N a m e   =   p r o p . s u b s t r ( 2 ) ; 
                 l e t   e v e n t N a m e S y m b o l   =   z o n e S y m b o l E v e n t N a m e s [ e v e n t N a m e ] ; 
                 i f   ( ! e v e n t N a m e S y m b o l )   { 
                         e v e n t N a m e S y m b o l   =   z o n e S y m b o l E v e n t N a m e s [ e v e n t N a m e ]   =   z o n e S y m b o l ( ' O N _ P R O P E R T Y '   +   e v e n t N a m e ) ; 
                 } 
                 d e s c . s e t   =   f u n c t i o n   ( n e w V a l u e )   { 
                         / /   i n   s o m e   o f   w i n d o w s ' s   o n p r o p e r t y   c a l l b a c k ,   t h i s   i s   u n d e f i n e d 
                         / /   s o   w e   n e e d   t o   c h e c k   i t 
                         l e t   t a r g e t   =   t h i s ; 
                         i f   ( ! t a r g e t   & &   o b j   = = =   _ g l o b a l )   { 
                                 t a r g e t   =   _ g l o b a l ; 
                         } 
                         i f   ( ! t a r g e t )   { 
                                 r e t u r n ; 
                         } 
                         l e t   p r e v i o u s V a l u e   =   t a r g e t [ e v e n t N a m e S y m b o l ] ; 
                         i f   ( p r e v i o u s V a l u e )   { 
                                 t a r g e t . r e m o v e E v e n t L i s t e n e r ( e v e n t N a m e ,   w r a p F n ) ; 
                         } 
                         / /   i s s u e   # 9 7 8 ,   w h e n   o n l o a d   h a n d l e r   w a s   a d d e d   b e f o r e   l o a d i n g   z o n e . j s 
                         / /   w e   s h o u l d   r e m o v e   i t   w i t h   o r i g i n a l D e s c S e t 
                         i f   ( o r i g i n a l D e s c S e t )   { 
                                 o r i g i n a l D e s c S e t . a p p l y ( t a r g e t ,   N U L L _ O N _ P R O P _ V A L U E ) ; 
                         } 
                         i f   ( t y p e o f   n e w V a l u e   = = =   ' f u n c t i o n ' )   { 
                                 t a r g e t [ e v e n t N a m e S y m b o l ]   =   n e w V a l u e ; 
                                 t a r g e t . a d d E v e n t L i s t e n e r ( e v e n t N a m e ,   w r a p F n ,   f a l s e ) ; 
                         } 
                         e l s e   { 
                                 t a r g e t [ e v e n t N a m e S y m b o l ]   =   n u l l ; 
                         } 
                 } ; 
                 / /   T h e   g e t t e r   w o u l d   r e t u r n   u n d e f i n e d   f o r   u n a s s i g n e d   p r o p e r t i e s   b u t   t h e   d e f a u l t   v a l u e   o f   a n 
                 / /   u n a s s i g n e d   p r o p e r t y   i s   n u l l 
                 d e s c . g e t   =   f u n c t i o n   ( )   { 
                         / /   i n   s o m e   o f   w i n d o w s ' s   o n p r o p e r t y   c a l l b a c k ,   t h i s   i s   u n d e f i n e d 
                         / /   s o   w e   n e e d   t o   c h e c k   i t 
                         l e t   t a r g e t   =   t h i s ; 
                         i f   ( ! t a r g e t   & &   o b j   = = =   _ g l o b a l )   { 
                                 t a r g e t   =   _ g l o b a l ; 
                         } 
                         i f   ( ! t a r g e t )   { 
                                 r e t u r n   n u l l ; 
                         } 
                         c o n s t   l i s t e n e r   =   t a r g e t [ e v e n t N a m e S y m b o l ] ; 
                         i f   ( l i s t e n e r )   { 
                                 r e t u r n   l i s t e n e r ; 
                         } 
                         e l s e   i f   ( o r i g i n a l D e s c G e t )   { 
                                 / /   r e s u l t   w i l l   b e   n u l l   w h e n   u s e   i n l i n e   e v e n t   a t t r i b u t e , 
                                 / /   s u c h   a s   < b u t t o n   o n c l i c k = " f u n c ( ) ; " > O K < / b u t t o n > 
                                 / /   b e c a u s e   t h e   o n c l i c k   f u n c t i o n   i s   i n t e r n a l   r a w   u n c o m p i l e d   h a n d l e r 
                                 / /   t h e   o n c l i c k   w i l l   b e   e v a l u a t e d   w h e n   f i r s t   t i m e   e v e n t   w a s   t r i g g e r e d   o r 
                                 / /   t h e   p r o p e r t y   i s   a c c e s s e d ,   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 5 2 5 
                                 / /   s o   w e   s h o u l d   u s e   o r i g i n a l   n a t i v e   g e t   t o   r e t r i e v e   t h e   h a n d l e r 
                                 l e t   v a l u e   =   o r i g i n a l D e s c G e t   & &   o r i g i n a l D e s c G e t . c a l l ( t h i s ) ; 
                                 i f   ( v a l u e )   { 
                                         d e s c . s e t . c a l l ( t h i s ,   v a l u e ) ; 
                                         i f   ( t y p e o f   t a r g e t [ R E M O V E _ A T T R I B U T E ]   = = =   ' f u n c t i o n ' )   { 
                                                 t a r g e t . r e m o v e A t t r i b u t e ( p r o p ) ; 
                                         } 
                                         r e t u r n   v a l u e ; 
                                 } 
                         } 
                         r e t u r n   n u l l ; 
                 } ; 
                 O b j e c t D e f i n e P r o p e r t y ( o b j ,   p r o p ,   d e s c ) ; 
                 o b j [ o n P r o p P a t c h e d S y m b o l ]   =   t r u e ; 
         } 
         f u n c t i o n   p a t c h O n P r o p e r t i e s ( o b j ,   p r o p e r t i e s ,   p r o t o t y p e )   { 
                 i f   ( p r o p e r t i e s )   { 
                         f o r   ( l e t   i   =   0 ;   i   <   p r o p e r t i e s . l e n g t h ;   i + + )   { 
                                 p a t c h P r o p e r t y ( o b j ,   ' o n '   +   p r o p e r t i e s [ i ] ,   p r o t o t y p e ) ; 
                         } 
                 } 
                 e l s e   { 
                         c o n s t   o n P r o p e r t i e s   =   [ ] ; 
                         f o r   ( c o n s t   p r o p   i n   o b j )   { 
                                 i f   ( p r o p . s u b s t r ( 0 ,   2 )   = =   ' o n ' )   { 
                                         o n P r o p e r t i e s . p u s h ( p r o p ) ; 
                                 } 
                         } 
                         f o r   ( l e t   j   =   0 ;   j   <   o n P r o p e r t i e s . l e n g t h ;   j + + )   { 
                                 p a t c h P r o p e r t y ( o b j ,   o n P r o p e r t i e s [ j ] ,   p r o t o t y p e ) ; 
                         } 
                 } 
         } 
         c o n s t   o r i g i n a l I n s t a n c e K e y   =   z o n e S y m b o l ( ' o r i g i n a l I n s t a n c e ' ) ; 
         / /   w r a p   s o m e   n a t i v e   A P I   o n   ` w i n d o w ` 
         f u n c t i o n   p a t c h C l a s s ( c l a s s N a m e )   { 
                 c o n s t   O r i g i n a l C l a s s   =   _ g l o b a l [ c l a s s N a m e ] ; 
                 i f   ( ! O r i g i n a l C l a s s ) 
                         r e t u r n ; 
                 / /   k e e p   o r i g i n a l   c l a s s   i n   g l o b a l 
                 _ g l o b a l [ z o n e S y m b o l ( c l a s s N a m e ) ]   =   O r i g i n a l C l a s s ; 
                 _ g l o b a l [ c l a s s N a m e ]   =   f u n c t i o n   ( )   { 
                         c o n s t   a   =   b i n d A r g u m e n t s ( a r g u m e n t s ,   c l a s s N a m e ) ; 
                         s w i t c h   ( a . l e n g t h )   { 
                                 c a s e   0 : 
                                         t h i s [ o r i g i n a l I n s t a n c e K e y ]   =   n e w   O r i g i n a l C l a s s ( ) ; 
                                         b r e a k ; 
                                 c a s e   1 : 
                                         t h i s [ o r i g i n a l I n s t a n c e K e y ]   =   n e w   O r i g i n a l C l a s s ( a [ 0 ] ) ; 
                                         b r e a k ; 
                                 c a s e   2 : 
                                         t h i s [ o r i g i n a l I n s t a n c e K e y ]   =   n e w   O r i g i n a l C l a s s ( a [ 0 ] ,   a [ 1 ] ) ; 
                                         b r e a k ; 
                                 c a s e   3 : 
                                         t h i s [ o r i g i n a l I n s t a n c e K e y ]   =   n e w   O r i g i n a l C l a s s ( a [ 0 ] ,   a [ 1 ] ,   a [ 2 ] ) ; 
                                         b r e a k ; 
                                 c a s e   4 : 
                                         t h i s [ o r i g i n a l I n s t a n c e K e y ]   =   n e w   O r i g i n a l C l a s s ( a [ 0 ] ,   a [ 1 ] ,   a [ 2 ] ,   a [ 3 ] ) ; 
                                         b r e a k ; 
                                 d e f a u l t : 
                                         t h r o w   n e w   E r r o r ( ' A r g   l i s t   t o o   l o n g . ' ) ; 
                         } 
                 } ; 
                 / /   a t t a c h   o r i g i n a l   d e l e g a t e   t o   p a t c h e d   f u n c t i o n 
                 a t t a c h O r i g i n T o P a t c h e d ( _ g l o b a l [ c l a s s N a m e ] ,   O r i g i n a l C l a s s ) ; 
                 c o n s t   i n s t a n c e   =   n e w   O r i g i n a l C l a s s ( f u n c t i o n   ( )   {   } ) ; 
                 l e t   p r o p ; 
                 f o r   ( p r o p   i n   i n s t a n c e )   { 
                         / /   h t t p s : / / b u g s . w e b k i t . o r g / s h o w _ b u g . c g i ? i d = 4 4 7 2 1 
                         i f   ( c l a s s N a m e   = = =   ' X M L H t t p R e q u e s t '   & &   p r o p   = = =   ' r e s p o n s e B l o b ' ) 
                                 c o n t i n u e ; 
                         ( f u n c t i o n   ( p r o p )   { 
                                 i f   ( t y p e o f   i n s t a n c e [ p r o p ]   = = =   ' f u n c t i o n ' )   { 
                                         _ g l o b a l [ c l a s s N a m e ] . p r o t o t y p e [ p r o p ]   =   f u n c t i o n   ( )   { 
                                                 r e t u r n   t h i s [ o r i g i n a l I n s t a n c e K e y ] [ p r o p ] . a p p l y ( t h i s [ o r i g i n a l I n s t a n c e K e y ] ,   a r g u m e n t s ) ; 
                                         } ; 
                                 } 
                                 e l s e   { 
                                         O b j e c t D e f i n e P r o p e r t y ( _ g l o b a l [ c l a s s N a m e ] . p r o t o t y p e ,   p r o p ,   { 
                                                 s e t :   f u n c t i o n   ( f n )   { 
                                                         i f   ( t y p e o f   f n   = = =   ' f u n c t i o n ' )   { 
                                                                 t h i s [ o r i g i n a l I n s t a n c e K e y ] [ p r o p ]   =   w r a p W i t h C u r r e n t Z o n e ( f n ,   c l a s s N a m e   +   ' . '   +   p r o p ) ; 
                                                                 / /   k e e p   c a l l b a c k   i n   w r a p p e d   f u n c t i o n   s o   w e   c a n 
                                                                 / /   u s e   i t   i n   F u n c t i o n . p r o t o t y p e . t o S t r i n g   t o   r e t u r n 
                                                                 / /   t h e   n a t i v e   o n e . 
                                                                 a t t a c h O r i g i n T o P a t c h e d ( t h i s [ o r i g i n a l I n s t a n c e K e y ] [ p r o p ] ,   f n ) ; 
                                                         } 
                                                         e l s e   { 
                                                                 t h i s [ o r i g i n a l I n s t a n c e K e y ] [ p r o p ]   =   f n ; 
                                                         } 
                                                 } , 
                                                 g e t :   f u n c t i o n   ( )   {   r e t u r n   t h i s [ o r i g i n a l I n s t a n c e K e y ] [ p r o p ] ;   } 
                                         } ) ; 
                                 } 
                         } ( p r o p ) ) ; 
                 } 
                 f o r   ( p r o p   i n   O r i g i n a l C l a s s )   { 
                         i f   ( p r o p   ! = =   ' p r o t o t y p e '   & &   O r i g i n a l C l a s s . h a s O w n P r o p e r t y ( p r o p ) )   { 
                                 _ g l o b a l [ c l a s s N a m e ] [ p r o p ]   =   O r i g i n a l C l a s s [ p r o p ] ; 
                         } 
                 } 
         } 
         f u n c t i o n   c o p y S y m b o l P r o p e r t i e s ( s r c ,   d e s t )   { 
                 i f   ( t y p e o f   O b j e c t . g e t O w n P r o p e r t y S y m b o l s   ! = =   ' f u n c t i o n ' )   { 
                         r e t u r n ; 
                 } 
                 c o n s t   s y m b o l s   =   O b j e c t . g e t O w n P r o p e r t y S y m b o l s ( s r c ) ; 
                 s y m b o l s . f o r E a c h ( ( s y m b o l )   = >   { 
                         c o n s t   d e s c   =   O b j e c t . g e t O w n P r o p e r t y D e s c r i p t o r ( s r c ,   s y m b o l ) ; 
                         O b j e c t . d e f i n e P r o p e r t y ( d e s t ,   s y m b o l ,   { 
                                 g e t :   f u n c t i o n   ( )   {   r e t u r n   s r c [ s y m b o l ] ;   } , 
                                 s e t :   f u n c t i o n   ( v a l u e )   { 
                                         i f   ( d e s c   & &   ( ! d e s c . w r i t a b l e   | |   t y p e o f   d e s c . s e t   ! = =   ' f u n c t i o n ' ) )   { 
                                                 / /   i f   s r c [ s y m b o l ]   i s   n o t   w r i t a b l e   o r   n o t   h a v e   a   s e t t e r ,   j u s t   r e t u r n 
                                                 r e t u r n ; 
                                         } 
                                         s r c [ s y m b o l ]   =   v a l u e ; 
                                 } , 
                                 e n u m e r a b l e :   d e s c   ?   d e s c . e n u m e r a b l e   :   t r u e , 
                                 c o n f i g u r a b l e :   d e s c   ?   d e s c . c o n f i g u r a b l e   :   t r u e 
                         } ) ; 
                 } ) ; 
         } 
         l e t   s h o u l d C o p y S y m b o l P r o p e r t i e s   =   f a l s e ; 
         f u n c t i o n   p a t c h M e t h o d ( t a r g e t ,   n a m e ,   p a t c h F n )   { 
                 l e t   p r o t o   =   t a r g e t ; 
                 w h i l e   ( p r o t o   & &   ! p r o t o . h a s O w n P r o p e r t y ( n a m e ) )   { 
                         p r o t o   =   O b j e c t G e t P r o t o t y p e O f ( p r o t o ) ; 
                 } 
                 i f   ( ! p r o t o   & &   t a r g e t [ n a m e ] )   { 
                         / /   s o m e h o w   w e   d i d   n o t   f i n d   i t ,   b u t   w e   c a n   s e e   i t .   T h i s   h a p p e n s   o n   I E   f o r   W i n d o w   p r o p e r t i e s . 
                         p r o t o   =   t a r g e t ; 
                 } 
                 c o n s t   d e l e g a t e N a m e   =   z o n e S y m b o l ( n a m e ) ; 
                 l e t   d e l e g a t e   =   n u l l ; 
                 i f   ( p r o t o   & &   ! ( d e l e g a t e   =   p r o t o [ d e l e g a t e N a m e ] ) )   { 
                         d e l e g a t e   =   p r o t o [ d e l e g a t e N a m e ]   =   p r o t o [ n a m e ] ; 
                         / /   c h e c k   w h e t h e r   p r o t o [ n a m e ]   i s   w r i t a b l e 
                         / /   s o m e   p r o p e r t y   i s   r e a d o n l y   i n   s a f a r i ,   s u c h   a s   H t m l C a n v a s E l e m e n t . p r o t o t y p e . t o B l o b 
                         c o n s t   d e s c   =   p r o t o   & &   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r ( p r o t o ,   n a m e ) ; 
                         i f   ( i s P r o p e r t y W r i t a b l e ( d e s c ) )   { 
                                 c o n s t   p a t c h D e l e g a t e   =   p a t c h F n ( d e l e g a t e ,   d e l e g a t e N a m e ,   n a m e ) ; 
                                 p r o t o [ n a m e ]   =   f u n c t i o n   ( )   {   r e t u r n   p a t c h D e l e g a t e ( t h i s ,   a r g u m e n t s ) ;   } ; 
                                 a t t a c h O r i g i n T o P a t c h e d ( p r o t o [ n a m e ] ,   d e l e g a t e ) ; 
                                 i f   ( s h o u l d C o p y S y m b o l P r o p e r t i e s )   { 
                                         c o p y S y m b o l P r o p e r t i e s ( d e l e g a t e ,   p r o t o [ n a m e ] ) ; 
                                 } 
                         } 
                 } 
                 r e t u r n   d e l e g a t e ; 
         } 
         / /   T O D O :   @ J i a L i P a s s i o n ,   s u p p o r t   c a n c e l   t a s k   l a t e r   i f   n e c e s s a r y 
         f u n c t i o n   p a t c h M a c r o T a s k ( o b j ,   f u n c N a m e ,   m e t a C r e a t o r )   { 
                 l e t   s e t N a t i v e   =   n u l l ; 
                 f u n c t i o n   s c h e d u l e T a s k ( t a s k )   { 
                         c o n s t   d a t a   =   t a s k . d a t a ; 
                         d a t a . a r g s [ d a t a . c b I d x ]   =   f u n c t i o n   ( )   {   t a s k . i n v o k e . a p p l y ( t h i s ,   a r g u m e n t s ) ;   } ; 
                         s e t N a t i v e . a p p l y ( d a t a . t a r g e t ,   d a t a . a r g s ) ; 
                         r e t u r n   t a s k ; 
                 } 
                 s e t N a t i v e   =   p a t c h M e t h o d ( o b j ,   f u n c N a m e ,   ( d e l e g a t e )   = >   f u n c t i o n   ( s e l f ,   a r g s )   { 
                         c o n s t   m e t a   =   m e t a C r e a t o r ( s e l f ,   a r g s ) ; 
                         i f   ( m e t a . c b I d x   > =   0   & &   t y p e o f   a r g s [ m e t a . c b I d x ]   = = =   ' f u n c t i o n ' )   { 
                                 r e t u r n   s c h e d u l e M a c r o T a s k W i t h C u r r e n t Z o n e ( m e t a . n a m e ,   a r g s [ m e t a . c b I d x ] ,   m e t a ,   s c h e d u l e T a s k ) ; 
                         } 
                         e l s e   { 
                                 / /   c a u s e   a n   e r r o r   b y   c a l l i n g   i t   d i r e c t l y . 
                                 r e t u r n   d e l e g a t e . a p p l y ( s e l f ,   a r g s ) ; 
                         } 
                 } ) ; 
         } 
         f u n c t i o n   a t t a c h O r i g i n T o P a t c h e d ( p a t c h e d ,   o r i g i n a l )   { 
                 p a t c h e d [ z o n e S y m b o l ( ' O r i g i n a l D e l e g a t e ' ) ]   =   o r i g i n a l ; 
         } 
         l e t   i s D e t e c t e d I E O r E d g e   =   f a l s e ; 
         l e t   i e O r E d g e   =   f a l s e ; 
         f u n c t i o n   i s I E ( )   { 
                 t r y   { 
                         c o n s t   u a   =   i n t e r n a l W i n d o w . n a v i g a t o r . u s e r A g e n t ; 
                         i f   ( u a . i n d e x O f ( ' M S I E   ' )   ! = =   - 1   | |   u a . i n d e x O f ( ' T r i d e n t / ' )   ! = =   - 1 )   { 
                                 r e t u r n   t r u e ; 
                         } 
                 } 
                 c a t c h   ( e r r o r )   { 
                 } 
                 r e t u r n   f a l s e ; 
         } 
         f u n c t i o n   i s I E O r E d g e ( )   { 
                 i f   ( i s D e t e c t e d I E O r E d g e )   { 
                         r e t u r n   i e O r E d g e ; 
                 } 
                 i s D e t e c t e d I E O r E d g e   =   t r u e ; 
                 t r y   { 
                         c o n s t   u a   =   i n t e r n a l W i n d o w . n a v i g a t o r . u s e r A g e n t ; 
                         i f   ( u a . i n d e x O f ( ' M S I E   ' )   ! = =   - 1   | |   u a . i n d e x O f ( ' T r i d e n t / ' )   ! = =   - 1   | |   u a . i n d e x O f ( ' E d g e / ' )   ! = =   - 1 )   { 
                                 i e O r E d g e   =   t r u e ; 
                         } 
                 } 
                 c a t c h   ( e r r o r )   { 
                 } 
                 r e t u r n   i e O r E d g e ; 
         } 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         / /   o v e r r i d e   F u n c t i o n . p r o t o t y p e . t o S t r i n g   t o   m a k e   z o n e . j s   p a t c h e d   f u n c t i o n 
         / /   l o o k   l i k e   n a t i v e   f u n c t i o n 
         Z o n e . _ _ l o a d _ p a t c h ( ' t o S t r i n g ' ,   ( g l o b a l )   = >   { 
                 / /   p a t c h   F u n c . p r o t o t y p e . t o S t r i n g   t o   l e t   t h e m   l o o k   l i k e   n a t i v e 
                 c o n s t   o r i g i n a l F u n c t i o n T o S t r i n g   =   F u n c t i o n . p r o t o t y p e . t o S t r i n g ; 
                 c o n s t   O R I G I N A L _ D E L E G A T E _ S Y M B O L   =   z o n e S y m b o l ( ' O r i g i n a l D e l e g a t e ' ) ; 
                 c o n s t   P R O M I S E _ S Y M B O L   =   z o n e S y m b o l ( ' P r o m i s e ' ) ; 
                 c o n s t   E R R O R _ S Y M B O L   =   z o n e S y m b o l ( ' E r r o r ' ) ; 
                 c o n s t   n e w F u n c t i o n T o S t r i n g   =   f u n c t i o n   t o S t r i n g ( )   { 
                         i f   ( t y p e o f   t h i s   = = =   ' f u n c t i o n ' )   { 
                                 c o n s t   o r i g i n a l D e l e g a t e   =   t h i s [ O R I G I N A L _ D E L E G A T E _ S Y M B O L ] ; 
                                 i f   ( o r i g i n a l D e l e g a t e )   { 
                                         i f   ( t y p e o f   o r i g i n a l D e l e g a t e   = = =   ' f u n c t i o n ' )   { 
                                                 r e t u r n   o r i g i n a l F u n c t i o n T o S t r i n g . c a l l ( o r i g i n a l D e l e g a t e ) ; 
                                         } 
                                         e l s e   { 
                                                 r e t u r n   O b j e c t . p r o t o t y p e . t o S t r i n g . c a l l ( o r i g i n a l D e l e g a t e ) ; 
                                         } 
                                 } 
                                 i f   ( t h i s   = = =   P r o m i s e )   { 
                                         c o n s t   n a t i v e P r o m i s e   =   g l o b a l [ P R O M I S E _ S Y M B O L ] ; 
                                         i f   ( n a t i v e P r o m i s e )   { 
                                                 r e t u r n   o r i g i n a l F u n c t i o n T o S t r i n g . c a l l ( n a t i v e P r o m i s e ) ; 
                                         } 
                                 } 
                                 i f   ( t h i s   = = =   E r r o r )   { 
                                         c o n s t   n a t i v e E r r o r   =   g l o b a l [ E R R O R _ S Y M B O L ] ; 
                                         i f   ( n a t i v e E r r o r )   { 
                                                 r e t u r n   o r i g i n a l F u n c t i o n T o S t r i n g . c a l l ( n a t i v e E r r o r ) ; 
                                         } 
                                 } 
                         } 
                         r e t u r n   o r i g i n a l F u n c t i o n T o S t r i n g . c a l l ( t h i s ) ; 
                 } ; 
                 n e w F u n c t i o n T o S t r i n g [ O R I G I N A L _ D E L E G A T E _ S Y M B O L ]   =   o r i g i n a l F u n c t i o n T o S t r i n g ; 
                 F u n c t i o n . p r o t o t y p e . t o S t r i n g   =   n e w F u n c t i o n T o S t r i n g ; 
                 / /   p a t c h   O b j e c t . p r o t o t y p e . t o S t r i n g   t o   l e t   t h e m   l o o k   l i k e   n a t i v e 
                 c o n s t   o r i g i n a l O b j e c t T o S t r i n g   =   O b j e c t . p r o t o t y p e . t o S t r i n g ; 
                 c o n s t   P R O M I S E _ O B J E C T _ T O _ S T R I N G   =   ' [ o b j e c t   P r o m i s e ] ' ; 
                 O b j e c t . p r o t o t y p e . t o S t r i n g   =   f u n c t i o n   ( )   { 
                         i f   ( t h i s   i n s t a n c e o f   P r o m i s e )   { 
                                 r e t u r n   P R O M I S E _ O B J E C T _ T O _ S T R I N G ; 
                         } 
                         r e t u r n   o r i g i n a l O b j e c t T o S t r i n g . c a l l ( t h i s ) ; 
                 } ; 
         } ) ; 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         l e t   p a s s i v e S u p p o r t e d   =   f a l s e ; 
         i f   ( t y p e o f   w i n d o w   ! = =   ' u n d e f i n e d ' )   { 
                 t r y   { 
                         c o n s t   o p t i o n s   =   O b j e c t . d e f i n e P r o p e r t y ( { } ,   ' p a s s i v e ' ,   {   g e t :   f u n c t i o n   ( )   {   p a s s i v e S u p p o r t e d   =   t r u e ;   }   } ) ; 
                         w i n d o w . a d d E v e n t L i s t e n e r ( ' t e s t ' ,   o p t i o n s ,   o p t i o n s ) ; 
                         w i n d o w . r e m o v e E v e n t L i s t e n e r ( ' t e s t ' ,   o p t i o n s ,   o p t i o n s ) ; 
                 } 
                 c a t c h   ( e r r )   { 
                         p a s s i v e S u p p o r t e d   =   f a l s e ; 
                 } 
         } 
         / /   a n   i d e n t i f i e r   t o   t e l l   Z o n e T a s k   d o   n o t   c r e a t e   a   n e w   i n v o k e   c l o s u r e 
         c o n s t   O P T I M I Z E D _ Z O N E _ E V E N T _ T A S K _ D A T A   =   { 
                 u s e G :   t r u e 
         } ; 
         c o n s t   z o n e S y m b o l E v e n t N a m e s $ 1   =   { } ; 
         c o n s t   g l o b a l S o u r c e s   =   { } ; 
         c o n s t   E V E N T _ N A M E _ S Y M B O L _ R E G X   =   n e w   R e g E x p ( ' ^ '   +   Z O N E _ S Y M B O L _ P R E F I X   +   ' ( \ \ w + ) ( t r u e | f a l s e ) $ ' ) ; 
         c o n s t   I M M E D I A T E _ P R O P A G A T I O N _ S Y M B O L   =   z o n e S y m b o l ( ' p r o p a g a t i o n S t o p p e d ' ) ; 
         f u n c t i o n   p r e p a r e E v e n t N a m e s ( e v e n t N a m e ,   e v e n t N a m e T o S t r i n g )   { 
                 c o n s t   f a l s e E v e n t N a m e   =   ( e v e n t N a m e T o S t r i n g   ?   e v e n t N a m e T o S t r i n g ( e v e n t N a m e )   :   e v e n t N a m e )   +   F A L S E _ S T R ; 
                 c o n s t   t r u e E v e n t N a m e   =   ( e v e n t N a m e T o S t r i n g   ?   e v e n t N a m e T o S t r i n g ( e v e n t N a m e )   :   e v e n t N a m e )   +   T R U E _ S T R ; 
                 c o n s t   s y m b o l   =   Z O N E _ S Y M B O L _ P R E F I X   +   f a l s e E v e n t N a m e ; 
                 c o n s t   s y m b o l C a p t u r e   =   Z O N E _ S Y M B O L _ P R E F I X   +   t r u e E v e n t N a m e ; 
                 z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ]   =   { } ; 
                 z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ] [ F A L S E _ S T R ]   =   s y m b o l ; 
                 z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ] [ T R U E _ S T R ]   =   s y m b o l C a p t u r e ; 
         } 
         f u n c t i o n   p a t c h E v e n t T a r g e t ( _ g l o b a l ,   a p i s ,   p a t c h O p t i o n s )   { 
                 c o n s t   A D D _ E V E N T _ L I S T E N E R   =   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . a d d )   | |   A D D _ E V E N T _ L I S T E N E R _ S T R ; 
                 c o n s t   R E M O V E _ E V E N T _ L I S T E N E R   =   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . r m )   | |   R E M O V E _ E V E N T _ L I S T E N E R _ S T R ; 
                 c o n s t   L I S T E N E R S _ E V E N T _ L I S T E N E R   =   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . l i s t e n e r s )   | |   ' e v e n t L i s t e n e r s ' ; 
                 c o n s t   R E M O V E _ A L L _ L I S T E N E R S _ E V E N T _ L I S T E N E R   =   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . r m A l l )   | |   ' r e m o v e A l l L i s t e n e r s ' ; 
                 c o n s t   z o n e S y m b o l A d d E v e n t L i s t e n e r   =   z o n e S y m b o l ( A D D _ E V E N T _ L I S T E N E R ) ; 
                 c o n s t   A D D _ E V E N T _ L I S T E N E R _ S O U R C E   =   ' . '   +   A D D _ E V E N T _ L I S T E N E R   +   ' : ' ; 
                 c o n s t   P R E P E N D _ E V E N T _ L I S T E N E R   =   ' p r e p e n d L i s t e n e r ' ; 
                 c o n s t   P R E P E N D _ E V E N T _ L I S T E N E R _ S O U R C E   =   ' . '   +   P R E P E N D _ E V E N T _ L I S T E N E R   +   ' : ' ; 
                 c o n s t   i n v o k e T a s k   =   f u n c t i o n   ( t a s k ,   t a r g e t ,   e v e n t )   { 
                         / /   f o r   b e t t e r   p e r f o r m a n c e ,   c h e c k   i s R e m o v e d   w h i c h   i s   s e t 
                         / /   b y   r e m o v e E v e n t L i s t e n e r 
                         i f   ( t a s k . i s R e m o v e d )   { 
                                 r e t u r n ; 
                         } 
                         c o n s t   d e l e g a t e   =   t a s k . c a l l b a c k ; 
                         i f   ( t y p e o f   d e l e g a t e   = = =   ' o b j e c t '   & &   d e l e g a t e . h a n d l e E v e n t )   { 
                                 / /   c r e a t e   t h e   b i n d   v e r s i o n   o f   h a n d l e E v e n t   w h e n   i n v o k e 
                                 t a s k . c a l l b a c k   =   ( e v e n t )   = >   d e l e g a t e . h a n d l e E v e n t ( e v e n t ) ; 
                                 t a s k . o r i g i n a l D e l e g a t e   =   d e l e g a t e ; 
                         } 
                         / /   i n v o k e   s t a t i c   t a s k . i n v o k e 
                         t a s k . i n v o k e ( t a s k ,   t a r g e t ,   [ e v e n t ] ) ; 
                         c o n s t   o p t i o n s   =   t a s k . o p t i o n s ; 
                         i f   ( o p t i o n s   & &   t y p e o f   o p t i o n s   = = =   ' o b j e c t '   & &   o p t i o n s . o n c e )   { 
                                 / /   i f   o p t i o n s . o n c e   i s   t r u e ,   a f t e r   i n v o k e   o n c e   r e m o v e   l i s t e n e r   h e r e 
                                 / /   o n l y   b r o w s e r   n e e d   t o   d o   t h i s ,   n o d e j s   e v e n t E m i t t e r   w i l l   c a l   r e m o v e L i s t e n e r 
                                 / /   i n s i d e   E v e n t E m i t t e r . o n c e 
                                 c o n s t   d e l e g a t e   =   t a s k . o r i g i n a l D e l e g a t e   ?   t a s k . o r i g i n a l D e l e g a t e   :   t a s k . c a l l b a c k ; 
                                 t a r g e t [ R E M O V E _ E V E N T _ L I S T E N E R ] . c a l l ( t a r g e t ,   e v e n t . t y p e ,   d e l e g a t e ,   o p t i o n s ) ; 
                         } 
                 } ; 
                 / /   g l o b a l   s h a r e d   z o n e A w a r e C a l l b a c k   t o   h a n d l e   a l l   e v e n t   c a l l b a c k   w i t h   c a p t u r e   =   f a l s e 
                 c o n s t   g l o b a l Z o n e A w a r e C a l l b a c k   =   f u n c t i o n   ( e v e n t )   { 
                         / /   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 9 1 1 ,   i n   I E ,   s o m e t i m e s 
                         / /   e v e n t   w i l l   b e   u n d e f i n e d ,   s o   w e   n e e d   t o   u s e   w i n d o w . e v e n t 
                         e v e n t   =   e v e n t   | |   _ g l o b a l . e v e n t ; 
                         i f   ( ! e v e n t )   { 
                                 r e t u r n ; 
                         } 
                         / /   e v e n t . t a r g e t   i s   n e e d e d   f o r   S a m s u n g   T V   a n d   S o u r c e B u f f e r 
                         / /   | |   g l o b a l   i s   n e e d e d   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 1 9 0 
                         c o n s t   t a r g e t   =   t h i s   | |   e v e n t . t a r g e t   | |   _ g l o b a l ; 
                         c o n s t   t a s k s   =   t a r g e t [ z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t . t y p e ] [ F A L S E _ S T R ] ] ; 
                         i f   ( t a s k s )   { 
                                 / /   i n v o k e   a l l   t a s k s   w h i c h   a t t a c h e d   t o   c u r r e n t   t a r g e t   w i t h   g i v e n   e v e n t . t y p e   a n d   c a p t u r e   =   f a l s e 
                                 / /   f o r   p e r f o r m a n c e   c o n c e r n ,   i f   t a s k . l e n g t h   = = =   1 ,   j u s t   i n v o k e 
                                 i f   ( t a s k s . l e n g t h   = = =   1 )   { 
                                         i n v o k e T a s k ( t a s k s [ 0 ] ,   t a r g e t ,   e v e n t ) ; 
                                 } 
                                 e l s e   { 
                                         / /   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 8 3 6 
                                         / /   c o p y   t h e   t a s k s   a r r a y   b e f o r e   i n v o k e ,   t o   a v o i d 
                                         / /   t h e   c a l l b a c k   w i l l   r e m o v e   i t s e l f   o r   o t h e r   l i s t e n e r 
                                         c o n s t   c o p y T a s k s   =   t a s k s . s l i c e ( ) ; 
                                         f o r   ( l e t   i   =   0 ;   i   <   c o p y T a s k s . l e n g t h ;   i + + )   { 
                                                 i f   ( e v e n t   & &   e v e n t [ I M M E D I A T E _ P R O P A G A T I O N _ S Y M B O L ]   = = =   t r u e )   { 
                                                         b r e a k ; 
                                                 } 
                                                 i n v o k e T a s k ( c o p y T a s k s [ i ] ,   t a r g e t ,   e v e n t ) ; 
                                         } 
                                 } 
                         } 
                 } ; 
                 / /   g l o b a l   s h a r e d   z o n e A w a r e C a l l b a c k   t o   h a n d l e   a l l   e v e n t   c a l l b a c k   w i t h   c a p t u r e   =   t r u e 
                 c o n s t   g l o b a l Z o n e A w a r e C a p t u r e C a l l b a c k   =   f u n c t i o n   ( e v e n t )   { 
                         / /   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 9 1 1 ,   i n   I E ,   s o m e t i m e s 
                         / /   e v e n t   w i l l   b e   u n d e f i n e d ,   s o   w e   n e e d   t o   u s e   w i n d o w . e v e n t 
                         e v e n t   =   e v e n t   | |   _ g l o b a l . e v e n t ; 
                         i f   ( ! e v e n t )   { 
                                 r e t u r n ; 
                         } 
                         / /   e v e n t . t a r g e t   i s   n e e d e d   f o r   S a m s u n g   T V   a n d   S o u r c e B u f f e r 
                         / /   | |   g l o b a l   i s   n e e d e d   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 1 9 0 
                         c o n s t   t a r g e t   =   t h i s   | |   e v e n t . t a r g e t   | |   _ g l o b a l ; 
                         c o n s t   t a s k s   =   t a r g e t [ z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t . t y p e ] [ T R U E _ S T R ] ] ; 
                         i f   ( t a s k s )   { 
                                 / /   i n v o k e   a l l   t a s k s   w h i c h   a t t a c h e d   t o   c u r r e n t   t a r g e t   w i t h   g i v e n   e v e n t . t y p e   a n d   c a p t u r e   =   f a l s e 
                                 / /   f o r   p e r f o r m a n c e   c o n c e r n ,   i f   t a s k . l e n g t h   = = =   1 ,   j u s t   i n v o k e 
                                 i f   ( t a s k s . l e n g t h   = = =   1 )   { 
                                         i n v o k e T a s k ( t a s k s [ 0 ] ,   t a r g e t ,   e v e n t ) ; 
                                 } 
                                 e l s e   { 
                                         / /   h t t p s : / / g i t h u b . c o m / a n g u l a r / z o n e . j s / i s s u e s / 8 3 6 
                                         / /   c o p y   t h e   t a s k s   a r r a y   b e f o r e   i n v o k e ,   t o   a v o i d 
                                         / /   t h e   c a l l b a c k   w i l l   r e m o v e   i t s e l f   o r   o t h e r   l i s t e n e r 
                                         c o n s t   c o p y T a s k s   =   t a s k s . s l i c e ( ) ; 
                                         f o r   ( l e t   i   =   0 ;   i   <   c o p y T a s k s . l e n g t h ;   i + + )   { 
                                                 i f   ( e v e n t   & &   e v e n t [ I M M E D I A T E _ P R O P A G A T I O N _ S Y M B O L ]   = = =   t r u e )   { 
                                                         b r e a k ; 
                                                 } 
                                                 i n v o k e T a s k ( c o p y T a s k s [ i ] ,   t a r g e t ,   e v e n t ) ; 
                                         } 
                                 } 
                         } 
                 } ; 
                 f u n c t i o n   p a t c h E v e n t T a r g e t M e t h o d s ( o b j ,   p a t c h O p t i o n s )   { 
                         i f   ( ! o b j )   { 
                                 r e t u r n   f a l s e ; 
                         } 
                         l e t   u s e G l o b a l C a l l b a c k   =   t r u e ; 
                         i f   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . u s e G   ! = =   u n d e f i n e d )   { 
                                 u s e G l o b a l C a l l b a c k   =   p a t c h O p t i o n s . u s e G ; 
                         } 
                         c o n s t   v a l i d a t e H a n d l e r   =   p a t c h O p t i o n s   & &   p a t c h O p t i o n s . v h ; 
                         l e t   c h e c k D u p l i c a t e   =   t r u e ; 
                         i f   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . c h k D u p   ! = =   u n d e f i n e d )   { 
                                 c h e c k D u p l i c a t e   =   p a t c h O p t i o n s . c h k D u p ; 
                         } 
                         l e t   r e t u r n T a r g e t   =   f a l s e ; 
                         i f   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . r t   ! = =   u n d e f i n e d )   { 
                                 r e t u r n T a r g e t   =   p a t c h O p t i o n s . r t ; 
                         } 
                         l e t   p r o t o   =   o b j ; 
                         w h i l e   ( p r o t o   & &   ! p r o t o . h a s O w n P r o p e r t y ( A D D _ E V E N T _ L I S T E N E R ) )   { 
                                 p r o t o   =   O b j e c t G e t P r o t o t y p e O f ( p r o t o ) ; 
                         } 
                         i f   ( ! p r o t o   & &   o b j [ A D D _ E V E N T _ L I S T E N E R ] )   { 
                                 / /   s o m e h o w   w e   d i d   n o t   f i n d   i t ,   b u t   w e   c a n   s e e   i t .   T h i s   h a p p e n s   o n   I E   f o r   W i n d o w   p r o p e r t i e s . 
                                 p r o t o   =   o b j ; 
                         } 
                         i f   ( ! p r o t o )   { 
                                 r e t u r n   f a l s e ; 
                         } 
                         i f   ( p r o t o [ z o n e S y m b o l A d d E v e n t L i s t e n e r ] )   { 
                                 r e t u r n   f a l s e ; 
                         } 
                         c o n s t   e v e n t N a m e T o S t r i n g   =   p a t c h O p t i o n s   & &   p a t c h O p t i o n s . e v e n t N a m e T o S t r i n g ; 
                         / /   a   s h a r e d   g l o b a l   t a s k D a t a   t o   p a s s   d a t a   f o r   s c h e d u l e E v e n t T a s k 
                         / /   s o   w e   d o   n o t   n e e d   t o   c r e a t e   a   n e w   o b j e c t   j u s t   f o r   p a s s   s o m e   d a t a 
                         c o n s t   t a s k D a t a   =   { } ; 
                         c o n s t   n a t i v e A d d E v e n t L i s t e n e r   =   p r o t o [ z o n e S y m b o l A d d E v e n t L i s t e n e r ]   =   p r o t o [ A D D _ E V E N T _ L I S T E N E R ] ; 
                         c o n s t   n a t i v e R e m o v e E v e n t L i s t e n e r   =   p r o t o [ z o n e S y m b o l ( R E M O V E _ E V E N T _ L I S T E N E R ) ]   = 
                                 p r o t o [ R E M O V E _ E V E N T _ L I S T E N E R ] ; 
                         c o n s t   n a t i v e L i s t e n e r s   =   p r o t o [ z o n e S y m b o l ( L I S T E N E R S _ E V E N T _ L I S T E N E R ) ]   = 
                                 p r o t o [ L I S T E N E R S _ E V E N T _ L I S T E N E R ] ; 
                         c o n s t   n a t i v e R e m o v e A l l L i s t e n e r s   =   p r o t o [ z o n e S y m b o l ( R E M O V E _ A L L _ L I S T E N E R S _ E V E N T _ L I S T E N E R ) ]   = 
                                 p r o t o [ R E M O V E _ A L L _ L I S T E N E R S _ E V E N T _ L I S T E N E R ] ; 
                         l e t   n a t i v e P r e p e n d E v e n t L i s t e n e r ; 
                         i f   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . p r e p e n d )   { 
                                 n a t i v e P r e p e n d E v e n t L i s t e n e r   =   p r o t o [ z o n e S y m b o l ( p a t c h O p t i o n s . p r e p e n d ) ]   = 
                                         p r o t o [ p a t c h O p t i o n s . p r e p e n d ] ; 
                         } 
                         / * * 
                           *   T h i s   u t i l   f u n c t i o n   w i l l   b u i l d   a n   o p t i o n   o b j e c t   w i t h   p a s s i v e   o p t i o n 
                           *   t o   h a n d l e   a l l   p o s s i b l e   i n p u t   f r o m   t h e   u s e r . 
                           * / 
                         f u n c t i o n   b u i l d E v e n t L i s t e n e r O p t i o n s ( o p t i o n s ,   p a s s i v e )   { 
                                 i f   ( ! p a s s i v e S u p p o r t e d   & &   t y p e o f   o p t i o n s   = = =   ' o b j e c t '   & &   o p t i o n s )   { 
                                         / /   d o e s n ' t   s u p p o r t   p a s s i v e   b u t   u s e r   w a n t   t o   p a s s   a n   o b j e c t   a s   o p t i o n s . 
                                         / /   t h i s   w i l l   n o t   w o r k   o n   s o m e   o l d   b r o w s e r ,   s o   w e   j u s t   p a s s   a   b o o l e a n 
                                         / /   a s   u s e C a p t u r e   p a r a m e t e r 
                                         r e t u r n   ! ! o p t i o n s . c a p t u r e ; 
                                 } 
                                 i f   ( ! p a s s i v e S u p p o r t e d   | |   ! p a s s i v e )   { 
                                         r e t u r n   o p t i o n s ; 
                                 } 
                                 i f   ( t y p e o f   o p t i o n s   = = =   ' b o o l e a n ' )   { 
                                         r e t u r n   {   c a p t u r e :   o p t i o n s ,   p a s s i v e :   t r u e   } ; 
                                 } 
                                 i f   ( ! o p t i o n s )   { 
                                         r e t u r n   {   p a s s i v e :   t r u e   } ; 
                                 } 
                                 i f   ( t y p e o f   o p t i o n s   = = =   ' o b j e c t '   & &   o p t i o n s . p a s s i v e   ! = =   f a l s e )   { 
                                         r e t u r n   O b j e c t . a s s i g n ( O b j e c t . a s s i g n ( { } ,   o p t i o n s ) ,   {   p a s s i v e :   t r u e   } ) ; 
                                 } 
                                 r e t u r n   o p t i o n s ; 
                         } 
                         c o n s t   c u s t o m S c h e d u l e G l o b a l   =   f u n c t i o n   ( t a s k )   { 
                                 / /   i f   t h e r e   i s   a l r e a d y   a   t a s k   f o r   t h e   e v e n t N a m e   +   c a p t u r e , 
                                 / /   j u s t   r e t u r n ,   b e c a u s e   w e   u s e   t h e   s h a r e d   g l o b a l Z o n e A w a r e C a l l b a c k   h e r e . 
                                 i f   ( t a s k D a t a . i s E x i s t i n g )   { 
                                         r e t u r n ; 
                                 } 
                                 r e t u r n   n a t i v e A d d E v e n t L i s t e n e r . c a l l ( t a s k D a t a . t a r g e t ,   t a s k D a t a . e v e n t N a m e ,   t a s k D a t a . c a p t u r e   ?   g l o b a l Z o n e A w a r e C a p t u r e C a l l b a c k   :   g l o b a l Z o n e A w a r e C a l l b a c k ,   t a s k D a t a . o p t i o n s ) ; 
                         } ; 
                         c o n s t   c u s t o m C a n c e l G l o b a l   =   f u n c t i o n   ( t a s k )   { 
                                 / /   i f   t a s k   i s   n o t   m a r k e d   a s   i s R e m o v e d ,   t h i s   c a l l   i s   d i r e c t l y 
                                 / /   f r o m   Z o n e . p r o t o t y p e . c a n c e l T a s k ,   w e   s h o u l d   r e m o v e   t h e   t a s k 
                                 / /   f r o m   t a s k s L i s t   o f   t a r g e t   f i r s t 
                                 i f   ( ! t a s k . i s R e m o v e d )   { 
                                         c o n s t   s y m b o l E v e n t N a m e s   =   z o n e S y m b o l E v e n t N a m e s $ 1 [ t a s k . e v e n t N a m e ] ; 
                                         l e t   s y m b o l E v e n t N a m e ; 
                                         i f   ( s y m b o l E v e n t N a m e s )   { 
                                                 s y m b o l E v e n t N a m e   =   s y m b o l E v e n t N a m e s [ t a s k . c a p t u r e   ?   T R U E _ S T R   :   F A L S E _ S T R ] ; 
                                         } 
                                         c o n s t   e x i s t i n g T a s k s   =   s y m b o l E v e n t N a m e   & &   t a s k . t a r g e t [ s y m b o l E v e n t N a m e ] ; 
                                         i f   ( e x i s t i n g T a s k s )   { 
                                                 f o r   ( l e t   i   =   0 ;   i   <   e x i s t i n g T a s k s . l e n g t h ;   i + + )   { 
                                                         c o n s t   e x i s t i n g T a s k   =   e x i s t i n g T a s k s [ i ] ; 
                                                         i f   ( e x i s t i n g T a s k   = = =   t a s k )   { 
                                                                 e x i s t i n g T a s k s . s p l i c e ( i ,   1 ) ; 
                                                                 / /   s e t   i s R e m o v e d   t o   d a t a   f o r   f a s t e r   i n v o k e T a s k   c h e c k 
                                                                 t a s k . i s R e m o v e d   =   t r u e ; 
                                                                 i f   ( e x i s t i n g T a s k s . l e n g t h   = = =   0 )   { 
                                                                         / /   a l l   t a s k s   f o r   t h e   e v e n t N a m e   +   c a p t u r e   h a v e   g o n e , 
                                                                         / /   r e m o v e   g l o b a l Z o n e A w a r e C a l l b a c k   a n d   r e m o v e   t h e   t a s k   c a c h e   f r o m   t a r g e t 
                                                                         t a s k . a l l R e m o v e d   =   t r u e ; 
                                                                         t a s k . t a r g e t [ s y m b o l E v e n t N a m e ]   =   n u l l ; 
                                                                 } 
                                                                 b r e a k ; 
                                                         } 
                                                 } 
                                         } 
                                 } 
                                 / /   i f   a l l   t a s k s   f o r   t h e   e v e n t N a m e   +   c a p t u r e   h a v e   g o n e , 
                                 / /   w e   w i l l   r e a l l y   r e m o v e   t h e   g l o b a l   e v e n t   c a l l b a c k , 
                                 / /   i f   n o t ,   r e t u r n 
                                 i f   ( ! t a s k . a l l R e m o v e d )   { 
                                         r e t u r n ; 
                                 } 
                                 r e t u r n   n a t i v e R e m o v e E v e n t L i s t e n e r . c a l l ( t a s k . t a r g e t ,   t a s k . e v e n t N a m e ,   t a s k . c a p t u r e   ?   g l o b a l Z o n e A w a r e C a p t u r e C a l l b a c k   :   g l o b a l Z o n e A w a r e C a l l b a c k ,   t a s k . o p t i o n s ) ; 
                         } ; 
                         c o n s t   c u s t o m S c h e d u l e N o n G l o b a l   =   f u n c t i o n   ( t a s k )   { 
                                 r e t u r n   n a t i v e A d d E v e n t L i s t e n e r . c a l l ( t a s k D a t a . t a r g e t ,   t a s k D a t a . e v e n t N a m e ,   t a s k . i n v o k e ,   t a s k D a t a . o p t i o n s ) ; 
                         } ; 
                         c o n s t   c u s t o m S c h e d u l e P r e p e n d   =   f u n c t i o n   ( t a s k )   { 
                                 r e t u r n   n a t i v e P r e p e n d E v e n t L i s t e n e r . c a l l ( t a s k D a t a . t a r g e t ,   t a s k D a t a . e v e n t N a m e ,   t a s k . i n v o k e ,   t a s k D a t a . o p t i o n s ) ; 
                         } ; 
                         c o n s t   c u s t o m C a n c e l N o n G l o b a l   =   f u n c t i o n   ( t a s k )   { 
                                 r e t u r n   n a t i v e R e m o v e E v e n t L i s t e n e r . c a l l ( t a s k . t a r g e t ,   t a s k . e v e n t N a m e ,   t a s k . i n v o k e ,   t a s k . o p t i o n s ) ; 
                         } ; 
                         c o n s t   c u s t o m S c h e d u l e   =   u s e G l o b a l C a l l b a c k   ?   c u s t o m S c h e d u l e G l o b a l   :   c u s t o m S c h e d u l e N o n G l o b a l ; 
                         c o n s t   c u s t o m C a n c e l   =   u s e G l o b a l C a l l b a c k   ?   c u s t o m C a n c e l G l o b a l   :   c u s t o m C a n c e l N o n G l o b a l ; 
                         c o n s t   c o m p a r e T a s k C a l l b a c k V s D e l e g a t e   =   f u n c t i o n   ( t a s k ,   d e l e g a t e )   { 
                                 c o n s t   t y p e O f D e l e g a t e   =   t y p e o f   d e l e g a t e ; 
                                 r e t u r n   ( t y p e O f D e l e g a t e   = = =   ' f u n c t i o n '   & &   t a s k . c a l l b a c k   = = =   d e l e g a t e )   | | 
                                         ( t y p e O f D e l e g a t e   = = =   ' o b j e c t '   & &   t a s k . o r i g i n a l D e l e g a t e   = = =   d e l e g a t e ) ; 
                         } ; 
                         c o n s t   c o m p a r e   =   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . d i f f )   ?   p a t c h O p t i o n s . d i f f   :   c o m p a r e T a s k C a l l b a c k V s D e l e g a t e ; 
                         c o n s t   b l a c k L i s t e d E v e n t s   =   Z o n e [ z o n e S y m b o l ( ' B L A C K _ L I S T E D _ E V E N T S ' ) ] ; 
                         c o n s t   p a s s i v e E v e n t s   =   _ g l o b a l [ z o n e S y m b o l ( ' P A S S I V E _ E V E N T S ' ) ] ; 
                         c o n s t   m a k e A d d L i s t e n e r   =   f u n c t i o n   ( n a t i v e L i s t e n e r ,   a d d S o u r c e ,   c u s t o m S c h e d u l e F n ,   c u s t o m C a n c e l F n ,   r e t u r n T a r g e t   =   f a l s e ,   p r e p e n d   =   f a l s e )   { 
                                 r e t u r n   f u n c t i o n   ( )   { 
                                         c o n s t   t a r g e t   =   t h i s   | |   _ g l o b a l ; 
                                         l e t   e v e n t N a m e   =   a r g u m e n t s [ 0 ] ; 
                                         i f   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . t r a n s f e r E v e n t N a m e )   { 
                                                 e v e n t N a m e   =   p a t c h O p t i o n s . t r a n s f e r E v e n t N a m e ( e v e n t N a m e ) ; 
                                         } 
                                         l e t   d e l e g a t e   =   a r g u m e n t s [ 1 ] ; 
                                         i f   ( ! d e l e g a t e )   { 
                                                 r e t u r n   n a t i v e L i s t e n e r . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                                         } 
                                         i f   ( i s N o d e   & &   e v e n t N a m e   = = =   ' u n c a u g h t E x c e p t i o n ' )   { 
                                                 / /   d o n ' t   p a t c h   u n c a u g h t E x c e p t i o n   o f   n o d e j s   t o   p r e v e n t   e n d l e s s   l o o p 
                                                 r e t u r n   n a t i v e L i s t e n e r . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                                         } 
                                         / /   d o n ' t   c r e a t e   t h e   b i n d   d e l e g a t e   f u n c t i o n   f o r   h a n d l e E v e n t 
                                         / /   c a s e   h e r e   t o   i m p r o v e   a d d E v e n t L i s t e n e r   p e r f o r m a n c e 
                                         / /   w e   w i l l   c r e a t e   t h e   b i n d   d e l e g a t e   w h e n   i n v o k e 
                                         l e t   i s H a n d l e E v e n t   =   f a l s e ; 
                                         i f   ( t y p e o f   d e l e g a t e   ! = =   ' f u n c t i o n ' )   { 
                                                 i f   ( ! d e l e g a t e . h a n d l e E v e n t )   { 
                                                         r e t u r n   n a t i v e L i s t e n e r . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                                                 } 
                                                 i s H a n d l e E v e n t   =   t r u e ; 
                                         } 
                                         i f   ( v a l i d a t e H a n d l e r   & &   ! v a l i d a t e H a n d l e r ( n a t i v e L i s t e n e r ,   d e l e g a t e ,   t a r g e t ,   a r g u m e n t s ) )   { 
                                                 r e t u r n ; 
                                         } 
                                         c o n s t   p a s s i v e   =   p a s s i v e S u p p o r t e d   & &   ! ! p a s s i v e E v e n t s   & &   p a s s i v e E v e n t s . i n d e x O f ( e v e n t N a m e )   ! = =   - 1 ; 
                                         c o n s t   o p t i o n s   =   b u i l d E v e n t L i s t e n e r O p t i o n s ( a r g u m e n t s [ 2 ] ,   p a s s i v e ) ; 
                                         i f   ( b l a c k L i s t e d E v e n t s )   { 
                                                 / /   c h e c k   b l a c k   l i s t 
                                                 f o r   ( l e t   i   =   0 ;   i   <   b l a c k L i s t e d E v e n t s . l e n g t h ;   i + + )   { 
                                                         i f   ( e v e n t N a m e   = = =   b l a c k L i s t e d E v e n t s [ i ] )   { 
                                                                 i f   ( p a s s i v e )   { 
                                                                         r e t u r n   n a t i v e L i s t e n e r . c a l l ( t a r g e t ,   e v e n t N a m e ,   d e l e g a t e ,   o p t i o n s ) ; 
                                                                 } 
                                                                 e l s e   { 
                                                                         r e t u r n   n a t i v e L i s t e n e r . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                                                                 } 
                                                         } 
                                                 } 
                                         } 
                                         c o n s t   c a p t u r e   =   ! o p t i o n s   ?   f a l s e   :   t y p e o f   o p t i o n s   = = =   ' b o o l e a n '   ?   t r u e   :   o p t i o n s . c a p t u r e ; 
                                         c o n s t   o n c e   =   o p t i o n s   & &   t y p e o f   o p t i o n s   = = =   ' o b j e c t '   ?   o p t i o n s . o n c e   :   f a l s e ; 
                                         c o n s t   z o n e   =   Z o n e . c u r r e n t ; 
                                         l e t   s y m b o l E v e n t N a m e s   =   z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ] ; 
                                         i f   ( ! s y m b o l E v e n t N a m e s )   { 
                                                 p r e p a r e E v e n t N a m e s ( e v e n t N a m e ,   e v e n t N a m e T o S t r i n g ) ; 
                                                 s y m b o l E v e n t N a m e s   =   z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ] ; 
                                         } 
                                         c o n s t   s y m b o l E v e n t N a m e   =   s y m b o l E v e n t N a m e s [ c a p t u r e   ?   T R U E _ S T R   :   F A L S E _ S T R ] ; 
                                         l e t   e x i s t i n g T a s k s   =   t a r g e t [ s y m b o l E v e n t N a m e ] ; 
                                         l e t   i s E x i s t i n g   =   f a l s e ; 
                                         i f   ( e x i s t i n g T a s k s )   { 
                                                 / /   a l r e a d y   h a v e   t a s k   r e g i s t e r e d 
                                                 i s E x i s t i n g   =   t r u e ; 
                                                 i f   ( c h e c k D u p l i c a t e )   { 
                                                         f o r   ( l e t   i   =   0 ;   i   <   e x i s t i n g T a s k s . l e n g t h ;   i + + )   { 
                                                                 i f   ( c o m p a r e ( e x i s t i n g T a s k s [ i ] ,   d e l e g a t e ) )   { 
                                                                         / /   s a m e   c a l l b a c k ,   s a m e   c a p t u r e ,   s a m e   e v e n t   n a m e ,   j u s t   r e t u r n 
                                                                         r e t u r n ; 
                                                                 } 
                                                         } 
                                                 } 
                                         } 
                                         e l s e   { 
                                                 e x i s t i n g T a s k s   =   t a r g e t [ s y m b o l E v e n t N a m e ]   =   [ ] ; 
                                         } 
                                         l e t   s o u r c e ; 
                                         c o n s t   c o n s t r u c t o r N a m e   =   t a r g e t . c o n s t r u c t o r [ ' n a m e ' ] ; 
                                         c o n s t   t a r g e t S o u r c e   =   g l o b a l S o u r c e s [ c o n s t r u c t o r N a m e ] ; 
                                         i f   ( t a r g e t S o u r c e )   { 
                                                 s o u r c e   =   t a r g e t S o u r c e [ e v e n t N a m e ] ; 
                                         } 
                                         i f   ( ! s o u r c e )   { 
                                                 s o u r c e   =   c o n s t r u c t o r N a m e   +   a d d S o u r c e   + 
                                                         ( e v e n t N a m e T o S t r i n g   ?   e v e n t N a m e T o S t r i n g ( e v e n t N a m e )   :   e v e n t N a m e ) ; 
                                         } 
                                         / /   d o   n o t   c r e a t e   a   n e w   o b j e c t   a s   t a s k . d a t a   t o   p a s s   t h o s e   t h i n g s 
                                         / /   j u s t   u s e   t h e   g l o b a l   s h a r e d   o n e 
                                         t a s k D a t a . o p t i o n s   =   o p t i o n s ; 
                                         i f   ( o n c e )   { 
                                                 / /   i f   a d d E v e n t L i s t e n e r   w i t h   o n c e   o p t i o n s ,   w e   d o n ' t   p a s s   i t   t o 
                                                 / /   n a t i v e   a d d E v e n t L i s t e n e r ,   i n s t e a d   w e   k e e p   t h e   o n c e   s e t t i n g 
                                                 / /   a n d   h a n d l e   o u r s e l v e s . 
                                                 t a s k D a t a . o p t i o n s . o n c e   =   f a l s e ; 
                                         } 
                                         t a s k D a t a . t a r g e t   =   t a r g e t ; 
                                         t a s k D a t a . c a p t u r e   =   c a p t u r e ; 
                                         t a s k D a t a . e v e n t N a m e   =   e v e n t N a m e ; 
                                         t a s k D a t a . i s E x i s t i n g   =   i s E x i s t i n g ; 
                                         c o n s t   d a t a   =   u s e G l o b a l C a l l b a c k   ?   O P T I M I Z E D _ Z O N E _ E V E N T _ T A S K _ D A T A   :   u n d e f i n e d ; 
                                         / /   k e e p   t a s k D a t a   i n t o   d a t a   t o   a l l o w   o n S c h e d u l e E v e n t T a s k   t o   a c c e s s   t h e   t a s k   i n f o r m a t i o n 
                                         i f   ( d a t a )   { 
                                                 d a t a . t a s k D a t a   =   t a s k D a t a ; 
                                         } 
                                         c o n s t   t a s k   =   z o n e . s c h e d u l e E v e n t T a s k ( s o u r c e ,   d e l e g a t e ,   d a t a ,   c u s t o m S c h e d u l e F n ,   c u s t o m C a n c e l F n ) ; 
                                         / /   s h o u l d   c l e a r   t a s k D a t a . t a r g e t   t o   a v o i d   m e m o r y   l e a k 
                                         / /   i s s u e ,   h t t p s : / / g i t h u b . c o m / a n g u l a r / a n g u l a r / i s s u e s / 2 0 4 4 2 
                                         t a s k D a t a . t a r g e t   =   n u l l ; 
                                         / /   n e e d   t o   c l e a r   u p   t a s k D a t a   b e c a u s e   i t   i s   a   g l o b a l   o b j e c t 
                                         i f   ( d a t a )   { 
                                                 d a t a . t a s k D a t a   =   n u l l ; 
                                         } 
                                         / /   h a v e   t o   s a v e   t h o s e   i n f o r m a t i o n   t o   t a s k   i n   c a s e 
                                         / /   a p p l i c a t i o n   m a y   c a l l   t a s k . z o n e . c a n c e l T a s k ( )   d i r e c t l y 
                                         i f   ( o n c e )   { 
                                                 o p t i o n s . o n c e   =   t r u e ; 
                                         } 
                                         i f   ( ! ( ! p a s s i v e S u p p o r t e d   & &   t y p e o f   t a s k . o p t i o n s   = = =   ' b o o l e a n ' ) )   { 
                                                 / /   i f   n o t   s u p p o r t   p a s s i v e ,   a n d   w e   p a s s   a n   o p t i o n   o b j e c t 
                                                 / /   t o   a d d E v e n t L i s t e n e r ,   w e   s h o u l d   s a v e   t h e   o p t i o n s   t o   t a s k 
                                                 t a s k . o p t i o n s   =   o p t i o n s ; 
                                         } 
                                         t a s k . t a r g e t   =   t a r g e t ; 
                                         t a s k . c a p t u r e   =   c a p t u r e ; 
                                         t a s k . e v e n t N a m e   =   e v e n t N a m e ; 
                                         i f   ( i s H a n d l e E v e n t )   { 
                                                 / /   s a v e   o r i g i n a l   d e l e g a t e   f o r   c o m p a r e   t o   c h e c k   d u p l i c a t e 
                                                 t a s k . o r i g i n a l D e l e g a t e   =   d e l e g a t e ; 
                                         } 
                                         i f   ( ! p r e p e n d )   { 
                                                 e x i s t i n g T a s k s . p u s h ( t a s k ) ; 
                                         } 
                                         e l s e   { 
                                                 e x i s t i n g T a s k s . u n s h i f t ( t a s k ) ; 
                                         } 
                                         i f   ( r e t u r n T a r g e t )   { 
                                                 r e t u r n   t a r g e t ; 
                                         } 
                                 } ; 
                         } ; 
                         p r o t o [ A D D _ E V E N T _ L I S T E N E R ]   =   m a k e A d d L i s t e n e r ( n a t i v e A d d E v e n t L i s t e n e r ,   A D D _ E V E N T _ L I S T E N E R _ S O U R C E ,   c u s t o m S c h e d u l e ,   c u s t o m C a n c e l ,   r e t u r n T a r g e t ) ; 
                         i f   ( n a t i v e P r e p e n d E v e n t L i s t e n e r )   { 
                                 p r o t o [ P R E P E N D _ E V E N T _ L I S T E N E R ]   =   m a k e A d d L i s t e n e r ( n a t i v e P r e p e n d E v e n t L i s t e n e r ,   P R E P E N D _ E V E N T _ L I S T E N E R _ S O U R C E ,   c u s t o m S c h e d u l e P r e p e n d ,   c u s t o m C a n c e l ,   r e t u r n T a r g e t ,   t r u e ) ; 
                         } 
                         p r o t o [ R E M O V E _ E V E N T _ L I S T E N E R ]   =   f u n c t i o n   ( )   { 
                                 c o n s t   t a r g e t   =   t h i s   | |   _ g l o b a l ; 
                                 l e t   e v e n t N a m e   =   a r g u m e n t s [ 0 ] ; 
                                 i f   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . t r a n s f e r E v e n t N a m e )   { 
                                         e v e n t N a m e   =   p a t c h O p t i o n s . t r a n s f e r E v e n t N a m e ( e v e n t N a m e ) ; 
                                 } 
                                 c o n s t   o p t i o n s   =   a r g u m e n t s [ 2 ] ; 
                                 c o n s t   c a p t u r e   =   ! o p t i o n s   ?   f a l s e   :   t y p e o f   o p t i o n s   = = =   ' b o o l e a n '   ?   t r u e   :   o p t i o n s . c a p t u r e ; 
                                 c o n s t   d e l e g a t e   =   a r g u m e n t s [ 1 ] ; 
                                 i f   ( ! d e l e g a t e )   { 
                                         r e t u r n   n a t i v e R e m o v e E v e n t L i s t e n e r . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                                 } 
                                 i f   ( v a l i d a t e H a n d l e r   & & 
                                         ! v a l i d a t e H a n d l e r ( n a t i v e R e m o v e E v e n t L i s t e n e r ,   d e l e g a t e ,   t a r g e t ,   a r g u m e n t s ) )   { 
                                         r e t u r n ; 
                                 } 
                                 c o n s t   s y m b o l E v e n t N a m e s   =   z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ] ; 
                                 l e t   s y m b o l E v e n t N a m e ; 
                                 i f   ( s y m b o l E v e n t N a m e s )   { 
                                         s y m b o l E v e n t N a m e   =   s y m b o l E v e n t N a m e s [ c a p t u r e   ?   T R U E _ S T R   :   F A L S E _ S T R ] ; 
                                 } 
                                 c o n s t   e x i s t i n g T a s k s   =   s y m b o l E v e n t N a m e   & &   t a r g e t [ s y m b o l E v e n t N a m e ] ; 
                                 i f   ( e x i s t i n g T a s k s )   { 
                                         f o r   ( l e t   i   =   0 ;   i   <   e x i s t i n g T a s k s . l e n g t h ;   i + + )   { 
                                                 c o n s t   e x i s t i n g T a s k   =   e x i s t i n g T a s k s [ i ] ; 
                                                 i f   ( c o m p a r e ( e x i s t i n g T a s k ,   d e l e g a t e ) )   { 
                                                         e x i s t i n g T a s k s . s p l i c e ( i ,   1 ) ; 
                                                         / /   s e t   i s R e m o v e d   t o   d a t a   f o r   f a s t e r   i n v o k e T a s k   c h e c k 
                                                         e x i s t i n g T a s k . i s R e m o v e d   =   t r u e ; 
                                                         i f   ( e x i s t i n g T a s k s . l e n g t h   = = =   0 )   { 
                                                                 / /   a l l   t a s k s   f o r   t h e   e v e n t N a m e   +   c a p t u r e   h a v e   g o n e , 
                                                                 / /   r e m o v e   g l o b a l Z o n e A w a r e C a l l b a c k   a n d   r e m o v e   t h e   t a s k   c a c h e   f r o m   t a r g e t 
                                                                 e x i s t i n g T a s k . a l l R e m o v e d   =   t r u e ; 
                                                                 t a r g e t [ s y m b o l E v e n t N a m e ]   =   n u l l ; 
                                                                 / /   i n   t h e   t a r g e t ,   w e   h a v e   a n   e v e n t   l i s t e n e r   w h i c h   i s   a d d e d   b y   o n _ p r o p e r t y 
                                                                 / /   s u c h   a s   t a r g e t . o n c l i c k   =   f u n c t i o n ( )   { } ,   s o   w e   n e e d   t o   c l e a r   t h i s   i n t e r n a l 
                                                                 / /   p r o p e r t y   t o o   i f   a l l   d e l e g a t e s   a l l   r e m o v e d 
                                                                 i f   ( t y p e o f   e v e n t N a m e   = = =   ' s t r i n g ' )   { 
                                                                         c o n s t   o n P r o p e r t y S y m b o l   =   Z O N E _ S Y M B O L _ P R E F I X   +   ' O N _ P R O P E R T Y '   +   e v e n t N a m e ; 
                                                                         t a r g e t [ o n P r o p e r t y S y m b o l ]   =   n u l l ; 
                                                                 } 
                                                         } 
                                                         e x i s t i n g T a s k . z o n e . c a n c e l T a s k ( e x i s t i n g T a s k ) ; 
                                                         i f   ( r e t u r n T a r g e t )   { 
                                                                 r e t u r n   t a r g e t ; 
                                                         } 
                                                         r e t u r n ; 
                                                 } 
                                         } 
                                 } 
                                 / /   i s s u e   9 3 0 ,   d i d n ' t   f i n d   t h e   e v e n t   n a m e   o r   c a l l b a c k 
                                 / /   f r o m   z o n e   k e p t   e x i s t i n g T a s k s ,   t h e   c a l l b a c k   m a y b e 
                                 / /   a d d e d   o u t s i d e   o f   z o n e ,   w e   n e e d   t o   c a l l   n a t i v e   r e m o v e E v e n t L i s t e n e r 
                                 / /   t o   t r y   t o   r e m o v e   i t . 
                                 r e t u r n   n a t i v e R e m o v e E v e n t L i s t e n e r . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                         } ; 
                         p r o t o [ L I S T E N E R S _ E V E N T _ L I S T E N E R ]   =   f u n c t i o n   ( )   { 
                                 c o n s t   t a r g e t   =   t h i s   | |   _ g l o b a l ; 
                                 l e t   e v e n t N a m e   =   a r g u m e n t s [ 0 ] ; 
                                 i f   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . t r a n s f e r E v e n t N a m e )   { 
                                         e v e n t N a m e   =   p a t c h O p t i o n s . t r a n s f e r E v e n t N a m e ( e v e n t N a m e ) ; 
                                 } 
                                 c o n s t   l i s t e n e r s   =   [ ] ; 
                                 c o n s t   t a s k s   =   f i n d E v e n t T a s k s ( t a r g e t ,   e v e n t N a m e T o S t r i n g   ?   e v e n t N a m e T o S t r i n g ( e v e n t N a m e )   :   e v e n t N a m e ) ; 
                                 f o r   ( l e t   i   =   0 ;   i   <   t a s k s . l e n g t h ;   i + + )   { 
                                         c o n s t   t a s k   =   t a s k s [ i ] ; 
                                         l e t   d e l e g a t e   =   t a s k . o r i g i n a l D e l e g a t e   ?   t a s k . o r i g i n a l D e l e g a t e   :   t a s k . c a l l b a c k ; 
                                         l i s t e n e r s . p u s h ( d e l e g a t e ) ; 
                                 } 
                                 r e t u r n   l i s t e n e r s ; 
                         } ; 
                         p r o t o [ R E M O V E _ A L L _ L I S T E N E R S _ E V E N T _ L I S T E N E R ]   =   f u n c t i o n   ( )   { 
                                 c o n s t   t a r g e t   =   t h i s   | |   _ g l o b a l ; 
                                 l e t   e v e n t N a m e   =   a r g u m e n t s [ 0 ] ; 
                                 i f   ( ! e v e n t N a m e )   { 
                                         c o n s t   k e y s   =   O b j e c t . k e y s ( t a r g e t ) ; 
                                         f o r   ( l e t   i   =   0 ;   i   <   k e y s . l e n g t h ;   i + + )   { 
                                                 c o n s t   p r o p   =   k e y s [ i ] ; 
                                                 c o n s t   m a t c h   =   E V E N T _ N A M E _ S Y M B O L _ R E G X . e x e c ( p r o p ) ; 
                                                 l e t   e v t N a m e   =   m a t c h   & &   m a t c h [ 1 ] ; 
                                                 / /   i n   n o d e j s   E v e n t E m i t t e r ,   r e m o v e L i s t e n e r   e v e n t   i s 
                                                 / /   u s e d   f o r   m o n i t o r i n g   t h e   r e m o v e L i s t e n e r   c a l l , 
                                                 / /   s o   j u s t   k e e p   r e m o v e L i s t e n e r   e v e n t L i s t e n e r   u n t i l 
                                                 / /   a l l   o t h e r   e v e n t L i s t e n e r s   a r e   r e m o v e d 
                                                 i f   ( e v t N a m e   & &   e v t N a m e   ! = =   ' r e m o v e L i s t e n e r ' )   { 
                                                         t h i s [ R E M O V E _ A L L _ L I S T E N E R S _ E V E N T _ L I S T E N E R ] . c a l l ( t h i s ,   e v t N a m e ) ; 
                                                 } 
                                         } 
                                         / /   r e m o v e   r e m o v e L i s t e n e r   l i s t e n e r   f i n a l l y 
                                         t h i s [ R E M O V E _ A L L _ L I S T E N E R S _ E V E N T _ L I S T E N E R ] . c a l l ( t h i s ,   ' r e m o v e L i s t e n e r ' ) ; 
                                 } 
                                 e l s e   { 
                                         i f   ( p a t c h O p t i o n s   & &   p a t c h O p t i o n s . t r a n s f e r E v e n t N a m e )   { 
                                                 e v e n t N a m e   =   p a t c h O p t i o n s . t r a n s f e r E v e n t N a m e ( e v e n t N a m e ) ; 
                                         } 
                                         c o n s t   s y m b o l E v e n t N a m e s   =   z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ] ; 
                                         i f   ( s y m b o l E v e n t N a m e s )   { 
                                                 c o n s t   s y m b o l E v e n t N a m e   =   s y m b o l E v e n t N a m e s [ F A L S E _ S T R ] ; 
                                                 c o n s t   s y m b o l C a p t u r e E v e n t N a m e   =   s y m b o l E v e n t N a m e s [ T R U E _ S T R ] ; 
                                                 c o n s t   t a s k s   =   t a r g e t [ s y m b o l E v e n t N a m e ] ; 
                                                 c o n s t   c a p t u r e T a s k s   =   t a r g e t [ s y m b o l C a p t u r e E v e n t N a m e ] ; 
                                                 i f   ( t a s k s )   { 
                                                         c o n s t   r e m o v e T a s k s   =   t a s k s . s l i c e ( ) ; 
                                                         f o r   ( l e t   i   =   0 ;   i   <   r e m o v e T a s k s . l e n g t h ;   i + + )   { 
                                                                 c o n s t   t a s k   =   r e m o v e T a s k s [ i ] ; 
                                                                 l e t   d e l e g a t e   =   t a s k . o r i g i n a l D e l e g a t e   ?   t a s k . o r i g i n a l D e l e g a t e   :   t a s k . c a l l b a c k ; 
                                                                 t h i s [ R E M O V E _ E V E N T _ L I S T E N E R ] . c a l l ( t h i s ,   e v e n t N a m e ,   d e l e g a t e ,   t a s k . o p t i o n s ) ; 
                                                         } 
                                                 } 
                                                 i f   ( c a p t u r e T a s k s )   { 
                                                         c o n s t   r e m o v e T a s k s   =   c a p t u r e T a s k s . s l i c e ( ) ; 
                                                         f o r   ( l e t   i   =   0 ;   i   <   r e m o v e T a s k s . l e n g t h ;   i + + )   { 
                                                                 c o n s t   t a s k   =   r e m o v e T a s k s [ i ] ; 
                                                                 l e t   d e l e g a t e   =   t a s k . o r i g i n a l D e l e g a t e   ?   t a s k . o r i g i n a l D e l e g a t e   :   t a s k . c a l l b a c k ; 
                                                                 t h i s [ R E M O V E _ E V E N T _ L I S T E N E R ] . c a l l ( t h i s ,   e v e n t N a m e ,   d e l e g a t e ,   t a s k . o p t i o n s ) ; 
                                                         } 
                                                 } 
                                         } 
                                 } 
                                 i f   ( r e t u r n T a r g e t )   { 
                                         r e t u r n   t h i s ; 
                                 } 
                         } ; 
                         / /   f o r   n a t i v e   t o S t r i n g   p a t c h 
                         a t t a c h O r i g i n T o P a t c h e d ( p r o t o [ A D D _ E V E N T _ L I S T E N E R ] ,   n a t i v e A d d E v e n t L i s t e n e r ) ; 
                         a t t a c h O r i g i n T o P a t c h e d ( p r o t o [ R E M O V E _ E V E N T _ L I S T E N E R ] ,   n a t i v e R e m o v e E v e n t L i s t e n e r ) ; 
                         i f   ( n a t i v e R e m o v e A l l L i s t e n e r s )   { 
                                 a t t a c h O r i g i n T o P a t c h e d ( p r o t o [ R E M O V E _ A L L _ L I S T E N E R S _ E V E N T _ L I S T E N E R ] ,   n a t i v e R e m o v e A l l L i s t e n e r s ) ; 
                         } 
                         i f   ( n a t i v e L i s t e n e r s )   { 
                                 a t t a c h O r i g i n T o P a t c h e d ( p r o t o [ L I S T E N E R S _ E V E N T _ L I S T E N E R ] ,   n a t i v e L i s t e n e r s ) ; 
                         } 
                         r e t u r n   t r u e ; 
                 } 
                 l e t   r e s u l t s   =   [ ] ; 
                 f o r   ( l e t   i   =   0 ;   i   <   a p i s . l e n g t h ;   i + + )   { 
                         r e s u l t s [ i ]   =   p a t c h E v e n t T a r g e t M e t h o d s ( a p i s [ i ] ,   p a t c h O p t i o n s ) ; 
                 } 
                 r e t u r n   r e s u l t s ; 
         } 
         f u n c t i o n   f i n d E v e n t T a s k s ( t a r g e t ,   e v e n t N a m e )   { 
                 i f   ( ! e v e n t N a m e )   { 
                         c o n s t   f o u n d T a s k s   =   [ ] ; 
                         f o r   ( l e t   p r o p   i n   t a r g e t )   { 
                                 c o n s t   m a t c h   =   E V E N T _ N A M E _ S Y M B O L _ R E G X . e x e c ( p r o p ) ; 
                                 l e t   e v t N a m e   =   m a t c h   & &   m a t c h [ 1 ] ; 
                                 i f   ( e v t N a m e   & &   ( ! e v e n t N a m e   | |   e v t N a m e   = = =   e v e n t N a m e ) )   { 
                                         c o n s t   t a s k s   =   t a r g e t [ p r o p ] ; 
                                         i f   ( t a s k s )   { 
                                                 f o r   ( l e t   i   =   0 ;   i   <   t a s k s . l e n g t h ;   i + + )   { 
                                                         f o u n d T a s k s . p u s h ( t a s k s [ i ] ) ; 
                                                 } 
                                         } 
                                 } 
                         } 
                         r e t u r n   f o u n d T a s k s ; 
                 } 
                 l e t   s y m b o l E v e n t N a m e   =   z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ] ; 
                 i f   ( ! s y m b o l E v e n t N a m e )   { 
                         p r e p a r e E v e n t N a m e s ( e v e n t N a m e ) ; 
                         s y m b o l E v e n t N a m e   =   z o n e S y m b o l E v e n t N a m e s $ 1 [ e v e n t N a m e ] ; 
                 } 
                 c o n s t   c a p t u r e F a l s e T a s k s   =   t a r g e t [ s y m b o l E v e n t N a m e [ F A L S E _ S T R ] ] ; 
                 c o n s t   c a p t u r e T r u e T a s k s   =   t a r g e t [ s y m b o l E v e n t N a m e [ T R U E _ S T R ] ] ; 
                 i f   ( ! c a p t u r e F a l s e T a s k s )   { 
                         r e t u r n   c a p t u r e T r u e T a s k s   ?   c a p t u r e T r u e T a s k s . s l i c e ( )   :   [ ] ; 
                 } 
                 e l s e   { 
                         r e t u r n   c a p t u r e T r u e T a s k s   ?   c a p t u r e F a l s e T a s k s . c o n c a t ( c a p t u r e T r u e T a s k s )   : 
                                 c a p t u r e F a l s e T a s k s . s l i c e ( ) ; 
                 } 
         } 
         f u n c t i o n   p a t c h E v e n t P r o t o t y p e ( g l o b a l ,   a p i )   { 
                 c o n s t   E v e n t   =   g l o b a l [ ' E v e n t ' ] ; 
                 i f   ( E v e n t   & &   E v e n t . p r o t o t y p e )   { 
                         a p i . p a t c h M e t h o d ( E v e n t . p r o t o t y p e ,   ' s t o p I m m e d i a t e P r o p a g a t i o n ' ,   ( d e l e g a t e )   = >   f u n c t i o n   ( s e l f ,   a r g s )   { 
                                 s e l f [ I M M E D I A T E _ P R O P A G A T I O N _ S Y M B O L ]   =   t r u e ; 
                                 / /   w e   n e e d   t o   c a l l   t h e   n a t i v e   s t o p I m m e d i a t e P r o p a g a t i o n 
                                 / /   i n   c a s e   i n   s o m e   h y b r i d   a p p l i c a t i o n ,   s o m e   p a r t   o f 
                                 / /   a p p l i c a t i o n   w i l l   b e   c o n t r o l l e d   b y   z o n e ,   s o m e   a r e   n o t 
                                 d e l e g a t e   & &   d e l e g a t e . a p p l y ( s e l f ,   a r g s ) ; 
                         } ) ; 
                 } 
         } 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         f u n c t i o n   p a t c h C a l l b a c k s ( a p i ,   t a r g e t ,   t a r g e t N a m e ,   m e t h o d ,   c a l l b a c k s )   { 
                 c o n s t   s y m b o l   =   Z o n e . _ _ s y m b o l _ _ ( m e t h o d ) ; 
                 i f   ( t a r g e t [ s y m b o l ] )   { 
                         r e t u r n ; 
                 } 
                 c o n s t   n a t i v e D e l e g a t e   =   t a r g e t [ s y m b o l ]   =   t a r g e t [ m e t h o d ] ; 
                 t a r g e t [ m e t h o d ]   =   f u n c t i o n   ( n a m e ,   o p t s ,   o p t i o n s )   { 
                         i f   ( o p t s   & &   o p t s . p r o t o t y p e )   { 
                                 c a l l b a c k s . f o r E a c h ( f u n c t i o n   ( c a l l b a c k )   { 
                                         c o n s t   s o u r c e   =   ` $ { t a r g e t N a m e } . $ { m e t h o d } : : `   +   c a l l b a c k ; 
                                         c o n s t   p r o t o t y p e   =   o p t s . p r o t o t y p e ; 
                                         i f   ( p r o t o t y p e . h a s O w n P r o p e r t y ( c a l l b a c k ) )   { 
                                                 c o n s t   d e s c r i p t o r   =   a p i . O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r ( p r o t o t y p e ,   c a l l b a c k ) ; 
                                                 i f   ( d e s c r i p t o r   & &   d e s c r i p t o r . v a l u e )   { 
                                                         d e s c r i p t o r . v a l u e   =   a p i . w r a p W i t h C u r r e n t Z o n e ( d e s c r i p t o r . v a l u e ,   s o u r c e ) ; 
                                                         a p i . _ r e d e f i n e P r o p e r t y ( o p t s . p r o t o t y p e ,   c a l l b a c k ,   d e s c r i p t o r ) ; 
                                                 } 
                                                 e l s e   i f   ( p r o t o t y p e [ c a l l b a c k ] )   { 
                                                         p r o t o t y p e [ c a l l b a c k ]   =   a p i . w r a p W i t h C u r r e n t Z o n e ( p r o t o t y p e [ c a l l b a c k ] ,   s o u r c e ) ; 
                                                 } 
                                         } 
                                         e l s e   i f   ( p r o t o t y p e [ c a l l b a c k ] )   { 
                                                 p r o t o t y p e [ c a l l b a c k ]   =   a p i . w r a p W i t h C u r r e n t Z o n e ( p r o t o t y p e [ c a l l b a c k ] ,   s o u r c e ) ; 
                                         } 
                                 } ) ; 
                         } 
                         r e t u r n   n a t i v e D e l e g a t e . c a l l ( t a r g e t ,   n a m e ,   o p t s ,   o p t i o n s ) ; 
                 } ; 
                 a p i . a t t a c h O r i g i n T o P a t c h e d ( t a r g e t [ m e t h o d ] ,   n a t i v e D e l e g a t e ) ; 
         } 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         c o n s t   g l o b a l E v e n t H a n d l e r s E v e n t N a m e s   =   [ 
                 ' a b o r t ' , 
                 ' a n i m a t i o n c a n c e l ' , 
                 ' a n i m a t i o n e n d ' , 
                 ' a n i m a t i o n i t e r a t i o n ' , 
                 ' a u x c l i c k ' , 
                 ' b e f o r e i n p u t ' , 
                 ' b l u r ' , 
                 ' c a n c e l ' , 
                 ' c a n p l a y ' , 
                 ' c a n p l a y t h r o u g h ' , 
                 ' c h a n g e ' , 
                 ' c o m p o s i t i o n s t a r t ' , 
                 ' c o m p o s i t i o n u p d a t e ' , 
                 ' c o m p o s i t i o n e n d ' , 
                 ' c u e c h a n g e ' , 
                 ' c l i c k ' , 
                 ' c l o s e ' , 
                 ' c o n t e x t m e n u ' , 
                 ' c u r e c h a n g e ' , 
                 ' d b l c l i c k ' , 
                 ' d r a g ' , 
                 ' d r a g e n d ' , 
                 ' d r a g e n t e r ' , 
                 ' d r a g e x i t ' , 
                 ' d r a g l e a v e ' , 
                 ' d r a g o v e r ' , 
                 ' d r o p ' , 
                 ' d u r a t i o n c h a n g e ' , 
                 ' e m p t i e d ' , 
                 ' e n d e d ' , 
                 ' e r r o r ' , 
                 ' f o c u s ' , 
                 ' f o c u s i n ' , 
                 ' f o c u s o u t ' , 
                 ' g o t p o i n t e r c a p t u r e ' , 
                 ' i n p u t ' , 
                 ' i n v a l i d ' , 
                 ' k e y d o w n ' , 
                 ' k e y p r e s s ' , 
                 ' k e y u p ' , 
                 ' l o a d ' , 
                 ' l o a d s t a r t ' , 
                 ' l o a d e d d a t a ' , 
                 ' l o a d e d m e t a d a t a ' , 
                 ' l o s t p o i n t e r c a p t u r e ' , 
                 ' m o u s e d o w n ' , 
                 ' m o u s e e n t e r ' , 
                 ' m o u s e l e a v e ' , 
                 ' m o u s e m o v e ' , 
                 ' m o u s e o u t ' , 
                 ' m o u s e o v e r ' , 
                 ' m o u s e u p ' , 
                 ' m o u s e w h e e l ' , 
                 ' o r i e n t a t i o n c h a n g e ' , 
                 ' p a u s e ' , 
                 ' p l a y ' , 
                 ' p l a y i n g ' , 
                 ' p o i n t e r c a n c e l ' , 
                 ' p o i n t e r d o w n ' , 
                 ' p o i n t e r e n t e r ' , 
                 ' p o i n t e r l e a v e ' , 
                 ' p o i n t e r l o c k c h a n g e ' , 
                 ' m o z p o i n t e r l o c k c h a n g e ' , 
                 ' w e b k i t p o i n t e r l o c k e r c h a n g e ' , 
                 ' p o i n t e r l o c k e r r o r ' , 
                 ' m o z p o i n t e r l o c k e r r o r ' , 
                 ' w e b k i t p o i n t e r l o c k e r r o r ' , 
                 ' p o i n t e r m o v e ' , 
                 ' p o i n t o u t ' , 
                 ' p o i n t e r o v e r ' , 
                 ' p o i n t e r u p ' , 
                 ' p r o g r e s s ' , 
                 ' r a t e c h a n g e ' , 
                 ' r e s e t ' , 
                 ' r e s i z e ' , 
                 ' s c r o l l ' , 
                 ' s e e k e d ' , 
                 ' s e e k i n g ' , 
                 ' s e l e c t ' , 
                 ' s e l e c t i o n c h a n g e ' , 
                 ' s e l e c t s t a r t ' , 
                 ' s h o w ' , 
                 ' s o r t ' , 
                 ' s t a l l e d ' , 
                 ' s u b m i t ' , 
                 ' s u s p e n d ' , 
                 ' t i m e u p d a t e ' , 
                 ' v o l u m e c h a n g e ' , 
                 ' t o u c h c a n c e l ' , 
                 ' t o u c h m o v e ' , 
                 ' t o u c h s t a r t ' , 
                 ' t o u c h e n d ' , 
                 ' t r a n s i t i o n c a n c e l ' , 
                 ' t r a n s i t i o n e n d ' , 
                 ' w a i t i n g ' , 
                 ' w h e e l ' 
         ] ; 
         c o n s t   d o c u m e n t E v e n t N a m e s   =   [ 
                 ' a f t e r s c r i p t e x e c u t e ' ,   ' b e f o r e s c r i p t e x e c u t e ' ,   ' D O M C o n t e n t L o a d e d ' ,   ' f r e e z e ' ,   ' f u l l s c r e e n c h a n g e ' , 
                 ' m o z f u l l s c r e e n c h a n g e ' ,   ' w e b k i t f u l l s c r e e n c h a n g e ' ,   ' m s f u l l s c r e e n c h a n g e ' ,   ' f u l l s c r e e n e r r o r ' , 
                 ' m o z f u l l s c r e e n e r r o r ' ,   ' w e b k i t f u l l s c r e e n e r r o r ' ,   ' m s f u l l s c r e e n e r r o r ' ,   ' r e a d y s t a t e c h a n g e ' , 
                 ' v i s i b i l i t y c h a n g e ' ,   ' r e s u m e ' 
         ] ; 
         c o n s t   w i n d o w E v e n t N a m e s   =   [ 
                 ' a b s o l u t e d e v i c e o r i e n t a t i o n ' , 
                 ' a f t e r i n p u t ' , 
                 ' a f t e r p r i n t ' , 
                 ' a p p i n s t a l l e d ' , 
                 ' b e f o r e i n s t a l l p r o m p t ' , 
                 ' b e f o r e p r i n t ' , 
                 ' b e f o r e u n l o a d ' , 
                 ' d e v i c e l i g h t ' , 
                 ' d e v i c e m o t i o n ' , 
                 ' d e v i c e o r i e n t a t i o n ' , 
                 ' d e v i c e o r i e n t a t i o n a b s o l u t e ' , 
                 ' d e v i c e p r o x i m i t y ' , 
                 ' h a s h c h a n g e ' , 
                 ' l a n g u a g e c h a n g e ' , 
                 ' m e s s a g e ' , 
                 ' m o z b e f o r e p a i n t ' , 
                 ' o f f l i n e ' , 
                 ' o n l i n e ' , 
                 ' p a i n t ' , 
                 ' p a g e s h o w ' , 
                 ' p a g e h i d e ' , 
                 ' p o p s t a t e ' , 
                 ' r e j e c t i o n h a n d l e d ' , 
                 ' s t o r a g e ' , 
                 ' u n h a n d l e d r e j e c t i o n ' , 
                 ' u n l o a d ' , 
                 ' u s e r p r o x i m i t y ' , 
                 ' v r d i s p l a y c o n n e c t e d ' , 
                 ' v r d i s p l a y d i s c o n n e c t e d ' , 
                 ' v r d i s p l a y p r e s e n t c h a n g e ' 
         ] ; 
         c o n s t   h t m l E l e m e n t E v e n t N a m e s   =   [ 
                 ' b e f o r e c o p y ' ,   ' b e f o r e c u t ' ,   ' b e f o r e p a s t e ' ,   ' c o p y ' ,   ' c u t ' ,   ' p a s t e ' ,   ' d r a g s t a r t ' ,   ' l o a d e n d ' , 
                 ' a n i m a t i o n s t a r t ' ,   ' s e a r c h ' ,   ' t r a n s i t i o n r u n ' ,   ' t r a n s i t i o n s t a r t ' ,   ' w e b k i t a n i m a t i o n e n d ' , 
                 ' w e b k i t a n i m a t i o n i t e r a t i o n ' ,   ' w e b k i t a n i m a t i o n s t a r t ' ,   ' w e b k i t t r a n s i t i o n e n d ' 
         ] ; 
         c o n s t   m e d i a E l e m e n t E v e n t N a m e s   =   [ ' e n c r y p t e d ' ,   ' w a i t i n g f o r k e y ' ,   ' m s n e e d k e y ' ,   ' m o z i n t e r r u p t b e g i n ' ,   ' m o z i n t e r r u p t e n d ' ] ; 
         c o n s t   i e E l e m e n t E v e n t N a m e s   =   [ 
                 ' a c t i v a t e ' , 
                 ' a f t e r u p d a t e ' , 
                 ' a r i a r e q u e s t ' , 
                 ' b e f o r e a c t i v a t e ' , 
                 ' b e f o r e d e a c t i v a t e ' , 
                 ' b e f o r e e d i t f o c u s ' , 
                 ' b e f o r e u p d a t e ' , 
                 ' c e l l c h a n g e ' , 
                 ' c o n t r o l s e l e c t ' , 
                 ' d a t a a v a i l a b l e ' , 
                 ' d a t a s e t c h a n g e d ' , 
                 ' d a t a s e t c o m p l e t e ' , 
                 ' e r r o r u p d a t e ' , 
                 ' f i l t e r c h a n g e ' , 
                 ' l a y o u t c o m p l e t e ' , 
                 ' l o s e c a p t u r e ' , 
                 ' m o v e ' , 
                 ' m o v e e n d ' , 
                 ' m o v e s t a r t ' , 
                 ' p r o p e r t y c h a n g e ' , 
                 ' r e s i z e e n d ' , 
                 ' r e s i z e s t a r t ' , 
                 ' r o w e n t e r ' , 
                 ' r o w e x i t ' , 
                 ' r o w s d e l e t e ' , 
                 ' r o w s i n s e r t e d ' , 
                 ' c o m m a n d ' , 
                 ' c o m p a s s n e e d s c a l i b r a t i o n ' , 
                 ' d e a c t i v a t e ' , 
                 ' h e l p ' , 
                 ' m s c o n t e n t z o o m ' , 
                 ' m s m a n i p u l a t i o n s t a t e c h a n g e d ' , 
                 ' m s g e s t u r e c h a n g e ' , 
                 ' m s g e s t u r e d o u b l e t a p ' , 
                 ' m s g e s t u r e e n d ' , 
                 ' m s g e s t u r e h o l d ' , 
                 ' m s g e s t u r e s t a r t ' , 
                 ' m s g e s t u r e t a p ' , 
                 ' m s g o t p o i n t e r c a p t u r e ' , 
                 ' m s i n e r t i a s t a r t ' , 
                 ' m s l o s t p o i n t e r c a p t u r e ' , 
                 ' m s p o i n t e r c a n c e l ' , 
                 ' m s p o i n t e r d o w n ' , 
                 ' m s p o i n t e r e n t e r ' , 
                 ' m s p o i n t e r h o v e r ' , 
                 ' m s p o i n t e r l e a v e ' , 
                 ' m s p o i n t e r m o v e ' , 
                 ' m s p o i n t e r o u t ' , 
                 ' m s p o i n t e r o v e r ' , 
                 ' m s p o i n t e r u p ' , 
                 ' p o i n t e r o u t ' , 
                 ' m s s i t e m o d e j u m p l i s t i t e m r e m o v e d ' , 
                 ' m s t h u m b n a i l c l i c k ' , 
                 ' s t o p ' , 
                 ' s t o r a g e c o m m i t ' 
         ] ; 
         c o n s t   w e b g l E v e n t N a m e s   =   [ ' w e b g l c o n t e x t r e s t o r e d ' ,   ' w e b g l c o n t e x t l o s t ' ,   ' w e b g l c o n t e x t c r e a t i o n e r r o r ' ] ; 
         c o n s t   f o r m E v e n t N a m e s   =   [ ' a u t o c o m p l e t e ' ,   ' a u t o c o m p l e t e e r r o r ' ] ; 
         c o n s t   d e t a i l E v e n t N a m e s   =   [ ' t o g g l e ' ] ; 
         c o n s t   f r a m e E v e n t N a m e s   =   [ ' l o a d ' ] ; 
         c o n s t   f r a m e S e t E v e n t N a m e s   =   [ ' b l u r ' ,   ' e r r o r ' ,   ' f o c u s ' ,   ' l o a d ' ,   ' r e s i z e ' ,   ' s c r o l l ' ,   ' m e s s a g e e r r o r ' ] ; 
         c o n s t   m a r q u e e E v e n t N a m e s   =   [ ' b o u n c e ' ,   ' f i n i s h ' ,   ' s t a r t ' ] ; 
         c o n s t   X M L H t t p R e q u e s t E v e n t N a m e s   =   [ 
                 ' l o a d s t a r t ' ,   ' p r o g r e s s ' ,   ' a b o r t ' ,   ' e r r o r ' ,   ' l o a d ' ,   ' p r o g r e s s ' ,   ' t i m e o u t ' ,   ' l o a d e n d ' , 
                 ' r e a d y s t a t e c h a n g e ' 
         ] ; 
         c o n s t   I D B I n d e x E v e n t N a m e s   =   [ ' u p g r a d e n e e d e d ' ,   ' c o m p l e t e ' ,   ' a b o r t ' ,   ' s u c c e s s ' ,   ' e r r o r ' ,   ' b l o c k e d ' ,   ' v e r s i o n c h a n g e ' ,   ' c l o s e ' ] ; 
         c o n s t   w e b s o c k e t E v e n t N a m e s   =   [ ' c l o s e ' ,   ' e r r o r ' ,   ' o p e n ' ,   ' m e s s a g e ' ] ; 
         c o n s t   w o r k e r E v e n t N a m e s   =   [ ' e r r o r ' ,   ' m e s s a g e ' ] ; 
         c o n s t   e v e n t N a m e s   =   g l o b a l E v e n t H a n d l e r s E v e n t N a m e s . c o n c a t ( w e b g l E v e n t N a m e s ,   f o r m E v e n t N a m e s ,   d e t a i l E v e n t N a m e s ,   d o c u m e n t E v e n t N a m e s ,   w i n d o w E v e n t N a m e s ,   h t m l E l e m e n t E v e n t N a m e s ,   i e E l e m e n t E v e n t N a m e s ) ; 
         f u n c t i o n   f i l t e r P r o p e r t i e s ( t a r g e t ,   o n P r o p e r t i e s ,   i g n o r e P r o p e r t i e s )   { 
                 i f   ( ! i g n o r e P r o p e r t i e s   | |   i g n o r e P r o p e r t i e s . l e n g t h   = = =   0 )   { 
                         r e t u r n   o n P r o p e r t i e s ; 
                 } 
                 c o n s t   t i p   =   i g n o r e P r o p e r t i e s . f i l t e r ( i p   = >   i p . t a r g e t   = = =   t a r g e t ) ; 
                 i f   ( ! t i p   | |   t i p . l e n g t h   = = =   0 )   { 
                         r e t u r n   o n P r o p e r t i e s ; 
                 } 
                 c o n s t   t a r g e t I g n o r e P r o p e r t i e s   =   t i p [ 0 ] . i g n o r e P r o p e r t i e s ; 
                 r e t u r n   o n P r o p e r t i e s . f i l t e r ( o p   = >   t a r g e t I g n o r e P r o p e r t i e s . i n d e x O f ( o p )   = = =   - 1 ) ; 
         } 
         f u n c t i o n   p a t c h F i l t e r e d P r o p e r t i e s ( t a r g e t ,   o n P r o p e r t i e s ,   i g n o r e P r o p e r t i e s ,   p r o t o t y p e )   { 
                 / /   c h e c k   w h e t h e r   t a r g e t   i s   a v a i l a b l e ,   s o m e t i m e s   t a r g e t   w i l l   b e   u n d e f i n e d 
                 / /   b e c a u s e   d i f f e r e n t   b r o w s e r   o r   s o m e   3 r d   p a r t y   p l u g i n . 
                 i f   ( ! t a r g e t )   { 
                         r e t u r n ; 
                 } 
                 c o n s t   f i l t e r e d P r o p e r t i e s   =   f i l t e r P r o p e r t i e s ( t a r g e t ,   o n P r o p e r t i e s ,   i g n o r e P r o p e r t i e s ) ; 
                 p a t c h O n P r o p e r t i e s ( t a r g e t ,   f i l t e r e d P r o p e r t i e s ,   p r o t o t y p e ) ; 
         } 
         f u n c t i o n   p r o p e r t y D e s c r i p t o r P a t c h ( a p i ,   _ g l o b a l )   { 
                 i f   ( i s N o d e   & &   ! i s M i x )   { 
                         r e t u r n ; 
                 } 
                 i f   ( Z o n e [ a p i . s y m b o l ( ' p a t c h E v e n t s ' ) ] )   { 
                         / /   e v e n t s   a r e   a l r e a d y   b e e n   p a t c h e d   b y   l e g a c y   p a t c h . 
                         r e t u r n ; 
                 } 
                 c o n s t   s u p p o r t s W e b S o c k e t   =   t y p e o f   W e b S o c k e t   ! = =   ' u n d e f i n e d ' ; 
                 c o n s t   i g n o r e P r o p e r t i e s   =   _ g l o b a l [ ' _ _ Z o n e _ i g n o r e _ o n _ p r o p e r t i e s ' ] ; 
                 / /   f o r   b r o w s e r s   t h a t   w e   c a n   p a t c h   t h e   d e s c r i p t o r :     C h r o m e   &   F i r e f o x 
                 i f   ( i s B r o w s e r )   { 
                         c o n s t   i n t e r n a l W i n d o w   =   w i n d o w ; 
                         c o n s t   i g n o r e E r r o r P r o p e r t i e s   =   i s I E   ?   [ {   t a r g e t :   i n t e r n a l W i n d o w ,   i g n o r e P r o p e r t i e s :   [ ' e r r o r ' ]   } ]   :   [ ] ; 
                         / /   i n   I E / E d g e ,   o n P r o p   n o t   e x i s t   i n   w i n d o w   o b j e c t ,   b u t   i n   W i n d o w P r o t o t y p e 
                         / /   s o   w e   n e e d   t o   p a s s   W i n d o w P r o t o t y p e   t o   c h e c k   o n P r o p   e x i s t   o r   n o t 
                         p a t c h F i l t e r e d P r o p e r t i e s ( i n t e r n a l W i n d o w ,   e v e n t N a m e s . c o n c a t ( [ ' m e s s a g e e r r o r ' ] ) ,   i g n o r e P r o p e r t i e s   ?   i g n o r e P r o p e r t i e s . c o n c a t ( i g n o r e E r r o r P r o p e r t i e s )   :   i g n o r e P r o p e r t i e s ,   O b j e c t G e t P r o t o t y p e O f ( i n t e r n a l W i n d o w ) ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( D o c u m e n t . p r o t o t y p e ,   e v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         i f   ( t y p e o f   i n t e r n a l W i n d o w [ ' S V G E l e m e n t ' ]   ! = =   ' u n d e f i n e d ' )   { 
                                 p a t c h F i l t e r e d P r o p e r t i e s ( i n t e r n a l W i n d o w [ ' S V G E l e m e n t ' ] . p r o t o t y p e ,   e v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         } 
                         p a t c h F i l t e r e d P r o p e r t i e s ( E l e m e n t . p r o t o t y p e ,   e v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( H T M L E l e m e n t . p r o t o t y p e ,   e v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( H T M L M e d i a E l e m e n t . p r o t o t y p e ,   m e d i a E l e m e n t E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( H T M L F r a m e S e t E l e m e n t . p r o t o t y p e ,   w i n d o w E v e n t N a m e s . c o n c a t ( f r a m e S e t E v e n t N a m e s ) ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( H T M L B o d y E l e m e n t . p r o t o t y p e ,   w i n d o w E v e n t N a m e s . c o n c a t ( f r a m e S e t E v e n t N a m e s ) ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( H T M L F r a m e E l e m e n t . p r o t o t y p e ,   f r a m e E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( H T M L I F r a m e E l e m e n t . p r o t o t y p e ,   f r a m e E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         c o n s t   H T M L M a r q u e e E l e m e n t   =   i n t e r n a l W i n d o w [ ' H T M L M a r q u e e E l e m e n t ' ] ; 
                         i f   ( H T M L M a r q u e e E l e m e n t )   { 
                                 p a t c h F i l t e r e d P r o p e r t i e s ( H T M L M a r q u e e E l e m e n t . p r o t o t y p e ,   m a r q u e e E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         } 
                         c o n s t   W o r k e r   =   i n t e r n a l W i n d o w [ ' W o r k e r ' ] ; 
                         i f   ( W o r k e r )   { 
                                 p a t c h F i l t e r e d P r o p e r t i e s ( W o r k e r . p r o t o t y p e ,   w o r k e r E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         } 
                 } 
                 c o n s t   X M L H t t p R e q u e s t   =   _ g l o b a l [ ' X M L H t t p R e q u e s t ' ] ; 
                 i f   ( X M L H t t p R e q u e s t )   { 
                         / /   X M L H t t p R e q u e s t   i s   n o t   a v a i l a b l e   i n   S e r v i c e W o r k e r ,   s o   w e   n e e d   t o   c h e c k   h e r e 
                         p a t c h F i l t e r e d P r o p e r t i e s ( X M L H t t p R e q u e s t . p r o t o t y p e ,   X M L H t t p R e q u e s t E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                 } 
                 c o n s t   X M L H t t p R e q u e s t E v e n t T a r g e t   =   _ g l o b a l [ ' X M L H t t p R e q u e s t E v e n t T a r g e t ' ] ; 
                 i f   ( X M L H t t p R e q u e s t E v e n t T a r g e t )   { 
                         p a t c h F i l t e r e d P r o p e r t i e s ( X M L H t t p R e q u e s t E v e n t T a r g e t   & &   X M L H t t p R e q u e s t E v e n t T a r g e t . p r o t o t y p e ,   X M L H t t p R e q u e s t E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                 } 
                 i f   ( t y p e o f   I D B I n d e x   ! = =   ' u n d e f i n e d ' )   { 
                         p a t c h F i l t e r e d P r o p e r t i e s ( I D B I n d e x . p r o t o t y p e ,   I D B I n d e x E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( I D B R e q u e s t . p r o t o t y p e ,   I D B I n d e x E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( I D B O p e n D B R e q u e s t . p r o t o t y p e ,   I D B I n d e x E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( I D B D a t a b a s e . p r o t o t y p e ,   I D B I n d e x E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( I D B T r a n s a c t i o n . p r o t o t y p e ,   I D B I n d e x E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                         p a t c h F i l t e r e d P r o p e r t i e s ( I D B C u r s o r . p r o t o t y p e ,   I D B I n d e x E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                 } 
                 i f   ( s u p p o r t s W e b S o c k e t )   { 
                         p a t c h F i l t e r e d P r o p e r t i e s ( W e b S o c k e t . p r o t o t y p e ,   w e b s o c k e t E v e n t N a m e s ,   i g n o r e P r o p e r t i e s ) ; 
                 } 
         } 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         Z o n e . _ _ l o a d _ p a t c h ( ' u t i l ' ,   ( g l o b a l ,   Z o n e ,   a p i )   = >   { 
                 a p i . p a t c h O n P r o p e r t i e s   =   p a t c h O n P r o p e r t i e s ; 
                 a p i . p a t c h M e t h o d   =   p a t c h M e t h o d ; 
                 a p i . b i n d A r g u m e n t s   =   b i n d A r g u m e n t s ; 
                 a p i . p a t c h M a c r o T a s k   =   p a t c h M a c r o T a s k ; 
                 / /   I n   e a r l i e r   v e r s i o n   o f   z o n e . j s   ( < 0 . 9 . 0 ) ,   w e   u s e   e n v   n a m e   ` _ _ z o n e _ s y m b o l _ _ B L A C K _ L I S T E D _ E V E N T S `   t o 
                 / /   d e f i n e   w h i c h   e v e n t s   w i l l   n o t   b e   p a t c h e d   b y   ` Z o n e . j s ` . 
                 / /   I n   n e w e r   v e r s i o n   ( > = 0 . 9 . 0 ) ,   w e   c h a n g e   t h e   e n v   n a m e   t o   ` _ _ z o n e _ s y m b o l _ _ U N P A T C H E D _ E V E N T S `   t o   k e e p 
                 / /   t h e   n a m e   c o n s i s t e n t   w i t h   a n g u l a r   r e p o . 
                 / /   T h e     ` _ _ z o n e _ s y m b o l _ _ B L A C K _ L I S T E D _ E V E N T S `   i s   d e p r e c a t e d ,   b u t   i t   i s   s t i l l   b e   s u p p o r t e d   f o r 
                 / /   b a c k w a r d s   c o m p a t i b i l i t y . 
                 c o n s t   S Y M B O L _ B L A C K _ L I S T E D _ E V E N T S   =   Z o n e . _ _ s y m b o l _ _ ( ' B L A C K _ L I S T E D _ E V E N T S ' ) ; 
                 c o n s t   S Y M B O L _ U N P A T C H E D _ E V E N T S   =   Z o n e . _ _ s y m b o l _ _ ( ' U N P A T C H E D _ E V E N T S ' ) ; 
                 i f   ( g l o b a l [ S Y M B O L _ U N P A T C H E D _ E V E N T S ] )   { 
                         g l o b a l [ S Y M B O L _ B L A C K _ L I S T E D _ E V E N T S ]   =   g l o b a l [ S Y M B O L _ U N P A T C H E D _ E V E N T S ] ; 
                 } 
                 i f   ( g l o b a l [ S Y M B O L _ B L A C K _ L I S T E D _ E V E N T S ] )   { 
                         Z o n e [ S Y M B O L _ B L A C K _ L I S T E D _ E V E N T S ]   =   Z o n e [ S Y M B O L _ U N P A T C H E D _ E V E N T S ]   = 
                                 g l o b a l [ S Y M B O L _ B L A C K _ L I S T E D _ E V E N T S ] ; 
                 } 
                 a p i . p a t c h E v e n t P r o t o t y p e   =   p a t c h E v e n t P r o t o t y p e ; 
                 a p i . p a t c h E v e n t T a r g e t   =   p a t c h E v e n t T a r g e t ; 
                 a p i . i s I E O r E d g e   =   i s I E O r E d g e ; 
                 a p i . O b j e c t D e f i n e P r o p e r t y   =   O b j e c t D e f i n e P r o p e r t y ; 
                 a p i . O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r   =   O b j e c t G e t O w n P r o p e r t y D e s c r i p t o r ; 
                 a p i . O b j e c t C r e a t e   =   O b j e c t C r e a t e ; 
                 a p i . A r r a y S l i c e   =   A r r a y S l i c e ; 
                 a p i . p a t c h C l a s s   =   p a t c h C l a s s ; 
                 a p i . w r a p W i t h C u r r e n t Z o n e   =   w r a p W i t h C u r r e n t Z o n e ; 
                 a p i . f i l t e r P r o p e r t i e s   =   f i l t e r P r o p e r t i e s ; 
                 a p i . a t t a c h O r i g i n T o P a t c h e d   =   a t t a c h O r i g i n T o P a t c h e d ; 
                 a p i . _ r e d e f i n e P r o p e r t y   =   O b j e c t . d e f i n e P r o p e r t y ; 
                 a p i . p a t c h C a l l b a c k s   =   p a t c h C a l l b a c k s ; 
                 a p i . g e t G l o b a l O b j e c t s   =   ( )   = >   ( {   g l o b a l S o u r c e s ,   z o n e S y m b o l E v e n t N a m e s :   z o n e S y m b o l E v e n t N a m e s $ 1 ,   e v e n t N a m e s ,   i s B r o w s e r ,   i s M i x ,   i s N o d e ,   T R U E _ S T R , 
                         F A L S E _ S T R ,   Z O N E _ S Y M B O L _ P R E F I X ,   A D D _ E V E N T _ L I S T E N E R _ S T R ,   R E M O V E _ E V E N T _ L I S T E N E R _ S T R   } ) ; 
         } ) ; 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         c o n s t   t a s k S y m b o l   =   z o n e S y m b o l ( ' z o n e T a s k ' ) ; 
         f u n c t i o n   p a t c h T i m e r ( w i n d o w ,   s e t N a m e ,   c a n c e l N a m e ,   n a m e S u f f i x )   { 
                 l e t   s e t N a t i v e   =   n u l l ; 
                 l e t   c l e a r N a t i v e   =   n u l l ; 
                 s e t N a m e   + =   n a m e S u f f i x ; 
                 c a n c e l N a m e   + =   n a m e S u f f i x ; 
                 c o n s t   t a s k s B y H a n d l e I d   =   { } ; 
                 f u n c t i o n   s c h e d u l e T a s k ( t a s k )   { 
                         c o n s t   d a t a   =   t a s k . d a t a ; 
                         f u n c t i o n   t i m e r ( )   { 
                                 t r y   { 
                                         t a s k . i n v o k e . a p p l y ( t h i s ,   a r g u m e n t s ) ; 
                                 } 
                                 f i n a l l y   { 
                                         / /   i s s u e - 9 3 4 ,   t a s k   w i l l   b e   c a n c e l l e d 
                                         / /   e v e n   i t   i s   a   p e r i o d i c   t a s k   s u c h   a s 
                                         / /   s e t I n t e r v a l 
                                         i f   ( ! ( t a s k . d a t a   & &   t a s k . d a t a . i s P e r i o d i c ) )   { 
                                                 i f   ( t y p e o f   d a t a . h a n d l e I d   = = =   ' n u m b e r ' )   { 
                                                         / /   i n   n o n - n o d e j s   e n v ,   w e   r e m o v e   t i m e r I d 
                                                         / /   f r o m   l o c a l   c a c h e 
                                                         d e l e t e   t a s k s B y H a n d l e I d [ d a t a . h a n d l e I d ] ; 
                                                 } 
                                                 e l s e   i f   ( d a t a . h a n d l e I d )   { 
                                                         / /   N o d e   r e t u r n s   c o m p l e x   o b j e c t s   a s   h a n d l e I d s 
                                                         / /   w e   r e m o v e   t a s k   r e f e r e n c e   f r o m   t i m e r   o b j e c t 
                                                         d a t a . h a n d l e I d [ t a s k S y m b o l ]   =   n u l l ; 
                                                 } 
                                         } 
                                 } 
                         } 
                         d a t a . a r g s [ 0 ]   =   t i m e r ; 
                         d a t a . h a n d l e I d   =   s e t N a t i v e . a p p l y ( w i n d o w ,   d a t a . a r g s ) ; 
                         r e t u r n   t a s k ; 
                 } 
                 f u n c t i o n   c l e a r T a s k ( t a s k )   {   r e t u r n   c l e a r N a t i v e ( t a s k . d a t a . h a n d l e I d ) ;   } 
                 s e t N a t i v e   = 
                         p a t c h M e t h o d ( w i n d o w ,   s e t N a m e ,   ( d e l e g a t e )   = >   f u n c t i o n   ( s e l f ,   a r g s )   { 
                                 i f   ( t y p e o f   a r g s [ 0 ]   = = =   ' f u n c t i o n ' )   { 
                                         c o n s t   o p t i o n s   =   { 
                                                 i s P e r i o d i c :   n a m e S u f f i x   = = =   ' I n t e r v a l ' , 
                                                 d e l a y :   ( n a m e S u f f i x   = = =   ' T i m e o u t '   | |   n a m e S u f f i x   = = =   ' I n t e r v a l ' )   ?   a r g s [ 1 ]   | |   0   : 
                                                         u n d e f i n e d , 
                                                 a r g s :   a r g s 
                                         } ; 
                                         c o n s t   t a s k   =   s c h e d u l e M a c r o T a s k W i t h C u r r e n t Z o n e ( s e t N a m e ,   a r g s [ 0 ] ,   o p t i o n s ,   s c h e d u l e T a s k ,   c l e a r T a s k ) ; 
                                         i f   ( ! t a s k )   { 
                                                 r e t u r n   t a s k ; 
                                         } 
                                         / /   N o d e . j s   m u s t   a d d i t i o n a l l y   s u p p o r t   t h e   r e f   a n d   u n r e f   f u n c t i o n s . 
                                         c o n s t   h a n d l e   =   t a s k . d a t a . h a n d l e I d ; 
                                         i f   ( t y p e o f   h a n d l e   = = =   ' n u m b e r ' )   { 
                                                 / /   f o r   n o n   n o d e j s   e n v ,   w e   s a v e   h a n d l e I d :   t a s k 
                                                 / /   m a p p i n g   i n   l o c a l   c a c h e   f o r   c l e a r T i m e o u t 
                                                 t a s k s B y H a n d l e I d [ h a n d l e ]   =   t a s k ; 
                                         } 
                                         e l s e   i f   ( h a n d l e )   { 
                                                 / /   f o r   n o d e j s   e n v ,   w e   s a v e   t a s k 
                                                 / /   r e f e r e n c e   i n   t i m e r I d   O b j e c t   f o r   c l e a r T i m e o u t 
                                                 h a n d l e [ t a s k S y m b o l ]   =   t a s k ; 
                                         } 
                                         / /   c h e c k   w h e t h e r   h a n d l e   i s   n u l l ,   b e c a u s e   s o m e   p o l y f i l l   o r   b r o w s e r 
                                         / /   m a y   r e t u r n   u n d e f i n e d   f r o m   s e t T i m e o u t / s e t I n t e r v a l / s e t I m m e d i a t e / r e q u e s t A n i m a t i o n F r a m e 
                                         i f   ( h a n d l e   & &   h a n d l e . r e f   & &   h a n d l e . u n r e f   & &   t y p e o f   h a n d l e . r e f   = = =   ' f u n c t i o n '   & & 
                                                 t y p e o f   h a n d l e . u n r e f   = = =   ' f u n c t i o n ' )   { 
                                                 t a s k . r e f   =   h a n d l e . r e f . b i n d ( h a n d l e ) ; 
                                                 t a s k . u n r e f   =   h a n d l e . u n r e f . b i n d ( h a n d l e ) ; 
                                         } 
                                         i f   ( t y p e o f   h a n d l e   = = =   ' n u m b e r '   | |   h a n d l e )   { 
                                                 r e t u r n   h a n d l e ; 
                                         } 
                                         r e t u r n   t a s k ; 
                                 } 
                                 e l s e   { 
                                         / /   c a u s e   a n   e r r o r   b y   c a l l i n g   i t   d i r e c t l y . 
                                         r e t u r n   d e l e g a t e . a p p l y ( w i n d o w ,   a r g s ) ; 
                                 } 
                         } ) ; 
                 c l e a r N a t i v e   = 
                         p a t c h M e t h o d ( w i n d o w ,   c a n c e l N a m e ,   ( d e l e g a t e )   = >   f u n c t i o n   ( s e l f ,   a r g s )   { 
                                 c o n s t   i d   =   a r g s [ 0 ] ; 
                                 l e t   t a s k ; 
                                 i f   ( t y p e o f   i d   = = =   ' n u m b e r ' )   { 
                                         / /   n o n   n o d e j s   e n v . 
                                         t a s k   =   t a s k s B y H a n d l e I d [ i d ] ; 
                                 } 
                                 e l s e   { 
                                         / /   n o d e j s   e n v . 
                                         t a s k   =   i d   & &   i d [ t a s k S y m b o l ] ; 
                                         / /   o t h e r   e n v i r o n m e n t s . 
                                         i f   ( ! t a s k )   { 
                                                 t a s k   =   i d ; 
                                         } 
                                 } 
                                 i f   ( t a s k   & &   t y p e o f   t a s k . t y p e   = = =   ' s t r i n g ' )   { 
                                         i f   ( t a s k . s t a t e   ! = =   ' n o t S c h e d u l e d '   & & 
                                                 ( t a s k . c a n c e l F n   & &   t a s k . d a t a . i s P e r i o d i c   | |   t a s k . r u n C o u n t   = = =   0 ) )   { 
                                                 i f   ( t y p e o f   i d   = = =   ' n u m b e r ' )   { 
                                                         d e l e t e   t a s k s B y H a n d l e I d [ i d ] ; 
                                                 } 
                                                 e l s e   i f   ( i d )   { 
                                                         i d [ t a s k S y m b o l ]   =   n u l l ; 
                                                 } 
                                                 / /   D o   n o t   c a n c e l   a l r e a d y   c a n c e l e d   f u n c t i o n s 
                                                 t a s k . z o n e . c a n c e l T a s k ( t a s k ) ; 
                                         } 
                                 } 
                                 e l s e   { 
                                         / /   c a u s e   a n   e r r o r   b y   c a l l i n g   i t   d i r e c t l y . 
                                         d e l e g a t e . a p p l y ( w i n d o w ,   a r g s ) ; 
                                 } 
                         } ) ; 
         } 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         f u n c t i o n   p a t c h C u s t o m E l e m e n t s ( _ g l o b a l ,   a p i )   { 
                 c o n s t   {   i s B r o w s e r ,   i s M i x   }   =   a p i . g e t G l o b a l O b j e c t s ( ) ; 
                 i f   ( ( ! i s B r o w s e r   & &   ! i s M i x )   | |   ! _ g l o b a l [ ' c u s t o m E l e m e n t s ' ]   | |   ! ( ' c u s t o m E l e m e n t s '   i n   _ g l o b a l ) )   { 
                         r e t u r n ; 
                 } 
                 c o n s t   c a l l b a c k s   =   [ ' c o n n e c t e d C a l l b a c k ' ,   ' d i s c o n n e c t e d C a l l b a c k ' ,   ' a d o p t e d C a l l b a c k ' ,   ' a t t r i b u t e C h a n g e d C a l l b a c k ' ] ; 
                 a p i . p a t c h C a l l b a c k s ( a p i ,   _ g l o b a l . c u s t o m E l e m e n t s ,   ' c u s t o m E l e m e n t s ' ,   ' d e f i n e ' ,   c a l l b a c k s ) ; 
         } 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         f u n c t i o n   e v e n t T a r g e t P a t c h ( _ g l o b a l ,   a p i )   { 
                 i f   ( Z o n e [ a p i . s y m b o l ( ' p a t c h E v e n t T a r g e t ' ) ] )   { 
                         / /   E v e n t T a r g e t   i s   a l r e a d y   p a t c h e d . 
                         r e t u r n ; 
                 } 
                 c o n s t   {   e v e n t N a m e s ,   z o n e S y m b o l E v e n t N a m e s ,   T R U E _ S T R ,   F A L S E _ S T R ,   Z O N E _ S Y M B O L _ P R E F I X   }   =   a p i . g e t G l o b a l O b j e c t s ( ) ; 
                 / /     p r e d e f i n e   a l l   _ _ z o n e _ s y m b o l _ _   +   e v e n t N a m e   +   t r u e / f a l s e   s t r i n g 
                 f o r   ( l e t   i   =   0 ;   i   <   e v e n t N a m e s . l e n g t h ;   i + + )   { 
                         c o n s t   e v e n t N a m e   =   e v e n t N a m e s [ i ] ; 
                         c o n s t   f a l s e E v e n t N a m e   =   e v e n t N a m e   +   F A L S E _ S T R ; 
                         c o n s t   t r u e E v e n t N a m e   =   e v e n t N a m e   +   T R U E _ S T R ; 
                         c o n s t   s y m b o l   =   Z O N E _ S Y M B O L _ P R E F I X   +   f a l s e E v e n t N a m e ; 
                         c o n s t   s y m b o l C a p t u r e   =   Z O N E _ S Y M B O L _ P R E F I X   +   t r u e E v e n t N a m e ; 
                         z o n e S y m b o l E v e n t N a m e s [ e v e n t N a m e ]   =   { } ; 
                         z o n e S y m b o l E v e n t N a m e s [ e v e n t N a m e ] [ F A L S E _ S T R ]   =   s y m b o l ; 
                         z o n e S y m b o l E v e n t N a m e s [ e v e n t N a m e ] [ T R U E _ S T R ]   =   s y m b o l C a p t u r e ; 
                 } 
                 c o n s t   E V E N T _ T A R G E T   =   _ g l o b a l [ ' E v e n t T a r g e t ' ] ; 
                 i f   ( ! E V E N T _ T A R G E T   | |   ! E V E N T _ T A R G E T . p r o t o t y p e )   { 
                         r e t u r n ; 
                 } 
                 a p i . p a t c h E v e n t T a r g e t ( _ g l o b a l ,   [ E V E N T _ T A R G E T   & &   E V E N T _ T A R G E T . p r o t o t y p e ] ) ; 
                 r e t u r n   t r u e ; 
         } 
         f u n c t i o n   p a t c h E v e n t ( g l o b a l ,   a p i )   { 
                 a p i . p a t c h E v e n t P r o t o t y p e ( g l o b a l ,   a p i ) ; 
         } 
 
         / * * 
           *   @ l i c e n s e 
           *   C o p y r i g h t   G o o g l e   I n c .   A l l   R i g h t s   R e s e r v e d . 
           * 
           *   U s e   o f   t h i s   s o u r c e   c o d e   i s   g o v e r n e d   b y   a n   M I T - s t y l e   l i c e n s e   t h a t   c a n   b e 
           *   f o u n d   i n   t h e   L I C E N S E   f i l e   a t   h t t p s : / / a n g u l a r . i o / l i c e n s e 
           * / 
         Z o n e . _ _ l o a d _ p a t c h ( ' l e g a c y ' ,   ( g l o b a l )   = >   { 
                 c o n s t   l e g a c y P a t c h   =   g l o b a l [ Z o n e . _ _ s y m b o l _ _ ( ' l e g a c y P a t c h ' ) ] ; 
                 i f   ( l e g a c y P a t c h )   { 
                         l e g a c y P a t c h ( ) ; 
                 } 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' t i m e r s ' ,   ( g l o b a l )   = >   { 
                 c o n s t   s e t   =   ' s e t ' ; 
                 c o n s t   c l e a r   =   ' c l e a r ' ; 
                 p a t c h T i m e r ( g l o b a l ,   s e t ,   c l e a r ,   ' T i m e o u t ' ) ; 
                 p a t c h T i m e r ( g l o b a l ,   s e t ,   c l e a r ,   ' I n t e r v a l ' ) ; 
                 p a t c h T i m e r ( g l o b a l ,   s e t ,   c l e a r ,   ' I m m e d i a t e ' ) ; 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' r e q u e s t A n i m a t i o n F r a m e ' ,   ( g l o b a l )   = >   { 
                 p a t c h T i m e r ( g l o b a l ,   ' r e q u e s t ' ,   ' c a n c e l ' ,   ' A n i m a t i o n F r a m e ' ) ; 
                 p a t c h T i m e r ( g l o b a l ,   ' m o z R e q u e s t ' ,   ' m o z C a n c e l ' ,   ' A n i m a t i o n F r a m e ' ) ; 
                 p a t c h T i m e r ( g l o b a l ,   ' w e b k i t R e q u e s t ' ,   ' w e b k i t C a n c e l ' ,   ' A n i m a t i o n F r a m e ' ) ; 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' b l o c k i n g ' ,   ( g l o b a l ,   Z o n e )   = >   { 
                 c o n s t   b l o c k i n g M e t h o d s   =   [ ' a l e r t ' ,   ' p r o m p t ' ,   ' c o n f i r m ' ] ; 
                 f o r   ( l e t   i   =   0 ;   i   <   b l o c k i n g M e t h o d s . l e n g t h ;   i + + )   { 
                         c o n s t   n a m e   =   b l o c k i n g M e t h o d s [ i ] ; 
                         p a t c h M e t h o d ( g l o b a l ,   n a m e ,   ( d e l e g a t e ,   s y m b o l ,   n a m e )   = >   { 
                                 r e t u r n   f u n c t i o n   ( s ,   a r g s )   { 
                                         r e t u r n   Z o n e . c u r r e n t . r u n ( d e l e g a t e ,   g l o b a l ,   a r g s ,   n a m e ) ; 
                                 } ; 
                         } ) ; 
                 } 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' E v e n t T a r g e t ' ,   ( g l o b a l ,   Z o n e ,   a p i )   = >   { 
                 p a t c h E v e n t ( g l o b a l ,   a p i ) ; 
                 e v e n t T a r g e t P a t c h ( g l o b a l ,   a p i ) ; 
                 / /   p a t c h   X M L H t t p R e q u e s t E v e n t T a r g e t ' s   a d d E v e n t L i s t e n e r / r e m o v e E v e n t L i s t e n e r 
                 c o n s t   X M L H t t p R e q u e s t E v e n t T a r g e t   =   g l o b a l [ ' X M L H t t p R e q u e s t E v e n t T a r g e t ' ] ; 
                 i f   ( X M L H t t p R e q u e s t E v e n t T a r g e t   & &   X M L H t t p R e q u e s t E v e n t T a r g e t . p r o t o t y p e )   { 
                         a p i . p a t c h E v e n t T a r g e t ( g l o b a l ,   [ X M L H t t p R e q u e s t E v e n t T a r g e t . p r o t o t y p e ] ) ; 
                 } 
                 p a t c h C l a s s ( ' M u t a t i o n O b s e r v e r ' ) ; 
                 p a t c h C l a s s ( ' W e b K i t M u t a t i o n O b s e r v e r ' ) ; 
                 p a t c h C l a s s ( ' I n t e r s e c t i o n O b s e r v e r ' ) ; 
                 p a t c h C l a s s ( ' F i l e R e a d e r ' ) ; 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' o n _ p r o p e r t y ' ,   ( g l o b a l ,   Z o n e ,   a p i )   = >   { 
                 p r o p e r t y D e s c r i p t o r P a t c h ( a p i ,   g l o b a l ) ; 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' c u s t o m E l e m e n t s ' ,   ( g l o b a l ,   Z o n e ,   a p i )   = >   { 
                 p a t c h C u s t o m E l e m e n t s ( g l o b a l ,   a p i ) ; 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' X H R ' ,   ( g l o b a l ,   Z o n e )   = >   { 
                 / /   T r e a t   X M L H t t p R e q u e s t   a s   a   m a c r o t a s k . 
                 p a t c h X H R ( g l o b a l ) ; 
                 c o n s t   X H R _ T A S K   =   z o n e S y m b o l ( ' x h r T a s k ' ) ; 
                 c o n s t   X H R _ S Y N C   =   z o n e S y m b o l ( ' x h r S y n c ' ) ; 
                 c o n s t   X H R _ L I S T E N E R   =   z o n e S y m b o l ( ' x h r L i s t e n e r ' ) ; 
                 c o n s t   X H R _ S C H E D U L E D   =   z o n e S y m b o l ( ' x h r S c h e d u l e d ' ) ; 
                 c o n s t   X H R _ U R L   =   z o n e S y m b o l ( ' x h r U R L ' ) ; 
                 c o n s t   X H R _ E R R O R _ B E F O R E _ S C H E D U L E D   =   z o n e S y m b o l ( ' x h r E r r o r B e f o r e S c h e d u l e d ' ) ; 
                 f u n c t i o n   p a t c h X H R ( w i n d o w )   { 
                         c o n s t   X M L H t t p R e q u e s t   =   w i n d o w [ ' X M L H t t p R e q u e s t ' ] ; 
                         i f   ( ! X M L H t t p R e q u e s t )   { 
                                 / /   X M L H t t p R e q u e s t   i s   n o t   a v a i l a b l e   i n   s e r v i c e   w o r k e r 
                                 r e t u r n ; 
                         } 
                         c o n s t   X M L H t t p R e q u e s t P r o t o t y p e   =   X M L H t t p R e q u e s t . p r o t o t y p e ; 
                         f u n c t i o n   f i n d P e n d i n g T a s k ( t a r g e t )   {   r e t u r n   t a r g e t [ X H R _ T A S K ] ;   } 
                         l e t   o r i A d d L i s t e n e r   =   X M L H t t p R e q u e s t P r o t o t y p e [ Z O N E _ S Y M B O L _ A D D _ E V E N T _ L I S T E N E R ] ; 
                         l e t   o r i R e m o v e L i s t e n e r   =   X M L H t t p R e q u e s t P r o t o t y p e [ Z O N E _ S Y M B O L _ R E M O V E _ E V E N T _ L I S T E N E R ] ; 
                         i f   ( ! o r i A d d L i s t e n e r )   { 
                                 c o n s t   X M L H t t p R e q u e s t E v e n t T a r g e t   =   w i n d o w [ ' X M L H t t p R e q u e s t E v e n t T a r g e t ' ] ; 
                                 i f   ( X M L H t t p R e q u e s t E v e n t T a r g e t )   { 
                                         c o n s t   X M L H t t p R e q u e s t E v e n t T a r g e t P r o t o t y p e   =   X M L H t t p R e q u e s t E v e n t T a r g e t . p r o t o t y p e ; 
                                         o r i A d d L i s t e n e r   =   X M L H t t p R e q u e s t E v e n t T a r g e t P r o t o t y p e [ Z O N E _ S Y M B O L _ A D D _ E V E N T _ L I S T E N E R ] ; 
                                         o r i R e m o v e L i s t e n e r   =   X M L H t t p R e q u e s t E v e n t T a r g e t P r o t o t y p e [ Z O N E _ S Y M B O L _ R E M O V E _ E V E N T _ L I S T E N E R ] ; 
                                 } 
                         } 
                         c o n s t   R E A D Y _ S T A T E _ C H A N G E   =   ' r e a d y s t a t e c h a n g e ' ; 
                         c o n s t   S C H E D U L E D   =   ' s c h e d u l e d ' ; 
                         f u n c t i o n   s c h e d u l e T a s k ( t a s k )   { 
                                 c o n s t   d a t a   =   t a s k . d a t a ; 
                                 c o n s t   t a r g e t   =   d a t a . t a r g e t ; 
                                 t a r g e t [ X H R _ S C H E D U L E D ]   =   f a l s e ; 
                                 t a r g e t [ X H R _ E R R O R _ B E F O R E _ S C H E D U L E D ]   =   f a l s e ; 
                                 / /   r e m o v e   e x i s t i n g   e v e n t   l i s t e n e r 
                                 c o n s t   l i s t e n e r   =   t a r g e t [ X H R _ L I S T E N E R ] ; 
                                 i f   ( ! o r i A d d L i s t e n e r )   { 
                                         o r i A d d L i s t e n e r   =   t a r g e t [ Z O N E _ S Y M B O L _ A D D _ E V E N T _ L I S T E N E R ] ; 
                                         o r i R e m o v e L i s t e n e r   =   t a r g e t [ Z O N E _ S Y M B O L _ R E M O V E _ E V E N T _ L I S T E N E R ] ; 
                                 } 
                                 i f   ( l i s t e n e r )   { 
                                         o r i R e m o v e L i s t e n e r . c a l l ( t a r g e t ,   R E A D Y _ S T A T E _ C H A N G E ,   l i s t e n e r ) ; 
                                 } 
                                 c o n s t   n e w L i s t e n e r   =   t a r g e t [ X H R _ L I S T E N E R ]   =   ( )   = >   { 
                                         i f   ( t a r g e t . r e a d y S t a t e   = = =   t a r g e t . D O N E )   { 
                                                 / /   s o m e t i m e s   o n   s o m e   b r o w s e r s   X M L H t t p R e q u e s t   w i l l   f i r e   o n r e a d y s t a t e c h a n g e   w i t h 
                                                 / /   r e a d y S t a t e = 4   m u l t i p l e   t i m e s ,   s o   w e   n e e d   t o   c h e c k   t a s k   s t a t e   h e r e 
                                                 i f   ( ! d a t a . a b o r t e d   & &   t a r g e t [ X H R _ S C H E D U L E D ]   & &   t a s k . s t a t e   = = =   S C H E D U L E D )   { 
                                                         / /   c h e c k   w h e t h e r   t h e   x h r   h a s   r e g i s t e r e d   o n l o a d   l i s t e n e r 
                                                         / /   i f   t h a t   i s   t h e   c a s e ,   t h e   t a s k   s h o u l d   i n v o k e   a f t e r   a l l 
                                                         / /   o n l o a d   l i s t e n e r s   f i n i s h . 
                                                         c o n s t   l o a d T a s k s   =   t a r g e t [ Z o n e . _ _ s y m b o l _ _ ( ' l o a d f a l s e ' ) ] ; 
                                                         i f   ( l o a d T a s k s   & &   l o a d T a s k s . l e n g t h   >   0 )   { 
                                                                 c o n s t   o r i I n v o k e   =   t a s k . i n v o k e ; 
                                                                 t a s k . i n v o k e   =   f u n c t i o n   ( )   { 
                                                                         / /   n e e d   t o   l o a d   t h e   t a s k s   a g a i n ,   b e c a u s e   i n   o t h e r 
                                                                         / /   l o a d   l i s t e n e r ,   t h e y   m a y   r e m o v e   t h e m s e l v e s 
                                                                         c o n s t   l o a d T a s k s   =   t a r g e t [ Z o n e . _ _ s y m b o l _ _ ( ' l o a d f a l s e ' ) ] ; 
                                                                         f o r   ( l e t   i   =   0 ;   i   <   l o a d T a s k s . l e n g t h ;   i + + )   { 
                                                                                 i f   ( l o a d T a s k s [ i ]   = = =   t a s k )   { 
                                                                                         l o a d T a s k s . s p l i c e ( i ,   1 ) ; 
                                                                                 } 
                                                                         } 
                                                                         i f   ( ! d a t a . a b o r t e d   & &   t a s k . s t a t e   = = =   S C H E D U L E D )   { 
                                                                                 o r i I n v o k e . c a l l ( t a s k ) ; 
                                                                         } 
                                                                 } ; 
                                                                 l o a d T a s k s . p u s h ( t a s k ) ; 
                                                         } 
                                                         e l s e   { 
                                                                 t a s k . i n v o k e ( ) ; 
                                                         } 
                                                 } 
                                                 e l s e   i f   ( ! d a t a . a b o r t e d   & &   t a r g e t [ X H R _ S C H E D U L E D ]   = = =   f a l s e )   { 
                                                         / /   e r r o r   o c c u r s   w h e n   x h r . s e n d ( ) 
                                                         t a r g e t [ X H R _ E R R O R _ B E F O R E _ S C H E D U L E D ]   =   t r u e ; 
                                                 } 
                                         } 
                                 } ; 
                                 o r i A d d L i s t e n e r . c a l l ( t a r g e t ,   R E A D Y _ S T A T E _ C H A N G E ,   n e w L i s t e n e r ) ; 
                                 c o n s t   s t o r e d T a s k   =   t a r g e t [ X H R _ T A S K ] ; 
                                 i f   ( ! s t o r e d T a s k )   { 
                                         t a r g e t [ X H R _ T A S K ]   =   t a s k ; 
                                 } 
                                 s e n d N a t i v e . a p p l y ( t a r g e t ,   d a t a . a r g s ) ; 
                                 t a r g e t [ X H R _ S C H E D U L E D ]   =   t r u e ; 
                                 r e t u r n   t a s k ; 
                         } 
                         f u n c t i o n   p l a c e h o l d e r C a l l b a c k ( )   {   } 
                         f u n c t i o n   c l e a r T a s k ( t a s k )   { 
                                 c o n s t   d a t a   =   t a s k . d a t a ; 
                                 / /   N o t e   -   i d e a l l y ,   w e   w o u l d   c a l l   d a t a . t a r g e t . r e m o v e E v e n t L i s t e n e r   h e r e ,   b u t   i t ' s   t o o   l a t e 
                                 / /   t o   p r e v e n t   i t   f r o m   f i r i n g .   S o   i n s t e a d ,   w e   s t o r e   i n f o   f o r   t h e   e v e n t   l i s t e n e r . 
                                 d a t a . a b o r t e d   =   t r u e ; 
                                 r e t u r n   a b o r t N a t i v e . a p p l y ( d a t a . t a r g e t ,   d a t a . a r g s ) ; 
                         } 
                         c o n s t   o p e n N a t i v e   =   p a t c h M e t h o d ( X M L H t t p R e q u e s t P r o t o t y p e ,   ' o p e n ' ,   ( )   = >   f u n c t i o n   ( s e l f ,   a r g s )   { 
                                 s e l f [ X H R _ S Y N C ]   =   a r g s [ 2 ]   = =   f a l s e ; 
                                 s e l f [ X H R _ U R L ]   =   a r g s [ 1 ] ; 
                                 r e t u r n   o p e n N a t i v e . a p p l y ( s e l f ,   a r g s ) ; 
                         } ) ; 
                         c o n s t   X M L H T T P R E Q U E S T _ S O U R C E   =   ' X M L H t t p R e q u e s t . s e n d ' ; 
                         c o n s t   f e t c h T a s k A b o r t i n g   =   z o n e S y m b o l ( ' f e t c h T a s k A b o r t i n g ' ) ; 
                         c o n s t   f e t c h T a s k S c h e d u l i n g   =   z o n e S y m b o l ( ' f e t c h T a s k S c h e d u l i n g ' ) ; 
                         c o n s t   s e n d N a t i v e   =   p a t c h M e t h o d ( X M L H t t p R e q u e s t P r o t o t y p e ,   ' s e n d ' ,   ( )   = >   f u n c t i o n   ( s e l f ,   a r g s )   { 
                                 i f   ( Z o n e . c u r r e n t [ f e t c h T a s k S c h e d u l i n g ]   = = =   t r u e )   { 
                                         / /   a   f e t c h   i s   s c h e d u l i n g ,   s o   w e   a r e   u s i n g   x h r   t o   p o l y f i l l   f e t c h 
                                         / /   a n d   b e c a u s e   w e   a l r e a d y   s c h e d u l e   m a c r o T a s k   f o r   f e t c h ,   w e   s h o u l d 
                                         / /   n o t   s c h e d u l e   a   m a c r o T a s k   f o r   x h r   a g a i n 
                                         r e t u r n   s e n d N a t i v e . a p p l y ( s e l f ,   a r g s ) ; 
                                 } 
                                 i f   ( s e l f [ X H R _ S Y N C ] )   { 
                                         / /   i f   t h e   X H R   i s   s y n c   t h e r e   i s   n o   t a s k   t o   s c h e d u l e ,   j u s t   e x e c u t e   t h e   c o d e . 
                                         r e t u r n   s e n d N a t i v e . a p p l y ( s e l f ,   a r g s ) ; 
                                 } 
                                 e l s e   { 
                                         c o n s t   o p t i o n s   =   {   t a r g e t :   s e l f ,   u r l :   s e l f [ X H R _ U R L ] ,   i s P e r i o d i c :   f a l s e ,   a r g s :   a r g s ,   a b o r t e d :   f a l s e   } ; 
                                         c o n s t   t a s k   =   s c h e d u l e M a c r o T a s k W i t h C u r r e n t Z o n e ( X M L H T T P R E Q U E S T _ S O U R C E ,   p l a c e h o l d e r C a l l b a c k ,   o p t i o n s ,   s c h e d u l e T a s k ,   c l e a r T a s k ) ; 
                                         i f   ( s e l f   & &   s e l f [ X H R _ E R R O R _ B E F O R E _ S C H E D U L E D ]   = = =   t r u e   & &   ! o p t i o n s . a b o r t e d   & & 
                                                 t a s k . s t a t e   = = =   S C H E D U L E D )   { 
                                                 / /   x h r   r e q u e s t   t h r o w   e r r o r   w h e n   s e n d 
                                                 / /   w e   s h o u l d   i n v o k e   t a s k   i n s t e a d   o f   l e a v i n g   a   s c h e d u l e d 
                                                 / /   p e n d i n g   m a c r o T a s k 
                                                 t a s k . i n v o k e ( ) ; 
                                         } 
                                 } 
                         } ) ; 
                         c o n s t   a b o r t N a t i v e   =   p a t c h M e t h o d ( X M L H t t p R e q u e s t P r o t o t y p e ,   ' a b o r t ' ,   ( )   = >   f u n c t i o n   ( s e l f ,   a r g s )   { 
                                 c o n s t   t a s k   =   f i n d P e n d i n g T a s k ( s e l f ) ; 
                                 i f   ( t a s k   & &   t y p e o f   t a s k . t y p e   = =   ' s t r i n g ' )   { 
                                         / /   I f   t h e   X H R   h a s   a l r e a d y   c o m p l e t e d ,   d o   n o t h i n g . 
                                         / /   I f   t h e   X H R   h a s   a l r e a d y   b e e n   a b o r t e d ,   d o   n o t h i n g . 
                                         / /   F i x   # 5 6 9 ,   c a l l   a b o r t   m u l t i p l e   t i m e s   b e f o r e   d o n e   w i l l   c a u s e 
                                         / /   m a c r o T a s k   t a s k   c o u n t   b e   n e g a t i v e   n u m b e r 
                                         i f   ( t a s k . c a n c e l F n   = =   n u l l   | |   ( t a s k . d a t a   & &   t a s k . d a t a . a b o r t e d ) )   { 
                                                 r e t u r n ; 
                                         } 
                                         t a s k . z o n e . c a n c e l T a s k ( t a s k ) ; 
                                 } 
                                 e l s e   i f   ( Z o n e . c u r r e n t [ f e t c h T a s k A b o r t i n g ]   = = =   t r u e )   { 
                                         / /   t h e   a b o r t   i s   c a l l e d   f r o m   f e t c h   p o l y f i l l ,   w e   n e e d   t o   c a l l   n a t i v e   a b o r t   o f   X H R . 
                                         r e t u r n   a b o r t N a t i v e . a p p l y ( s e l f ,   a r g s ) ; 
                                 } 
                                 / /   O t h e r w i s e ,   w e   a r e   t r y i n g   t o   a b o r t   a n   X H R   w h i c h   h a s   n o t   y e t   b e e n   s e n t ,   s o   t h e r e   i s   n o 
                                 / /   t a s k 
                                 / /   t o   c a n c e l .   D o   n o t h i n g . 
                         } ) ; 
                 } 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' g e o l o c a t i o n ' ,   ( g l o b a l )   = >   { 
                 / / /   G E O _ L O C A T I O N 
                 i f   ( g l o b a l [ ' n a v i g a t o r ' ]   & &   g l o b a l [ ' n a v i g a t o r ' ] . g e o l o c a t i o n )   { 
                         p a t c h P r o t o t y p e ( g l o b a l [ ' n a v i g a t o r ' ] . g e o l o c a t i o n ,   [ ' g e t C u r r e n t P o s i t i o n ' ,   ' w a t c h P o s i t i o n ' ] ) ; 
                 } 
         } ) ; 
         Z o n e . _ _ l o a d _ p a t c h ( ' P r o m i s e R e j e c t i o n E v e n t ' ,   ( g l o b a l ,   Z o n e )   = >   { 
                 / /   h a n d l e   u n h a n d l e d   p r o m i s e   r e j e c t i o n 
                 f u n c t i o n   f i n d P r o m i s e R e j e c t i o n H a n d l e r ( e v t N a m e )   { 
                         r e t u r n   f u n c t i o n   ( e )   { 
                                 c o n s t   e v e n t T a s k s   =   f i n d E v e n t T a s k s ( g l o b a l ,   e v t N a m e ) ; 
                                 e v e n t T a s k s . f o r E a c h ( e v e n t T a s k   = >   { 
                                         / /   w i n d o w s   h a s   a d d e d   u n h a n d l e d r e j e c t i o n   e v e n t   l i s t e n e r 
                                         / /   t r i g g e r   t h e   e v e n t   l i s t e n e r 
                                         c o n s t   P r o m i s e R e j e c t i o n E v e n t   =   g l o b a l [ ' P r o m i s e R e j e c t i o n E v e n t ' ] ; 
                                         i f   ( P r o m i s e R e j e c t i o n E v e n t )   { 
                                                 c o n s t   e v t   =   n e w   P r o m i s e R e j e c t i o n E v e n t ( e v t N a m e ,   {   p r o m i s e :   e . p r o m i s e ,   r e a s o n :   e . r e j e c t i o n   } ) ; 
                                                 e v e n t T a s k . i n v o k e ( e v t ) ; 
                                         } 
                                 } ) ; 
                         } ; 
                 } 
                 i f   ( g l o b a l [ ' P r o m i s e R e j e c t i o n E v e n t ' ] )   { 
                         Z o n e [ z o n e S y m b o l ( ' u n h a n d l e d P r o m i s e R e j e c t i o n H a n d l e r ' ) ]   = 
                                 f i n d P r o m i s e R e j e c t i o n H a n d l e r ( ' u n h a n d l e d r e j e c t i o n ' ) ; 
                         Z o n e [ z o n e S y m b o l ( ' r e j e c t i o n H a n d l e d H a n d l e r ' ) ]   = 
                                 f i n d P r o m i s e R e j e c t i o n H a n d l e r ( ' r e j e c t i o n h a n d l e d ' ) ; 
                 } 
         } ) ; 
 
 } ) ) ) ; 
 
 
 / * * * /   } ) 
 
 } , [ [ 1 , " r u n t i m e " ] ] ] ) ; 
 / / #   s o u r c e M a p p i n g U R L = p o l y f i l l s . j s . m a p    p o l y f i l l s . j s . m a p  #       http://localhost:4200/polyfills.js                       !!            +H!!      !!   polyfills    !!          1C                           |     |                            !!      module   exports'   __webpack_require__         +H;                             T  T =    : 6   Q
 	   hN/g   exports5!!       	   hN/gC                                                         !!      module'   __webpack_exports__'   __webpack_require__]   zone_js_dist_zone__WEBPACK_IMPORTED_MODULE_0__m   zone_js_dist_zone__WEBPACK_IMPORTED_MODULE_0___default        +H;   9                    	     T     
T  QT =   : W   QT    
V   : W  QJ_T    r	   pDpN   n5!!       	   pDpNC  [                        4   4                         !!      module   exports'   __webpack_require__=   __WEBPACK_AMD_DEFINE_FACTORY__;   __WEBPACK_AMD_DEFINE_RESULT__        +H!!          pDpN/<c   b                        %    %                            !!      factory         +H;      "                       T     Q   '=    H2            
            l                Q      IE      Q      6       Q!$i    function	   call   undefined   exports5!!          pDpN/<c    i                     0  4 '  4         ;             !!      patchCallbacks   patchPrototype   patchTimer   findEventTasks'   patchEventPrototype#   patchOnProperties!   filterProperties   bindArguments#   prepareEventNames!   patchEventTarget+   attachOriginToPatched'   patchCustomElements	   isIE   isIEOrEdge/   patchFilteredProperties   patchMethod%   isPropertyWritable/   propertyDescriptorPatch)   copySymbolProperties!   eventTargetPatchA   scheduleMacroTaskWithCurrentZone   patchClass   patchMacroTask   patchEvent'   wrapWithCurrentZone   patchProperty          !!    5   %   isDetectedIEOrEdge!   passiveSupported   ieOrEdge5   shouldCopySymbolProperties   isBrowser%   documentEventNames!   detailEventNames-   zoneSymbolEventNames$1'   websocketEventNames=   ObjectGetOwnPropertyDescriptor   webglEventNames   eventNames)   ObjectDefineProperty   TRUE_STR%   NULL_ON_PROP_VALUE   isWebWorker!   windowEventNames1   XMLHttpRequestEventNames-   mediaElementEventNames   internalWindow   zoneSymbol'   originalInstanceKey   isMix   ObjectCreate#   marqueeEventNames=   ZONE_SYMBOL_ADD_EVENT_LISTENER!   REMOVE_ATTRIBUTE'   ieElementEventNames+   htmlElementEventNames   globalSourcesC   ZONE_SYMBOL_REMOVE_EVENT_LISTENER)   zoneSymbolEventNames   Zone$1   isWindowExists   _global3   REMOVE_EVENT_LISTENER_STR%   frameSetEventNames%   ZONE_SYMBOL_PREFIX-   ADD_EVENT_LISTENER_STR   frameEventNames   ArraySlice)   ObjectGetPrototypeOf%   IDBIndexEventNames   wrapFn   taskSymbol   FALSE_STR   isNode9   IMMEDIATE_PROPAGATION_SYMBOL!   workerEventNames=   OPTIMIZED_ZONE_EVENT_TASK_DATA;   globalEventHandlersEventNames-   EVENT_NAME_SYMBOL_REGX   formEventNames       
   !!         options    
      !!         err   
      +H!!   	   '   wrapWithCurrentZone   F    F                  5!!      A   scheduleMacroTaskWithCurrentZone    -                  t    K                              !!      source   callback	   data   customSchedule   customCancel         +H;   %                     
         5      
T  T T T T :  	   Zone   current#   scheduleMacroTask      5!!   	      bindArguments     y                   5!!         patchPrototype                                                     !!      prototype   fnNames         !!          source            !!         i          !!      	   name   delegate          !!         prototypeDesc          +H!!      ?   patchPrototype/prototype[name]<e                       q    q                          !!      delegate        !!          patched           +H!!   	      patchedB    ,    ,    -           5;       +       )              ,                            Q       Q  V       QV   1$ 5;       *                               4            d   ^                                                             T  5    5      Q   Q>   Q    m        QT V   7   QT     7  QV  h   	     Q	  	  T     :   Q  V  :        )      T         V  : 9Q      V   W   QQ   V   T    =   0&       1
&J  ,       constructor	   name   length5!!      %   isPropertyWritable                                                        !!      propertyDesc         +H;   a   ?                       T         C   T  5    BH      B   T  5   =   HE      QT  5   =   H       *    writable   get   function   set   undefined      5!!         patchProperty   )                    Y  	 C  	                       !!      obj	   prop   prototype        !!       	   desc   eventNameSymbol'   onPropPatchedSymbol   originalDescGet   originalDescSet   eventName          !!         prototypeDesc          +H!!       !!   enumerable!!!!   configurable!!    !!      -   patchProperty/desc.setc  J                  H  8 ?  8                         !!      newValue   .this        !!          target   previousValue         +H;      Q      n             X                  #     W   Q    QV     QV   E      Q      H             W  Q	   V            V        7  QV  -      V      
      %  %   Q         (            
V      O Q   T  '=   HA      V     T  9QV     
      %  %  B Q   !   V     @9Q#   ' d T  '   removeEventListener   apply   function!   addEventListener     5!!   	   -   patchProperty/desc.getb   3	  3	 g              5;           L   G                         *                               G    -       Q	  	      :    Q    E      QT    Q        Q	  T   :   QV  !      [    C]    C]      Q          D      Q   5                    =     =   :    Q     
V   : E   #   Q  V   7%      &   &      .   Q   .   Q   5      Q   5      Q  	   
:    Q       7   Q    /   5          =
      : 9   Q<         0   Q      0   Q            Q  V   C9Q1"	 4	  7$  @  4 g     enumerable   configurable   on   patched   hasOwnProperty   writable   value   get   set   substr   ON_PROPERTY5!!      #   patchOnProperties                     	  	                          !!      obj   properties   prototype         !!          i          !!          onProperties           !!      	   prop          !!         j         +H;          M            ]            I         e      |            o            a         c                         T t         Q>   Q :   m     T  =    T V   7T  Q	   V   W   QQ
   V   T                QZ       Q  QT  KN   m     Q  V     
>: =          V      
V   Q      QLM   QN  Q>  Q 5   m     T  V   V  7T  Q   V  W  QQ   V  V              &:(M  3  !=W  &5#I  5      on   length   substr	   push   
   5!!         patchClass                       r ( _ (                      !!      className        !!       	   prop   OriginalClass   instance          +H!!   	   ;   patchClass/_global[className]b  i  `    &           5!!   	   )   patchClass/instance<b  p v g v   4             5!!         patchClass/<c                        d D [ D                        !!   	   prop        +H!!    	   _   patchClass/</_global[className].prototype[prop]b   q  q   B           5!!    	      setB       &            5!!    	      getB        &            5!!       !!   set!!!!   get!!    ;      5                              7=    H0            75          9QL                75      [      ]      ]    Q          function   prototype   set   get5;         e            u               4                                3           Q      7   Q                     :    9Q        9Q      7    Q   A   ,  R    Q   Q   KV   m   W     =    HE      QV   =   H                    V    Q!   QLM#   QN   Kf   m%   W   V   =   IE   '   Q      
V   : *   %   +       7V      V   79Q1   1   QLM3   QN#   ?_H   ?o&      XMLHttpRequest   responseBlob   prototype   hasOwnProperty5!!   	   )   copySymbolProperties J  -    !                src 	   dest   D"                       symbol 	   desc   B                     5   B                    555!!         patchMethod                	                                   !!      target	   name   patchFn         !!          proto   delegate   delegateName          !!      	   desc          !!         patchDelegate          +H!!      /   patchMethod/proto[name]c   	  '                                             !!      arguments   .this          +H;    $                         	W   QW  Q      V  V   : ,      5;           M                            S  l                                  	       (            QT     Q   !   m    #   #  V   : W   Q   V   E      QV       
T :        V    E      QT  T 7         T  W   Q         T :   Q@  QV   E      QV   V  7W              QV   V  V   T 79W  QV   E       Q 	   	  V   T :      Q  V  : {         T V  V  T :    QV   T     9Q  V   T 7V   Q        %     V  V   T 7 Q(   (   (   V  0(M  		#	&    hasOwnProperty5!!   	      patchMacroTask ! @$ ! @$                   metaCreator    setNative    scheduleTask	      scheduleTask w! T" b! T"                	   task   B  ! ! ! !   -          55   D" " 8$ " 8$   /                delegate   B " 8$ " 8$   F             555!!      +   attachOriginToPatched  &  "                  c$ $ E$ $                           !!      patched   original         +H;                             T        =    : T 9Q !   OriginalDelegate      5!!   	   	   isIE  
% & $ & +               5!!   	      isIEOrEdge  1& ' & ' 6               5!!   	   #   prepareEventNames f5 7 L5 7                5!!      !   patchEventTarget                	       7 B 7 B                      !!      _global	   apis   patchOptions/   patchEventTargetMethods       !!          results%   ADD_EVENT_LISTENER+   REMOVE_EVENT_LISTENER1   LISTENERS_EVENT_LISTENERG   REMOVE_ALL_LISTENERS_EVENT_LISTENER5   zoneSymbolAddEventListener3   ADD_EVENT_LISTENER_SOURCE-   PREPEND_EVENT_LISTENER;   PREPEND_EVENT_LISTENER_SOURCE   invokeTask/   globalZoneAwareCallback=   globalZoneAwareCaptureCallback         !!         i         +H!!      /   patchEventTargetMethods                       cL  CL                       !!      obj   patchOptions3   buildEventListenerOptions        !!          returnTarget   proto5   nativePrependEventListener#   useGlobalCallback   checkDuplicate+   customSchedulePrepend   taskData   compare   customSchedule-   nativeAddEventListener1   nativeRemoveAllListeners%   customCancelGlobal#   blackListedEvents   passiveEvents;   compareTaskCallbackVsDelegate)   customScheduleGlobal   validateHandler/   customScheduleNonGlobal   customCancel   nativeListeners+   customCancelNonGlobal   makeAddListener#   eventNameToString3   nativeRemoveEventListener          +H!!      3   buildEventListenerOptions  2  .                  "V Y  V Y                          !!      options   passive         +H!!       !!   capture!!!!   passive!!    !!       !!   passive!!    !!            !!       !!   passive!!    ;   5                    +    
      E#      QT  '=    HE   	   QT  	      
   T  5             D      QT           T     T  '=   H      [    T  ]   C]      T         [   C]      T  '=    HE      QT  5   BI!   <   "         
      
[   T  : [   C]   : +   T   F 9 F <	 F ?	 F B E    object   capture   boolean   passive   Object   assign      5!!            !!      )   customScheduleGlobalC G  2                  Z [ Z [                           !!   	   task         +H;      (                             5                      
   5      5      5                             5   l  M    isExisting	   call   target   eventName   capture   options      5!!   	   %   customCancelGlobalB \ 2d \ 2d O  0      	       5!!   	   /   customScheduleNonGlobalB id d `d d t  5             5!!   	   +   customSchedulePrependB ,e e #e e w  3             5!!   	   +   customCancelNonGlobalB e xf e xf z  3             5!!   	   ;   compareTaskCallbackVsDelegateB }g h tg h   ;             5!!         makeAddListenerC                       i  i                         !!      nativeListener   addSource!   customScheduleFn   customCancelFn   returnTarget   prepend       +H!!       #   makeAddListener/<c                      Ij  @j                         !!      arguments   .this          !!          eventName   delegate   isHandleEvent!   symbolEventNames   existingTasks   isExisting   source   target   passive   options   capture	   once	   zone   symbolEventName   constructorName   targetSource	   data	   task         !!         i         !!         i         +H;                     Z         (                    O                                      y                                                            r               
                   -            5                      ` 	W   QW  Q              	  
                    QV  D      Q     	  QV   >7  Q  E      Q  5       "   	         
V  : W  Q   V   ?7  QV   )               
V  V   O    (  (  E      QV  =   H   )               
V  V   O    B  QV  '=   IH      V  5    )               
V  V   O "   CW  Q"       E+   $   Q        V  V	  V   :  (      )   )       E8   +   Q
  
    E!   /   Q
     
V  : I3   
  Q  V   7V
  :   Q	  	     8     Q>  Q    m8   V  	  V  7Hj   <   V
  7   =            
V	  V  V  V  l *   @            
V  V   O C   V  W  QQD   V  	     [I   I   V      K   B3   K   V  '=   H   N   C   N   V  5	   O     QV  E   P   QV  '=
   HR      S   V  5      T   BT     Q   5     Q    V  7  QV   1   Z   
  V       Q  V  7W  Q_   V  V     `          a   '  '  b   7  QV	  V  7  QB  QV     e   CW  Q    |   g     Q>  Q F   mg       V  V  7V  :    k   k   V  W  QQl   V  V     p   p      p   V	  V  Z    9W  Qr     QV	  5   5     Q    V  7  QV     w   V  V  7W  Qx   V   S   z   V               ~     V  :       V     W  Q       V  0   QV          5   B0   Q     V	  0   Q  V  0	   Q  V  0   Q  V  0   Q          +  +                QV        V    0   Q   V     
V  V  V              :   Q  @0   QV        V  @0   Q   V        V  C0   Q        E      QV  5   =   H          V  V  0   Q   V  V	  0   QV  V  0	   QV  V  0   QV        V  V  0   Q          "      V     
V   Q      V     
V   Q               V	     ##$# 
  
 ( 
  
 $ $&        $$ 
 $ 
 F  ( $!!+,(%!&F4Z  $$ 
 F  , ,)1!! #   transferEventName   apply#   uncaughtException   function   handleEvent   indexOf	   call   length   boolean   capture   object	   once	   Zone   current   constructor	   name   options   target   eventName   isExisting   undefined   taskData#   scheduleEventTask!   originalDelegate	   push   unshift    5;    e                           T     QT    QT    QT    QT H   	   QB	      QT H      QB      Q      5!!   	   i   patchEventTargetMethods/proto[REMOVE_EVENT_LISTENER]b  a  X    4           5!!   	   o   patchEventTargetMethods/proto[LISTENERS_EVENT_LISTENER]b      H  7           5!!   	      patchEventTargetMethods/proto[REMOVE_ALL_LISTENERS_EVENT_LISTENER]b   W 	 W W  B           5;       q  T               S                           8                                               l                       	  
    Q      QT         B   C   Q  E      Q  5       I           5       Q     E      Q  5         QC   Q  E      Q  5      I           5      Q   B   Q  E      Q  5      I!      "     5      Q$   T     Q$   !   m$   #  #  V   : W   Q&   V   E$   (   QV      
    :  ,   -   V    E   /   QT      71      2   T  W   Q2   V       4   B4   V       7   7   B7     E   9   Q  5   ;      Q[      QV     V       79   QV           : V     79   QV         : V     79	  QV         : V     79  Q   Q  E   T   Q  5   V   7   W   V       5   : V     5   79   Q_        Q     Q     Q     Q   
  Q      a   V     a   V  a     Q      c   V     c   V
  c     Q     Q  E   e   Q  5   g      h     5      j   V  j      Q	     =
   : 7 	  Q    =   : 7 
  Q     QV     V         V  V     : 9Q   ?   z   V       V     	  	  V  V     C: 9Q   V     	   9QV     
   9QV        9Q  V     7    Q  V     7    QV  "        V     7V   Q   V	  "        V     7V	   Q   C<  $$!(T  	    &+.$-# G) O' t,**#!2 &"$   H W  	   useG   undefined   vh   chkDup   rt   hasOwnProperty#   eventNameToString   prepend	   diff	   Zone'   BLACK_LISTED_EVENTS   PASSIVE_EVENTS5!!   	      invokeTaskB : <? : <?   $                delegate   D" Y< < Y< <                 55!!   	   /   globalZoneAwareCallbackB ? E ? E   1            5!!   	   =   globalZoneAwareCaptureCallbackB NF 9L EF 9L   8            5;         L              t  d                    
               	       $          Q    W   QT E      QT 5       D      Q            QT E   	   QT 5   
   D      Q          QT E      QT 5      D      Q=         QT E      QT 5      D      Q=         Q       :    Q=      =      Q=      Q=      =    	  Q    
  Q      Q      QZ      Q  Q>  Q 9   m   V  V  V   T V  7T : 9Q   V  W  QQ    V  T 	   $   V  ;$'*5+*'. ( / &9'L  )      add   rm   listeners   eventListeners   rmAll%   removeAllListeners   .   :   prependListener   length5!!   	      findEventTasks ^ A G A                5!!      '   patchEventPrototype                       b  F                         !!      global   api         !!          Event           +H!!      +   patchEventPrototype/<e                        
  
                         !!      delegate        +H!!    	   /   patchEventPrototype/</<b !      `             5;                                   W  5;       b      c   #                 
        QT  5       QV   E      QV   5      ,      T    
V   5   =        Q
   .     Event   prototype   patchMethod1   stopImmediatePropagation5!!         patchCallbacks                        ~  ~                       !!      api   target   targetName   method   callbacks        !!          symbol   nativeDelegate           +H!!   	   ;   patchCallbacks/target[method]b  4  4   "             	   opts   B       +             55;             ;                D                            Q       
  :    Q  V   7           V       79   Q        9Q     
    7    QH    	   Zone   __symbol__+   attachOriginToPatched5!!      !   filterProperties   	                     T m T                       !!      target   onProperties!   ignoreProperties        !!          tip-   targetIgnoreProperties           +H!!   	   +   filterProperties/tip<d" J d J d 	  ,             5!!   	   %   filterProperties/<d"  L  L 	  #             5;             8                                            R                            QT  D      QT     >H      	   T 	   T    
    :    QV    D      QV       >H         T    V   >75      QT    
   : F 	 	 	'    length   filter!   ignoreProperties5!!      /   patchFilteredProperties  	  $                 y  Y                           !!      target   onProperties!   ignoreProperties   prototype         !!       %   filteredProperties           +H;       I                     J   ,                         QT              T  T T :    Q  T  V   T  QX 	#       5!!      /   propertyDescriptorPatch  	  $                 = *  *                         !!      api   _global         !!       #   supportsWebSocket!   ignoreProperties   XMLHttpRequest3   XMLHttpRequestEventTarget           !!         internalWindow+   ignoreErrorProperties%   HTMLMarqueeElement   Worker          +H!!       !!   target!!!!!   ignoreProperties!!    ;             D              o                            k                              Q (   (  E      Q                       T     
=   : 7            '=   I   QT 5     Q                   Q     Q  ;      Z   [    V  ]   Z   =   `    ]	   `          Z         Q  V   
   
  
   
Z   =   `    : V  !   %   V  
   
V  :    '   V  '    #   #  V  :  Q     5    
  V   QV  5   =   I+   3     V  5   5    
  V   Q8        5    
  V   Q     5    
  V   Q     5         V   Q     5         
   
      : V   Q     5      
   
   : V   Q     5    !   !  V   Q     5    !  V   QV  5     QV  +   c     V  5         V   Qg   V  5     QV  +   i     V  5    *   *  V   Qm   m   T 5     QV  +   o     V  5         V   Qs   T 5     QV  ?   u     V  E   w   QV  5   x         V   Qz      '=   I   ~        5    $   $  V   Q     5    $  V   Q     5    $  V   Q     5    $  V   Q     5    $  V   Q     5    $  V   Q   V   ,           5         V   Q   3
 
 		 
 	"!#*;>2]HD'* 	   Zone   symbol   patchEvents   WebSocket   undefined7   __Zone_ignore_on_properties   window   target   error!   ignoreProperties   concat   messageerror   Document   prototype   SVGElement   Element   HTMLElement!   HTMLMediaElement'   HTMLFrameSetElement   HTMLBodyElement!   HTMLFrameElement#   HTMLIFrameElement%   HTMLMarqueeElement   Worker   XMLHttpRequest3   XMLHttpRequestEventTarget   IDBIndex   IDBRequest!   IDBOpenDBRequest   IDBDatabase   IDBTransaction   IDBCursor      5!!         patchTimer   N
                     q  ^                        !!      window   setName   cancelName   nameSuffix   scheduleTask   clearTask        !!          setNative   clearNative   tasksByHandleId           +H!!         scheduleTask   T
                    ]  H                        !!   	   task   timer       !!       	   data          +H!!         timer   V
                   ]  ] "                      !!      arguments   .this          +H;          1   4         F                      	W   QW  Q  5       
V  V   O QB~   t              5   E      Q  5   5       u            5   =   H%             5   /Q5         5   !         5   &  &  @9Q   u    -!    invoke   apply	   data   isPeriodic   handleId   number   5;      b       e             h   '                             W   Q  5       Q   5   >V   9Q          
     5   O 0   Q  $ 
l 	   data	   args   apply   handleId5!!   	      clearTask  /  / p
               5!!            !!      +   patchTimer/setNative<e   r
                     m  m                         !!      delegate        +H!!       /   patchTimer/setNative</<c  r
  @          
         {                          !!   	   self	   args         !!          options	   task   handle           +H!!       !!   isPeriodic!!!!   delay!!!!	   args!!    ;      2                    :             F            p            
       E     T >7=    HA            Q[      =   H]     =   HD      Q  =   H   %      T ?7D      Q>               ]   T ]      Q    T >7V       :   QV         V     V  5   5     QV  '=	   H#   #       V  V  9Q,   %   V     &   V  &  &  V  9Q(   V  E^   )   QV  5
   EJ   +   QV  5   E6   -   QV  5
   =    HE   1   QV  5   =    H4   L   5   V  V  5
      
V  : 0
   QV  V  5      
V  : 0   Q=   V  '=	   HD   @   QV  @      A   V  A   V  "   A         
  T O E   $! 
 
#( 
 
 
 
    function   Interval   isPeriodic   Timeout   undefined   delay	   args	   data   handleId   number   ref   unref	   bind   apply      5;                                   7 
 5!!      /   patchTimer/clearNative<e   
                                                !!      delegate        +H!!    	   3   patchTimer/clearNative</<b     
  C      	       5;                                   : 
 5;                F                      
          Q     Q@   Q@   Q      QT   U Q[      Q         :    Q    T    :    QA  
q 
 
 5!!      '   patchCustomElements  
             
       
                             !!      _global   api         !!          isBrowser   isMix   callbacks           +H;                        
      M          
                   QT     
:  5      Q5     QQV    E   	   QV   
   D)      QT  5    D      Q=   T  q             Z   =   `    =   `   =   `   =   `     QT    
T T  5   =   =	   V   Q/% 
 !   getGlobalObjects   isBrowser   isMix   customElements#   connectedCallback)   disconnectedCallback   adoptedCallback1   attributeChangedCallback   patchCallbacks   define      5!!      !   eventTargetPatch  
                     &   &                        !!      _global   api         !!          eventNames)   zoneSymbolEventNames   TRUE_STR   FALSE_STR%   ZONE_SYMBOL_PREFIX   EVENT_TARGET           !!         i         !!         eventName   falseEventName   trueEventName   symbol   symbolCapture          +H!!            ;                          ?                                                                                   +                  Q    T    
=   : 7         T    
:  5      Q5     Q5     Q5     Q5     QQ  Q>  Q    m       	  
    QV   V  7  QV  V    QV  V  	  QV  V  
  QV  V	    QV  V  [    9QV  V  7V  V
  9QV  V  7V  V  9Q   V  W  QQ   V  V   	   C   T  5
     QV   D   "   QV  5    $      %   %   T    
T  Z   V  E   (   QV  5   )   `     QC,	 
 
^&       
4#"" 
/ 
 
 
 
 	   Zone   symbol!   patchEventTarget!   getGlobalObjects   eventNames)   zoneSymbolEventNames   TRUE_STR   FALSE_STR%   ZONE_SYMBOL_PREFIX   length   EventTarget   prototype      5!!         patchEvent  
                    >  +                            !!      global   api         +H;                             T     
T  T  Q '   patchEventPrototype      5!!         pDpN/</Zone$1<c   r                     H  =  ?  =          K              !!      global'   drainMicroTaskQueue   __symbol__	   noop#   scheduleMicroTask	   mark%   performanceMeasure        !!          ZoneDelegate3   _isDrainingMicrotaskQueue   _microTaskQueue7   nativeMicroTaskQueuePromise3   _numberOfNestedTaskFrames	   Zone   _currentTask#   _currentZoneFrame   ZoneTask   scheduled   NO_ZONE   macroTask   DELEGATE_ZS   symbolPromise   symbolThen   notScheduled   canceling   performance	   _api   running   unknown   scheduling   eventTask   checkDuplicate!   symbolSetTimeout   microTask   patches   symbolPrefix	           !!      	   Zone            !!         ZoneDelegate           !!         ZoneTask            +H!!      	   mark  t                                                       !!   	   name         +H;   C                     
           E2      Q   5    E      Q       
T  : 
   Q2 	   mark      5!!      %   performanceMeasure  u   #                  
  }    }                            !!   	   name   label         +H;   F                                E5      Q   5    E       Q       
T  T :    Q5    measure      5!!         __symbol__  }                                                       !!   	   name         +H;       	                             T  $       5!!      #   scheduleMicroTask  w  "                 x  }  x  }                           !!   	   task         !!          nativeThen          +H;      X      E  m                 +           >HE      Q          >H      	          @              7&           7   
>:    Q      g         Q         7   QV             5   W   Q   V      
     l Q&   "           
  > Q'   T  E"   (   Q         
T  : +   Q4%    length   resolve	   then	   call	   push      5!!      '   drainMicroTaskQueue     $          	       }    }                            !!               !!          queue           !!         i         !!      	   task          !!         error         +H;        w             ]             &         +         K             b   h            &         =            	                    ,     C   Q      m      Q         QZ       Q  Q>  Q    m     QV   V  7  QV  5       
V  @@ Q3   
     Qv  Q         
V   Q       V  W  QQ   V  V      m                           
  QB   Q   (   /"&  r   ;%
& 6  $   	   zone   runTask!   onUnhandledError   length%   microtaskDrainDone      5!!   	   	   noop                         5!!      	   Zone`                    7      6C                          !!      parent   zoneSpec   .this        +H!!            ;      #                     W   QV   T  0    QV   T ,      T 5   D      Q=            =      0   QV   T E   	   QT 5   
   D      Q[       0   QV       AV   V   5    E      QV   5    5      T ,  R 0   Q    _parent	   name   unnamed   <root>   _name   properties   _properties   _zoneDelegate         5!!      #   assertZonePatched@     $                                                    !!               +H;   =                     	        5        5   I         A=   ,  R p	         Promise!   ZoneAwarePromise   Error9  Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.
Most likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)      5!!   	      get root                           5!!         get current                                                         !!               +H;      	                        	  	  5    # 	   zone      5!!   	      get currentTask  '  B    B     "             5!!         __load_patch@                       !    !                           !!   	   name   fn         !!          perfName           +H;   u   _         J                              
T  : ?          !   	         =   T  : p           =   T  7 i         Q=   T     Q  V    Q  T  T             : 9Q  V   V    Q   #%    hasOwnProperty   Error-   Already loaded patch:    __Zone_disable_   Zone:      5!!   	      get parent  !  !  !  !                 5!!   	      get name  !  "  !  "                 5!!         get@                    ""  "  "  "                          !!      key   .this        !!       	   zone          +H;      @       ?             G                        W   Q  QV       
T  :   QV        V  5   T  7       getZoneWith   _properties     5!!         getZoneWith@                    "  	$  "  	$                         !!      key   .this        !!          current         +H;          N         q       J              u             x   M                	     W   Q  QV     Q   D   m   V  5       
T  :       V     V  5   W  Q   V  	   @(N              _properties   hasOwnProperty   _parent     5!!      	   fork@                    $  $  $  $                           !!      zoneSpec   .this        +H;   H                   	     W   QT             A=   ,  R p   V   5      
V   T  :     Error%   ZoneSpec required!   _zoneDelegate	   fork     5!!   	   	   wrapB $  &  $  &                    source    _callback 	   zone   B  #&  &  &  &                 55!!         run@                    &  )(  &  )(                        !!      callback   applyThis   applyArgs   source   .this        +H!!       !!   parent!!!!	   zone!!    ;       *   H   X   h         2                     W   Q[    	  	  ]    V   ]   	  QV   5      
V   T  T T T : B~   t      B~  t      !      	  5    	  Qu    D        parent	   zone   _zoneDelegate   invoke     5!!   	      runGuardedB @(  *  6(  *                 5!!         runTask@                    *  4  *  4                       !!   	   task   applyThis   applyArgs   .this        !!          reEntryGuard   previousTask          !!         error         +H!!       !!   parent!!!!	   zone!!    ;          7                                                       <         k                       b    8 W   Q    QT  5    V   [         A=   T  5    D   
   Q       5   =   V   5   =   ,  R p   T  5       HE<      QT  5       HD      QT  5       H            T  5         QV  E'   "   QT     
      : &   QT  5	   
0	   QQ      QT    Q[    	  	  ]
   V   ]    	  QT  5       E,   2   QT  5   E   4   QT  5   5    7      8   T     0   Q:   V   5      
V   T  T T : B~   tn   =   I   =     Qv  QV   5      
V   V  :    A   V  pA    A   B~  t   A   L  A   T  5       IE   E   QT  5       IH      I   T  5       D+   M   QT  5   E   O   QT  5   5   Q   @   R   V  E'   S   QT     
      : W   Q^   W   T  >0	   QV      
T   QV  E,   [   QT     
        : `   Q`   	  5
   	  QV    Qu b   0        %%  '3   	"% 	   zone   Errorw   A task can only be run in the zone of creation! (Creation: 	   name   ; Execution:    )   state	   type   _transitionTo   runCount   parent	   data   isPeriodic   undefined   cancelFn   _zoneDelegate   invokeTask   handleError!   _updateTaskCount     5!!         scheduleTask@ !                  4  ;  4  ;                         !!   	   task   .this        !!          zoneDelegates          !!         newZone         !!         err         +H;       T   q             #              ;             A  P                                         4    ! W   Q  QT  5    E      QT  5    V   I           QV     Q   g   m   V  T  5    H=   
         =   V   5   =   T  5    5   : p   V  5   W  Q   V        T     
         QZ      QT  V  0   QT  V   0   QV   5	   
   
V   T  : U  Q]        Qv  QT     
         QV   5	      
V   V   QV  p '   T  5   V  H   *   V      
T  ? Q,   T  5     '   0   T     
       Q4   T  !"(q &*7 & -& 	   zone   Error7   can not reschedule task to 	   nameW    which is descendants of the original zone    parent   _transitionTo   _zoneDelegates   _zone   _zoneDelegate   scheduleTask   handleError!   _updateTaskCount   state  	   5!!      #   scheduleMicroTask@ E                  ;  m<  ;  m<                           !!      source   callback	   data   customSchedule   .this        +H;   C                        W   QV       

  
  A    T  T T T    ,  R :     scheduleTask   undefined     5!!      #   scheduleMacroTask@ H                  <  J=  z<  J=                           !!      source   callback	   data   customSchedule   customCancel   .this        +H;   A                        W   QV       

  
  A    T  T T T T ,  R :     scheduleTask     5!!      #   scheduleEventTask@ K                  h=  '>  W=  '>                           !!      source   callback	   data   customSchedule   customCancel   .this        +H;   A                        W   QV       

  
  A    T  T T T T ,  R :     scheduleTask     5!!   	      cancelTaskB >>  A  4>  A  N              5!!      !   _updateTaskCount@ a                   A  ,C  A  ,C                          !!   	   task   count         !!          zoneDelegates           !!         i         +H;       D   O                2   g             S                         QT  5       QT       T  @0    Q     Q>  Q ;   m   V   V  7   
T  5   T  Q   V  W  QQ   V  V         *&&;)O f f: h f     _zoneDelegates!   _updateTaskCount	   type   length      5!!   	      onHasTaskD# C  :D  C  :D  o               5!!         onScheduleTaskE! p                    XD  D  XD  D                            !!      delegate   _   target	   task         +H;                             T      
T T : ;	    scheduleTask      5!!   	      onInvokeTaskD# D  "E  D  "E  q               5!!   	      onCancelTaskD# >E  ~E  >E  ~E  r               5!!       !!	   name!!!!   onHasTask!!!!   onScheduleTask!!!!   onInvokeTask!!!!   onCancelTask!!    !!         ZoneDelegate` u                  E  fX  E  i                         !!   	   zone   parentDelegate   zoneSpec   .this        !!          zoneSpecHasTask   parentHasTask          +H!!       !!   microTask!!!!   macroTask!!!!   eventTask!!    ;        '     y                   = W   Q    QV   [    >]    >]   >]   0   QV   T  0   QV   T 0   QV   T EE      QT E      QT 5            T       T 5      0   QV   T E2      QT 5         T       T 5      0   QV   T E8      QT 5         V   5         T 5	      0	   QV   T E2      QT 5
         T       T 5       0   QV   T E2   "   QT 5
      $   T    $   T 5   %   0   QV   T E8   '   QT 5
      )   V   5      *   T 5   +   0   QV   T E2   -   QT 5      /   T    /   T 5   0   0   QV   T E2   2   QT 5      4   T    4   T 5   5   0   QV   T E8   7   QT 5      9   V   5      :   T 5   ;   0   QV   T E2   =   QT 5      ?   T    ?   T 5   @   0   QV   T E2   B   QT 5      D   T    D   T 5   E   0   QV   T E8   G   QT 5      I   V   5      J   T 5   K   0   QV   T E2   M   QT 5      O   T    O   T 5   P   0   QV   T E2   R   QT 5      T   T    T   T 5   U   0   QV   T E8   W   QT 5      Y   V   5      Z   T 5   [   0   QV   T E2   ]   QT 5      _   T    _   T 5   `   0   QV   T E2   b   QT 5      d   T    d   T 5   e   0   QV   T E8   g   QT 5      i   V   5      j   T 5   k   0   QV   T E2   m   QT 5      o   T    o   T 5   p   0   QV   T E2   r   QT 5      t   T    t   T 5    u   0    QV   T E8   w   QT 5      y   V   5      z   T 5!   {   0!   QV   @0"   QV   @0#   QV   @0$   QV   @0%   QT E      QT 5&        QT E      QT 5"        QV  D      QV     E     V   V        T                0"   QV   T 0#   QV   V   0$   QV   T  0%   QT 5    >      V         0   QV   T 0   QV   V   5   0   Q   T 5    >      V         0   QV   T 0   QV   V   5   0   Q   T 5    >      V         0   QV   T 0    QV   V   5   0!   Q   8(&    microTask   macroTask   eventTask   _taskCounts	   zone   _parentDelegate   onFork   _forkZS   _forkDlgt   _forkCurrZone   onIntercept   _interceptZS   _interceptDlgt%   _interceptCurrZone   onInvoke   _invokeZS   _invokeDlgt   _invokeCurrZone   onHandleError   _handleErrorZS!   _handleErrorDlgt)   _handleErrorCurrZone   onScheduleTask   _scheduleTaskZS#   _scheduleTaskDlgt+   _scheduleTaskCurrZone   onInvokeTask   _invokeTaskZS   _invokeTaskDlgt'   _invokeTaskCurrZone   onCancelTask   _cancelTaskZS   _cancelTaskDlgt'   _cancelTaskCurrZone   _hasTaskZS   _hasTaskDlgt#   _hasTaskDlgtOwner!   _hasTaskCurrZone   onHasTask         5!!      	   fork@                   wX  RY  sX  RY                           !!      targetZone   zoneSpec   .this        +H;   m                        W   QV   5    :      V   5       
V   5   V   5   T  T : "   
         AT  T ,  R    !    _forkZS   onFork   _forkDlgt	   zone     5!!   	      interceptB hY  _Z  _Y  _Z                5!!         invoke@            
       rZ  [  lZ  [                           !!      targetZone   callback   applyThis   applyArgs   source   .this        +H;   q            
            W   QV   5    C      V   5       
V   5   V   5   T  T T T T :       T    
T T O    #    _invokeZS   onInvoke   _invokeDlgt   _invokeCurrZone   apply     5!!   	      handleErrorB [  \  [  \                5!!         scheduleTask@                   \  `  \  `                          !!      targetZone	   task   .this        !!          returnTask         +H;      -      1            4  w                     W   Q  QT   QV   5          V   5   '      V  5      
V   5    Q   V   5       
V   5   V   5   T  T : W  QV         T W  Q   ~      T 5          T    
T  QQ      T 5	                 T  Q      
   A=   ,  R p   V  +!"    _scheduleTaskZS   _hasTaskZS   _zoneDelegates	   push#   _hasTaskDlgtOwner   onScheduleTask#   _scheduleTaskDlgt+   _scheduleTaskCurrZone   scheduleFn	   type   Error7   Task is missing scheduleFn.     5!!         invokeTask@            	       `  a  `  a                           !!      targetZone	   task   applyThis   applyArgs   .this        +H;   s            	           	 W   QV   5    @      V   5       
V   5   V   5   T  T T T : "      T 5      
T T O    '"    _invokeTaskZS   onInvokeTask   _invokeTaskDlgt'   _invokeTaskCurrZone   callback   apply     5!!   	      cancelTaskB b  c  b  c                5!!         hasTask@                   d  e  d  e                         !!      targetZone   isEmpty   .this        !!          err         +H;           J      X   #         &                     W   QV   5    E6      QV   5       
V   5   V   5   T  T : 
   Q0   
     Qv  QV      
T  V   Q    F(    _hasTaskZS   onHasTask   _hasTaskDlgt!   _hasTaskCurrZone   handleError     5!!      !   _updateTaskCount@ 
           	       Cf  i  3f  i                         !!   	   type   count   .this        !!          counts	   prev	   next          !!         isEmpty          +H!!       !!   microTask!!!!   macroTask!!!!   eventTask!!!!   change!!    ;               e       	      W         	           
 W   Q      QV   5      QV  T  7  QV  T  V  T 9  QV  >   	      A=   ,  R p   V  >D      QV  >   o        Q[    V  5   >]   V  5   >]   V  5   >]   T  ]     QV      
V   5   V   Q   *$    _taskCounts   ErrorQ   More tasks executed then were scheduled.   microTask   macroTask   eventTask   change   hasTask	   zone     5!!         ZoneTask`                     @i  .n  i  bv                         !!   	   type   source   callback   options   scheduleFn   cancelFn   .this        !!       	   self          +H!!      )   ZoneTask/this.invokec   4  +                m  n  m  n                           !!      arguments   .this          +H;   >                         	W   QW  Q    5       
        V  V   l     invokeTask	   call    5;      $     0  x                     W   Q   V   @0    QV   >0   QV   @0   QV   =   0   QV   T  0   QV   T 0   QV   T 0   QV   T 0   QV   T 0	   QT        
   A=   ,  R p   V   T 0   QV      QT      HE!      QT E      QT 5      (      V       5   0   Q      V       0   Q   O    _zone   runCount   _zoneDelegates   notScheduled   _state	   type   source	   data   scheduleFn   cancelFn   Error/   callback is not defined   callback	   useG   invokeTask   invoke5!!         invokeTask@ 9                  Ln  Xp  Bn  Xp                         !!   	   task   target	   args   .this        +H;       6   V   r            O                    	 W   QT         V   U  Q         QQT  5    
0    QQT  5      
T  T T : B~   t      B~  t      @        ?          Q       QQu    R H B    runCount	   zone   runTask     5!!         get zone  I                  mp  p  ep  p                           !!      .this          +H;      	                      W   QV   5        _zone     5!!         get state  J                  p  p  p  p                           !!      .this          +H;      	                      W   QV   5        _state     5!!   	   +   cancelScheduleRequestB  p  q  p  q  K  !            5!!         _transitionTo@ M                  oq  s  bq  s                           !!      toState   fromState1   fromState2   .this        +H;     D                "     W   QV   5    T HD      QV   5    T H	   D   
   V   T  0    QT            V   @0   Q            AV   5   =   V   5   =   T  =   T =   T       =	   T =         =
      =   V   5    =   ,  R p"   (8Y    _state   _zoneDelegates   Error	   type    '   source5   ': can not transition to ')   ', expecting state '   '    or '      , was '   '.     5!!   	      toStringB  s  t  s  t  X              5!!   	      toJSONB  Ou  Xv  Iu  Xv  b              5!!       !!	   name!!    !!            !!   	   !   currentZoneFrameD#  y    y                   5!!   	   #   showUncaughtErrorD#  -  g  -  g                 5!!   	   !   patchEventTargetD#                         5!!   	      patchMethodD#                         5!!   	      bindArgumentsD#                         5!!   	      patchThenD#    !    !                 5!!   	      patchMacroTaskD#  ?  I  ?  I                 5!!   	   !   setNativePromiseD# i    i                   5!!   	   '   patchEventPrototypeD#            !             5!!   	      isIEOrEdgeD#  7  B  7  B                 5!!   	   !   getGlobalObjectsD#  b  q  b  q                 5!!   	   )   ObjectDefinePropertyD#            "             5!!   	   =   ObjectGetOwnPropertyDescriptorD#            ,             5!!   	      ObjectCreateD#                         5!!   	      ArraySliceD#  !  )  !  )                 5!!   	      patchClassD#  C  M  C  M                 5!!   	   '   wrapWithCurrentZoneD#  p  z  p  z    !             5!!   	   !   filterPropertiesD#                         5!!   	   +   attachOriginToPatchedD#            #             5!!   	   #   _redefinePropertyD#                         5!!   	      patchCallbacksD#    $    $                 5!!       !!   symbol!!!!!   currentZoneFrame!!!!!   onUnhandledError!!!!%   microtaskDrainDone!!!!#   scheduleMicroTask!!!!#   showUncaughtError!!!!!   patchEventTarget!!!!#   patchOnProperties!!!!   patchMethod!!!!   bindArguments!!!!   patchThen!!!!   patchMacroTask!!!!!   setNativePromise!!!!'   patchEventPrototype!!!!   isIEOrEdge!!!!!   getGlobalObjects!!!!)   ObjectDefineProperty!!!!=   ObjectGetOwnPropertyDescriptor!!!!   ObjectCreate!!!!   ArraySlice!!!!   patchClass!!!!'   wrapWithCurrentZone!!!!!   filterProperties!!!!+   attachOriginToPatched!!!!#   _redefineProperty!!!!   patchCallbacks!!    !!       !!   parent!!!!	   zone!!    ;                        $            t  |            f                    U                         '          Q     Q     Q     Q     Q     Q  5       Q  =    Q  5   D   	   Q=   	      Q    =   : 7CH   Q  5   i         D!      Q  5   5   =   I   "         A=   ,  R p        5         Y       
	   
   Q      QQ      QQ	      QQ
      QQ      Q                                                                                          Q      Q        0   Q[   =   ]      ]       ]!      ]"      ]#      Q   QY        
	   
   !      "   $   #   %   $   &   %      &   '   '      (   (   )      Q      Q   Y    *   
	   
   Q+   '   Q,   )   -   *   .   +   /   ,   0   -   1   .   Q    
  Q  =/   :    Q  =0   :    Q  =1   :    QZ       QB   Q   Q[2   =2   ]      Q=3      Q=4      Q=5      Q=6      Q=7      Q=8      Q=9      Q=:      Q=;      Q[3      Q[I     ]<   4   ]=     ]>     ]?     ]   5   ]@   6   ]A     ]B   7   ]C   8   ]D   9   ]E   :   ]F   ;   ]G   <   ]H   =   ]I   >   ]J   ?   ]K   @   ]L   A   ]M   B   ]N   C   ]O   D   ]P   E   ]Q   F   ]R   G   ]S   H   ]T      Q[J   @]      A@@,  R ])    	  Q@   Q>   Q  =   =    Q     0   &x|~                          ! E a l         
  9 I X b q!(   (    performance	   Zone)   __Zone_symbol_prefix   __zone_symbol__/   forceDuplicateZoneCheck   __symbol__   function   Error)   Zone already loaded.   prototype   constructor#   assertZonePatched	   root   current   currentTask   __load_patch   parent	   name   get   getZoneWith	   fork	   wrap   run   runGuarded   runTask   scheduleTask#   scheduleMicroTask#   scheduleMacroTask#   scheduleEventTask   cancelTask!   _updateTaskCount      onHasTask   onScheduleTask   onInvokeTask   onCancelTask   intercept   invoke   handleError   invokeTask   hasTask	   zone   state+   cancelScheduleRequest   _transitionTo   toString   toJSON   setTimeout   Promise	   then   NO ZONE   notScheduled   scheduling   scheduled   running   canceling   unknown   microTask   macroTask   eventTask   symbol!   currentZoneFrame!   onUnhandledError%   microtaskDrainDone#   showUncaughtError!   patchEventTarget#   patchOnProperties   patchMethod   bindArguments   patchThen   patchMacroTask!   setNativePromise'   patchEventPrototype   isIEOrEdge!   getGlobalObjects)   ObjectDefineProperty=   ObjectGetOwnPropertyDescriptor   ObjectCreate   ArraySlice   patchClass'   wrapWithCurrentZone!   filterProperties+   attachOriginToPatched#   _redefineProperty   patchCallbacks5!!         pDpN/</<e                
                                     !!      global	   Zone   api   zoneify/   scheduleResolveOrReject)   clearRejectedNoCatch!   forwardRejection1   handleUnhandledRejection   resolvePromise-   readableObjectToString#   forwardResolution   isThenable   patchThen   makeResolver       !!       	   desc!   ZoneAwarePromiseS   isDisableWrappingUncaughtPromiseRejection   source   NativePromise3   REJECTION_HANDLED_HANDLER)   ObjectDefineProperty=   ObjectGetOwnPropertyDescriptor#   REJECTED_NO_CATCH   symbolPromise	   noop   symbolThen#   symbolThenPatched%   ZONE_AWARE_PROMISE   __symbol__1   symbolParentPromiseState   RESOLVEDU   UNHANDLED_PROMISE_REJECTION_HANDLER_SYMBOL   symbolValue   UNRESOLVED3   CURRENT_TASK_TRACE_SYMBOL-   _uncaughtPromiseErrors	   once   symbolFinally9   ZONE_AWARE_PROMISE_TO_STRING   symbolState   creationTrace1   symbolParentPromiseValue   REJECTED   TYPE_ERROR         !!      !   ZoneAwarePromise          !!         fetch          +H!!   	   -   readableObjectToString x    Y      '             5!!   	   1   handleUnhandledRejection           )            5!!         isThenable                      	  0    0                            !!      value         +H;      	                       T  E      QT  5       % 	   then      5!!      #   forwardResolution    "                  S  l  9  l                            !!      value         +H;                               T  ,       5!!   	   !   forwardRejection     u      !             5!!         makeResolver                                                       !!      promise   state        +H!!          makeResolver/<e                                                     !!      v         !!          err          +H;                 $   !       L                    	     	        T   Q.         Qv   Q	     BV    Q 	          5;                                    ( 5!!         resolvePromise   8                    h    Q     
                    !!      promise   state   value        !!          onceWrapper           !!      	   then         !!         err         !!         err         !!         queue          !!         trace          !!         i         !!      )   uncaughtPromiseError         !!         err         +H!!   	   !   resolvePromise/<d"          F                5!!   	   !   resolvePromise/<d"    H    H  U  $             5!!       !!   configurable!!!!   enumerable!!!!   writable!!!!   value!!    ;        {   X           
  G          '  v             m          (     n               %                                            ]                     g                        8     	        
       &            )                      t    Q    :     Q   T H"   	       A    ,  R p          7    H       Q@  QT '=   HD      QT '=   H   *      T E      QT 5      W  Q   7         v   QV       :   Q      T     IEr       QT     rEY   #   QT    
  : E<   '   QT    
    : E   +   QT   7  I/   B   0     T  Q	     T   7T     7 QH  9   T     IE   <   QV  '=   H>      ?   V     
T V        T : : V        B: : l Q-   I      v   QV      :   Q K     K     Q     T 9Q       7  Q     T 9Q       7  HZ   Z   T     HB   ]               79Q            79Qi   T     HE   l   QT    rn      o     Q  5   E?   r   Q  5   5   E%   v   Q  5   5       7{     QV  F   |       T     [   C]	   B]
   C]   V  ]    Q        Q>  Q b   m        V  V  W  Q7V  V  W  Q7V  V  W  Q7V  V  W  Q7 Q      V  V        V     >E      QT        B       Q         9QT   Q              A=   
  T : T E      QT 5            =   T 5         =      ,  R p#        Qv  QV  W  Q    V  T 0   QV     0   QV    5   0   QV    5   0   Q       
V   Q     
  Q            7 %T;  J%C7 ;" g.&9&b]v p p$(3i , ~&(      TypeError   object   function	   then   hasOwnProperty	   call   Error   currentTask	   data   configurable   enumerable   writable   value   length/   Uncaught (in promise):    stack   
      rejection   promise   current	   zone	   task	   push#   scheduleMicroTask5!!      )   clearRejectedNoCatch    %                l    O                          !!      promise   .this        !!          handler          !!          err         !!          i         +H!!       !!   rejection!!!!   promise!!    ;        *                m      *   }                        e                  &     W   QT        7      H@       Q        7  QV  E      QV  '=    H   =      V     
V   [    T        7]   T  ]   l Q           Qv  Q    T           9Q  Q>  Q S   m   T        V  75   H            
V  ? Q    V  W  QQ!   V           &   &    ~$!&SAm  C        function	   call   rejection   promise   splice   length  	   5!!      /   scheduleResolveOrReject                                                      !!      promise	   zone   chainPromise   onFulfilled   onRejected        !!          promiseState   delegate            +H!!      3   scheduleResolveOrReject/<e     +          	       [    [                            !!               !!       %   parentPromiseValue!   isFinallyPromise   value           !!          error          +H;           6        1     >  !      f  _          	       ,             Q      7   Q    E!      Q        7H     QV  :            V   9Q            9Q         
         V  E,      Q     IE      Q     I!      "   Z       #   Z   V   `    %   :   Q	    CV   Q.   )      Qv   Q	    BV    Q ,    2/-" '    run   undefined      5;               =                               Q      7   Q   :      T '=    H      T            0      T '=    H      T               Q     
           Q_!       function#   scheduleMicroTask5!!         patchThen   x                    N    <                           !!   	   Ctor         !!          proto	   prop   originalThen           +H!!   	   ;   patchThen/Ctor.prototype.thenb   t    t    +               .this   D"   *    *    5             55;             y                N                     
         QT  5       Q    V   =   :   QV  E+      QV  5   BHD   	   QV  5                V   5      QV          9QT  5        0   QT      C9Q!$  !    prototype	   then   writable   configurable5!!         zoneify                                                       !!      fn        +H!!    	      zoneify/<b  
                     5;                                     5!!   	   ;   pDpN/</</api.onUnhandledErrord" W  d  W  d                 5!!      ?   pDpN/</</api.microtaskDrainDonee                                                      !!               !!       )   uncaughtPromiseError            !!         error          +H!!   	   C   pDpN/</</api.microtaskDrainDone/<d"  _    _      9             5;        /              
            d      V                E                          s   m              
:     Q   5      
     Q(         Qv   Q  V    Q 
   
            }   -   2-      shift	   zone   runGuarded   length5!!      	   onceC   )                     8    /                           !!               !!          wasCalled           +H!!         wrapperC   +                        s                           !!      wrapper          !!          wrappedFunction        +H!!         wrapper/<c   ,                                                     !!      arguments          +H;   >   *                      	W   Q             C  Q       
@V   O Q 0    apply     5;                                   3 5;                                                          B   Q    ! 4 5!!      	   noopC                       T  Z  K  Z                            !!               +H;                                 #       5!!      !   ZoneAwarePromise`            
       J    d                           !!      executor   .this        !!          promise          !!         error         +H;        w   N                                O         
            W   Q  QV     QV        r           A=   ,  R p   V          9QV      Z    9QT  E@      QT    V      :   V      : :    Q-        Qv  Q	  V  BV   Q    " J!    Error=   Must be an instanceof Promise.         5!!   	      toStringB                         5!!         resolve@                     =    =                           !!      value   .this        +H;    +                        W   Q	  V   A@,  R     T  :       5!!   	      rejectB W    Q                  5!!   	   	   raceB   5    5                   resolve    reject   D" 9    9      '             5	      onResolve           "             5	      onReject           !             55!!         all@                     L    I                              !!      values         +H;                                       
T  : !    allWithCallback      5!!   	      allSettledB                         D" o    o      "             5   D"           #             55!!         allWithCallback@                     2  2  #  2                       !!      values   callback   .this       !!          resolve   reject   promise   unresolvedCount   valueIndex   resolvedValues         !!         value         !!         curValueIndex          !!         thenErr         +H!!      1   allWithCallback/promise<e    '                                                    !!      res   rej         +H;                               T        QT       Q       5!!      #   allWithCallback/<e    #                    Q    Q                            !!      value         +H;      %                                   !            
T  :    	   T  	   9Q      QQ  >H             Q   4      thenCallback      5!!   	   #   allWithCallback/<d" S  \  S  \                 5;                                 u  _                      s   y        %     S                                    .            1                  +     W   Q       Q   Q   QV   A    ,  R   Q   Q>  QZ       Q  QT  -
  5    
r  m     QQ:   5         QU     5     Q     V  :  !      V      
V  : W  Q   V     QV     
       Q(        Qv  Q  V   Q        QQV  W  QQ      v,  Im      ,     IE      Q@I   7        
,  ,  :  
Q   !   vQ !   QQ   !   Q!   Q!   p !   !   B#          Q   >H   (          Q+   V  5 &!'"@ yP  * $ "  	   next	   done   value   resolve	   then   return5!!                &  $             5!!                '                5!!      	   then@ (                                                  !!      onFulfilled   onRejected   .this        !!          C   chainPromise	   zone         +H;      '      +            .  L                     W   Q      QV   5       5   7  QV   D   	   QV  '=   I   2      V   5    D      Q         W  Q   V  A
  
  ,  R   Q  5     QV       7    7      V       7   
V  V  T  T  Q&        V   V  V  T  T  Q   V  *%    constructor   Symbol   species   function   current	   push     5!!         catch@ 7                                                   !!      onRejected   .this        +H;                           W   QV       
@T  :  	   then     5!!   	      finallyB #        :              5!!       !!   configurable!!!!   enumerable!!    !!      #   pDpN/</</desc.getc   Z                     ,    #                              !!               +H;    F                          	         7           7         	   	  7          5!!      #   pDpN/</</desc.setc  _                     ?    6                              !!   !   NewNativePromise         +H;      ;                       T        H#              T  9Qa         	   	  T  9QT  5          7         T   Q        
T   Q    m    prototype!   setNativePromise      5;      9     #              t           <         .   ?           
       w    H          Q    
  Q     Q     Q     Q     Q     Q   	  Q     Q     Q	     Q
   W   Q    5      Q    5      Q  5     QZ       Q  V  =   : 7CH   QV  =   :  	  QV  =   :    Q=      Q     0   Q     0	   QV  =
   :    QV  =   :    QV  =   :    QV  =   :    QV  =   :    QV  =   :    Q=      Q@   QC   QB   Q>   Q      Q=      QV  =   :    QV  =   :    Q=      Q    
  Q   Y       
      Q      QQ      QQ      QQ      QQ      QQ      QQ      Q   5      ,     5       ,           !         Q      Q         5   0   Q      5   0   Q      5   0   Q      5   0   Q   	    5   9  Q  "   
=#   :    Q     =   :   QV   D   K   QV  5$   L      M   V  E   N   QV  .%   N   QV  E   O   QV  .   O   QV       Q   [   C]$   C]&   W  QT   V     0'   QV     0(   Q     =   V   QY        0   QV  =)   :    Q    0*   QV  ~   a     Q  V   Q  5+     QV  '=,   @   h          
=+   : V  9Q  V   V  : 0+   Qp   p        "   
=-   :    9Q   A/% ':  ; ))" ) 5* * -   & 7 M#	 _ t"      Object1   getOwnPropertyDescriptor   defineProperty   symbolW   DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION   Promise	   then#   __creationTrace__!   onUnhandledError%   microtaskDrainDoneA   unhandledPromiseRejectionHandler   state   value   finally%   parentPromiseValue%   parentPromiseState   Promise.then9   Promise resolved with itself!   currentTaskTrace/   rejectionHandledHandler[   function ZoneAwarePromise() { [native code] }   prototype   constructor   toString   resolve   reject	   race   all   allSettled   allWithCallback   Symbol   toStringTag   species   catch   __symbol__!   ZoneAwarePromise   configurable   writable   enumerable   get   set   thenPatched   patchThen   fetch   function+   uncaughtPromiseErrors5!!            !!            !!            !!   	      wrapFnB   =    =               5!!         pDpN/</<e   O                    J) 71 J) 71                       !!      global        !!       1   originalFunctionToString1   ORIGINAL_DELEGATE_SYMBOL   PROMISE_SYMBOL   ERROR_SYMBOL'   newFunctionToString-   originalObjectToString1   PROMISE_OBJECT_TO_STRING           +H!!   	      toStringB  * . * . U  5     
       5!!   	   E   pDpN/</</Object.prototype.toStringb  0 01 y0 01 t  -            5;               N                            Q    5   5      Q    =   :    Q  =   :    Q  =   :    Q       QV         9Q    5   V   0   Q   5   5      Q=      Q   5      0   Q.))- o') z    Function   prototype   toString!   OriginalDelegate   Promise   Error   Object!   [object Promise]5!!            !!         getC    Q                  2 2 2 2                           !!               +H;       	                         C      QV       5!!       !!   get!!    !!       !!	   useG!!    !!            !!            !!   `   !!   abort!!   animationcancel!!   animationend!!%   animationiteration!!   auxclick!!   beforeinput!!	   blur!!   cancel!!   canplay!!   canplaythrough!!   change!!!   compositionstart!!#   compositionupdate!!   compositionend!!   cuechange!!   click!!   close!!   contextmenu!!   curechange!!   dblclick!!	   drag!!   dragend!!   dragenter!!   dragexit!!   dragleave!!   dragover!!	   drop!!   durationchange!!   emptied!!   ended!!   error!!   focus!!   focusin!!   focusout!!#   gotpointercapture!!   input!!   invalid!!   keydown!!   keypress!!   keyup!!	   load!!   loadstart!!   loadeddata!!   loadedmetadata!!%   lostpointercapture!!   mousedown!!   mouseenter!!   mouseleave!!   mousemove!!   mouseout!!   mouseover!!   mouseup!!   mousewheel!!#   orientationchange!!   pause!!	   play!!   playing!!   pointercancel!!   pointerdown!!   pointerenter!!   pointerleave!!#   pointerlockchange!!)   mozpointerlockchange!!3   webkitpointerlockerchange!!!   pointerlockerror!!'   mozpointerlockerror!!-   webkitpointerlockerror!!   pointermove!!   pointout!!   pointerover!!   pointerup!!   progress!!   ratechange!!   reset!!   resize!!   scroll!!   seeked!!   seeking!!   select!!   selectionchange!!   selectstart!!	   show!!	   sort!!   stalled!!   submit!!   suspend!!   timeupdate!!   volumechange!!   touchcancel!!   touchmove!!   touchstart!!   touchend!!!   transitioncancel!!   transitionend!!   waiting!!   wheel   !!      !!%   afterscriptexecute!!'   beforescriptexecute!!!   DOMContentLoaded!!   freeze!!!   fullscreenchange!!'   mozfullscreenchange!!-   webkitfullscreenchange!!%   msfullscreenchange!!   fullscreenerror!!%   mozfullscreenerror!!+   webkitfullscreenerror!!#   msfullscreenerror!!!   readystatechange!!!   visibilitychange!!   resume   !!      !!3   absolutedeviceorientation!!   afterinput!!   afterprint!!   appinstalled!!'   beforeinstallprompt!!   beforeprint!!   beforeunload!!   devicelight!!   devicemotion!!#   deviceorientation!!3   deviceorientationabsolute!!   deviceproximity!!   hashchange!!   languagechange!!   message!!   mozbeforepaint!!   offline!!   online!!   paint!!   pageshow!!   pagehide!!   popstate!!!   rejectionhandled!!   storage!!%   unhandledrejection!!   unload!!   userproximity!!%   vrdisplayconnected!!+   vrdisplaydisconnected!!-   vrdisplaypresentchange   !!      !!   beforecopy!!   beforecut!!   beforepaste!!	   copy!!   cut!!   paste!!   dragstart!!   loadend!!   animationstart!!   search!!   transitionrun!!   transitionstart!!%   webkitanimationend!!1   webkitanimationiteration!!)   webkitanimationstart!!'   webkittransitionend   !!      !!   encrypted!!   waitingforkey!!   msneedkey!!#   mozinterruptbegin!!   mozinterruptend   !!   7   !!   activate!!   afterupdate!!   ariarequest!!   beforeactivate!!!   beforedeactivate!!   beforeeditfocus!!   beforeupdate!!   cellchange!!   controlselect!!   dataavailable!!   datasetchanged!!   datasetcomplete!!   errorupdate!!   filterchange!!   layoutcomplete!!   losecapture!!	   move!!   moveend!!   movestart!!   propertychange!!   resizeend!!   resizestart!!   rowenter!!   rowexit!!   rowsdelete!!   rowsinserted!!   command!!/   compassneedscalibration!!   deactivate!!	   help!!   mscontentzoom!!5   msmanipulationstatechanged!!   msgesturechange!!%   msgesturedoubletap!!   msgestureend!!   msgesturehold!!   msgesturestart!!   msgesturetap!!'   msgotpointercapture!!   msinertiastart!!)   mslostpointercapture!!   mspointercancel!!   mspointerdown!!   mspointerenter!!   mspointerhover!!   mspointerleave!!   mspointermove!!   mspointerout!!   mspointerover!!   mspointerup!!   pointerout!!;   mssitemodejumplistitemremoved!!!   msthumbnailclick!!	   stop!!   storagecommit   !!      !!	   blur!!   error!!   focus!!	   load!!   resize!!   scroll!!   messageerror   !!   	   !!   loadstart!!   progress!!   abort!!   error!!	   load!!   progress!!   timeout!!   loadend!!!   readystatechange   !!      !!   upgradeneeded!!   complete!!   abort!!   success!!   error!!   blocked!!   versionchange!!   close   !!         pDpN/</<e   !
                    1 @ 1 @                        !!      global	   Zone   api         !!       5   SYMBOL_BLACK_LISTED_EVENTS/   SYMBOL_UNPATCHED_EVENTS           +H!!      ;   pDpN/</</api.getGlobalObjectse   B
                    d 9 d 9                          !!               +H!!       !!   globalSources!!!!)   zoneSymbolEventNames!!!!   eventNames!!!!   isBrowser!!!!   isMix!!!!   isNode!!!!   TRUE_STR!!!!   FALSE_STR!!!!%   ZONE_SYMBOL_PREFIX!!!!-   ADD_EVENT_LISTENER_STR!!!!3   REMOVE_EVENT_LISTENER_STR!!    ;      )                        [          ]          ]    
   
  ]         ]         ]    (   (  ]         ]    '   '  ]         ]           ]	         ]
   &.    globalSources)   zoneSymbolEventNames   eventNames   isBrowser   isMix   isNode   TRUE_STR   FALSE_STR%   ZONE_SYMBOL_PREFIX-   ADD_EVENT_LISTENER_STR3   REMOVE_EVENT_LISTENER_STR      5;                               5          QT   0    QT   0   QT 	  0   QT   0   QT    
=   :    QT    
=   :   QT  V  7      T  V   T  V  79Q   T  V   7#      T V   T V  T  V   799Q   T   0   QT   0   QT   0	   QT       0
   QT  	   	  0   QT       0   QT  "   "  0   QT   0   QT   0   QT   0   QT   0   QT    5   0   QT   0   QT     0   Q5 
,+( #   patchOnProperties   patchMethod   bindArguments   patchMacroTask   __symbol__'   BLACK_LISTED_EVENTS!   UNPATCHED_EVENTS'   patchEventPrototype!   patchEventTarget   isIEOrEdge)   ObjectDefineProperty=   ObjectGetOwnPropertyDescriptor   ObjectCreate   ArraySlice   patchClass'   wrapWithCurrentZone!   filterProperties+   attachOriginToPatched   Object   defineProperty#   _redefineProperty   patchCallbacks!   getGlobalObjects5!!         pDpN/</<e  
                     !  !                          !!      global         !!          legacyPatch           +H;       @      A                            QT         
=   : 7   QV         V     Q   , 	   Zone   __symbol__   legacyPatch      5!!         pDpN/</<e  
                    D - D -                          !!      global         !!          set   clear           +H;       m      n   &                           Q=       Q=     Q  T  V   V  =    Q  T  V   V  =    Q  T  V   V  =    Q,    set   clear   Timeout   Interval   Immediate      5!!         pDpN/</<e    /                  _ M	 _ M	                           !!      global         +H;   U                            T  =    =   =    Q  T  =   =   =    Q  T  =   =   =    Q    request   cancel   AnimationFrame   mozRequest   mozCancel   webkitRequest   webkitCancel      5!!         pDpN/</<e                       r	  r	                       !!      global	   Zone        !!          blockingMethods           !!         i         !!      	   name          +H!!         pDpN/</</<e                        T
 	 T
 	                        !!      delegate   symbol	   name        +H!!    	      pDpN/</</</<b 
 
 
 
                 5;                                    5;       @   ^                .   v          E   .            S                         QZ   =    `    =   `   =   `      Q  Q>  Q J   m     QV   V  7  Q     V       Q   V  W  QQ   V  V         4 	
&J8^ 9 4       alert   prompt   confirm   length5!!         pDpN/</<e    %                 C  C                           !!      global	   Zone   api         !!       3   XMLHttpRequestEventTarget           +H;                K                         Q  T  T  Q  T  T  QT  5       QV   E   
   QV   5      .      T    
T  Z   V   5   `     Q     =    Q  =    Q  =    Q  =    Q<* 3   XMLHttpRequestEventTarget   prototype!   patchEventTarget!   MutationObserver-   WebKitMutationObserver)   IntersectionObserver   FileReader      5!!         pDpN/</<e  #  %                                                !!      global	   Zone   api         +H;                                T T   Q       5!!         pDpN/</<e  &  (                  8  8                            !!      global	   Zone   api         +H;                                T  T  Q       5!!         pDpN/</<e   )                     R/  R/                       !!      global	   Zone   patchXHR       !!          XHR_TASK   XHR_SYNC   XHR_LISTENER   XHR_SCHEDULED   XHR_URL5   XHR_ERROR_BEFORE_SCHEDULED          +H!!         patchXHR   2             	       i L/ X L/                       !!      window   findPendingTask   scheduleTask'   placeholderCallback   clearTask        !!          oriAddListener#   oriRemoveListener   XMLHttpRequest/   XMLHttpRequestPrototype%   READY_STATE_CHANGE   SCHEDULED   openNative+   XMLHTTPREQUEST_SOURCE#   fetchTaskAborting'   fetchTaskScheduling   sendNative   abortNative          !!      3   XMLHttpRequestEventTarget          !!      E   XMLHttpRequestEventTargetPrototype          +H!!   	      findPendingTask     9  $             5!!         scheduleTask   F                     !  !                       !!   	   task        !!       	   data   target   listener   newListener   storedTask           +H!!   	   C   scheduleTask/target[XHR_LISTENER]d"   ?   ?  T  ;                oriInvoke   B  : F 1 F _  7             55;                                           9    -           Q  5       Q   5      Q       B9Q       B9Q       7   Q     ;             7  Q       7    Q   V   2             
       V   l Q            9  Q     
       V  l Q       7  QV      +          9Q/   
  
     
      5   O Q     C9Q  (!$ x# 	   data   target	   call   apply	   args5!!   	   '   placeholderCallback  ! ! ! !   (             5!!   	      clearTask " o# ! o#                5!!      )   patchXHR/openNative<e                         # x$ # x$                         !!               +H!!       -   patchXHR/openNative</<c    [                  # x$ # x$                           !!   	   self	   args         +H;   G                          T      T 7B9QT      T ?79Q          
T  T O     apply      5;                                    R 5!!      )   patchXHR/sendNative<e                         % * % *                         !!               +H!!       -   patchXHR/sendNative</<c    [          	       % * % *                         !!   	   self	   args         !!          options	   task           +H!!       !!   target!!!!   url!!!!   isPeriodic!!!!	   args!!!!   aborted!!    ;   ~      	   h  {          	       .       5     	   	  7CH%   	    
   
     
T  T O    T      7*       
   
     
T  T O            Q[    T  ]   T      7]   B]   T ]   B]      Q          V       :   QT  EO   !   QT      7CHE4   %   QV   5    E   (   QV  5         H+      ,   V     
  Q.   .       $!5    current   apply   target   url   isPeriodic	   args   aborted   state   invoke      5;                                    R  5!!      +   patchXHR/abortNative<e                         + @/ + @/                         !!               +H!!    	   /   patchXHR/abortNative</<b )+ @/  + @/   ]             5;                                    T  5;            Z                \             5                     	                    Q      Q     Q     Q     QT  5       QV             V   5     QV      7   QV      7   Q    f        QT  5     QV  ?        QV  5     QV    7   QV    7   Q      =      Q=      Q  V  =      :    Q=      Q    =   :    Q  =   :  	  Q  V  =	      :  
  Q  V  =
      :    Q"#  8,!$2?'  *&(       XMLHttpRequest   prototype3   XMLHttpRequestEventTarget!   readystatechange   scheduled	   open'   XMLHttpRequest.send#   fetchTaskAborting'   fetchTaskScheduling	   send   abort5;               7                             W   QV   T   Q    =    :    Q  =   :    Q  =   :    Q  =   :    Q  =   :    Q  =   :    Q/+     xhrTask   xhrSync   xhrListener   xhrScheduled   xhrURL/   xhrErrorBeforeScheduled5!!         pDpN/</<e    %                  z/ \0 z/ \0                           !!      global         +H;   e   !                       T  5    E      QT  5    5      :        T  5    5   Z   =   `    =   `    Q   1    navigator   geolocation%   getCurrentPosition   watchPosition      5!!         pDpN/</<e                       0 4 0 4                        !!      global	   Zone7   findPromiseRejectionHandler       +H!!    	   7   findPromiseRejectionHandler 0 3 0 3   ,                evtName   B $1 |3 1 |3                   e   D" 1 l3 1 l3   #             555;   i   0                          W   Q   5    O      T     =   : V   =   : 9QT   =   : V   =   : 9Q     +   PromiseRejectionEventA   unhandledPromiseRejectionHandler%   unhandledrejection/   rejectionHandledHandler!   rejectionhandled5;        I  s              I  n                   B                          y                       	  Q      Q     Q   	  Q     Q     Q     Q     Q     Q     Q	     Q
     Q     Q     Q     Q   
  Q     Q     Q     Q     Q     Q     Q     Q     Q     Q     Q     Q       '=   IE      Q       D<      Q   '=   IE      Q      D      Q      :   Q      
=       Q   5    	  Q   5	      Q   5
    #  Q   5      Q   5   5    "  Q=       Q=      Q      
    :    Q      
   :    Q=      Q=    '  Q      
=   :    Q   5      Q    '=   I  QV     .          /      0      QV  E   1   Q   2   D<   3   Q   '=   HE   7   Q   8   D   9   Q   :      Q=      QZ   @`       Q   '=   IE   @   Q      rC     Q=      q EK   G   Q   5   =   IE/   L   Q[   5      
   5   l =   HS    (  Q (   E;   V   QV   E+   X   QV  E   Y   Q   5   [     ]      Q   5   =   IEj   b   Q[   5      
   5   l =   HE;   j   QV   E+   l   QV  E   m   Q   5   o     q      Q[      Q    %  Q   =   :    QB   QB   QB   Q      
=        QB   Q    '=   I   {   
  Q   	   
[!   =   [#   "   ]    : 
  Q       
=!   V
  V
   Q       
=!   V
  V
   Q!      
  Qv
  QB   Q    [$   C]"    +  Q[%      Q[&      Q#   A=$      =%   ,  R  ,  Q   =&   :  )  Qf'     Qf(      Qf)      Qf*     Qf+      Qf,     QZ   ='   `    =(   `   =)   `     QZ   =*   `    =+   `   	  QZ   =,   `      QZ   =-   `     !  Qf-      QZ   =.   `    =/   `   =0   `      Qf.      Qf/    $  QZ   =1   `    =2   `   =3   `   =4   `      QZ   =2   `    =4   `    *  QV  5   
V  V	  V  V      V  V  :  
  Q      
=6   0    Q   =7   :  &  Q      
=8   1    Q      
=9   2    Q      
=:   3    Q      
=;   4    Q      
=<   5    Q      
==   6    Q      
=>   7    Q      
=?   8    Q      
=@   9    Q      
=A   :    Qr +  +!!#&+. $ 0!   % ) O o'+##) * 	X 	^ 	~" 	#  	

% 			 
! 
M 
 
    #       window   undefined	   self   global	   Zone   __load_patch!   ZoneAwarePromise   Object1   getOwnPropertyDescriptor   defineProperty   getPrototypeOf   create   Array   prototype   slice!   addEventListener'   removeEventListener   __symbol__	   true   false      object   removeAttribute#   WorkerGlobalScope   nw   process   toString	   call!   [object process]   HTMLElement!   originalInstance   passive   get	   test	   useG   RegExp   ^%   (\w+)(true|false)$%   propagationStopped)   webglcontextrestored!   webglcontextlost3   webglcontextcreationerror   autocomplete#   autocompleteerror   toggle	   load   bounce   finish   start   close   error	   open   message   concat	   util   zoneTask   legacy   timers+   requestAnimationFrame   blocking   EventTarget   on_property   customElements   XHR   geolocation+   PromiseRejectionEvent5;                                      Q]bi  5!!      !!      !!   !!   runtime        ;   s   .                                5   D      QZ       6      
Z   P    `    Y    ?   ^   ]      ]   `   P   `    Q=V 8 %    window   webpackJsonp	   push	   hN/g	   pDpN:uiP      _L_LBkH_L   #    :http://localhost:4200/polyfills.js necko:classified 1 strongly-framed 1 request-method GET response-head HTTP/1.1 200 OK
Content-Type: application/javascript; charset=UTF-8
Content-Length: 144663
ETag: W/"23517-4KdknIWq+j6YdK1MAoIgOf4zIVQ"
Date: Wed, 09 Dec 2020 04:01:19 GMT
X-Powered-By: Express
Access-Control-Allow-Origin: *
Accept-Ranges: bytes
 original-response-headers X-Powered-By: Express
Access-Control-Allow-Origin: *
Accept-Ranges: bytes
Content-Type: application/javascript; charset=UTF-8
Content-Length: 144663
ETag: W/"23517-4KdknIWq+j6YdK1MAoIgOf4zIVQ"
Date: Wed, 09 Dec 2020 03:28:46 GMT
Connection: keep-alive
Keep-Alive: timeout=5
 ctid 2 uncompressed-len 0 net-response-time-onstart 20 net-response-time-onstop 21 alt-data 1;144663,javascript/moz-bytecode-20200826145745 alt-data-from-child 1  J`